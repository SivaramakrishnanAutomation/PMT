<?xml version="1.0" encoding="UTF-8"?>
<WebElementEntity>
   <description></description>
   <name>div_WelcomeQC_wrapper</name>
   <tag></tag>
   <elementGuidId>cb8934e7-bd48-4bed-831f-7876f4d8b38a</elementGuidId>
   <selectorCollection>
      <entry>
         <key>XPATH</key>
         <value>//form[@id='Form1']/div[6]/div/div/div</value>
      </entry>
      <entry>
         <key>CSS</key>
         <value>div.content_border > div.wrapper</value>
      </entry>
   </selectorCollection>
   <selectorMethod>XPATH</selectorMethod>
   <smartLocatorCollection>
      <entry>
         <key>SMART_LOCATOR</key>
         <value>#Form1 div >> internal:has-text=&quot;Export Data : Select the format you like to export * Excel/XML will contain info&quot;i >> nth=3</value>
      </entry>
   </smartLocatorCollection>
   <smartLocatorEnabled>false</smartLocatorEnabled>
   <useRalativeImagePath>true</useRalativeImagePath>
   <webElementProperties>
      <isSelected>false</isSelected>
      <matchCondition>equals</matchCondition>
      <name>tag</name>
      <type>Main</type>
      <value>div</value>
      <webElementGuid>ae05cfa2-ebca-4997-9ff9-93f6b6856adc</webElementGuid>
   </webElementProperties>
   <webElementProperties>
      <isSelected>false</isSelected>
      <matchCondition>equals</matchCondition>
      <name>class</name>
      <type>Main</type>
      <value>wrapper</value>
      <webElementGuid>3e3afaa6-293f-4479-b67d-bd5e271265d7</webElementGuid>
   </webElementProperties>
   <webElementProperties>
      <isSelected>true</isSelected>
      <matchCondition>equals</matchCondition>
      <name>text</name>
      <type>Main</type>
      <value>
                      
                   
                        
    
    
    
        .select2-container {
            width: 250px !important;
        }

        .ui-accordion .ui-accordion-header {
            background: #d3d3d3 !important;
            border-radius: 3px;
        }

        .ui-icon-triangle-1-e {
            background-position: -32px -16px !important;
        }

        .ui-accordion .ui-accordion-header {
            color: #004a86 !important;
            font-weight: 600 !important;
            font-size: 15px !important;
        }

        .filterlbl {
            font-size: 13px !important;
            padding-left: 5px;
        }

        .background_lte label {
            font-size: 15px;
        }

        #divExportFormat {
            padding: 15px;
        }

        .span_head_bold {
            margin: 0px !important;
            color: #004a9af7;
        }

        .status-text.overlap #overlapchk {
            margin: 0px;
            width: 26px;
            height: 15px;
        }

        #Acesversion {
            padding-left: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #004a86;
        }

        .field_20 {
            margin-top: 10px !important;
        }

        #Acesversion span {
            font-weight: 600;
            font-size: 14px;
        }

        #overpopulate {
            padding-left: 10px;
        }

            #overpopulate span {
                font-size: 14px;
                font-weight: 600;
            }

        .field_label {
            font-weight: 600;
        }

        .tab button {
            color: #004a86 !important;
            font-weight: 700 !important;
        }

            

        #loaddatabox {
            padding-top: 15px;
        }

        .dropdown-container {
            padding-left: 8px;
        }

        .ui-state-active .ui-icon, .ui-button:active .ui-icon {
            filter: invert(1);
        }

        #divExportFormat label {
            font-weight: 500 !important;
        }

        .p_lr_5 {
            padding-left: 20px !important;
        }

        .Fmpexportbutton {
            background: #d11920;
            color: #fff;
            font-size: 12px;
            padding: 0px 10px 0px;
            border-radius: 5px;
        }

        .exportbottom {
            padding-bottom: 50px;
        }

        .Exportbutton {
            cursor: pointer;
            background: #058c40;
            color: #fff;
            margin: 0 0 0 10px;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
        }

        .status-text {
            font-family: Arial, sans-serif;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .red-text {
            color: red;
            font-weight: bold;
        }

        .underline-link {
            color: red;
            text-decoration: underline;
            cursor: pointer;
        }

        .tab {
            overflow: hidden;
            border-bottom: 1px solid #ccc;
        }

            .tab button {
                background-color: #f1f1f1;
                float: left;
                border: none;
                outline: none;
                cursor: pointer;
                padding: 10px 16px;
                transition: 0.3s;
                align-items: center;
            }

                .tab button:hover {
                    background-color: #ddd;
                }

                .tab button.active {
                    background-color: #ccc;
                }

        .tab-icon {
            width: 24px;
            height: 24px;
            margin-right: 8px;
        }

        .tab-icon1 {
            width: auto;
            height: 30px;
            margin-right: 8px;
        }

        .tabcontent {
            display: none;
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-top: none;
            margin-top: 20px;
        }

        .content {
            margin-top: 20px;
        }

        .select2-results__option .wrap:before {
            font-family: fontAwesome;
            color: #004a86;
            content: &quot;\f096&quot;;
            width: 25px;
            height: 25px;
            padding-right: 10px;
        }

        .select2-results__option[aria-selected=true] .wrap:before {
            content: &quot;\f14a&quot;;
        }

        /* not required css */

        .select2-multiple, .select2-multiple2 {
            width: 50%
        }

        .ui-accordion .ui-accordion-header {
            color: #2b43c3;
            border: 1px solid #ffffff;
            background: #ddd;
            padding: 20px; /* Adjust this as needed */
            height: 50px; /* Set a fixed height */
            display: flex; /* Use Flexbox to center content */
            align-items: center; /* Vertically center content */
            text-align: center; /* Ensure text is centered if it's multiline */
        }

        #accordion {
            margin: 5px 0;
        }

        .filterclass {
            display: inline-block;
            vertical-align: top;
            width: 24%;
            padding: 3px 5px;
            margin: 3px;
        }

        .filterlbl {
            width: 85%;
            float: left;
        }

        .filterinp {
            float: left;
        }

        .panel_box {
            width: 100%;
            overflow-y: auto;
            max-height: 300px;
            border: 1px solid #ccc;
            padding: 10px;
            box-shadow: 0 0 5px rgba(0, 0, 0, .28);
        }
    
    
        var AdminId = '';
        var AdminGroupID = '';
        var WebAPIURL = 'https://ecat.apapmt.com:8186/ecat/pmtapi/';
        var ReadOnlyDB = 'false';
        var ACESPIESQueue = 'true';
        var ChkSubProdLineAlert = 'false';
        var TradingPartnerwebconfig = 'true';
        var Export_Overpopulate = 'true';
        var FMP = 'true';
        var AllExcelExportOption = '';
        var Submissiontype = 'true';
        var CustomizedXmlExp = '1';
        var syncwithopticat = 'false';
        var CustomAllApplication = 'Yes';
        var AllApplicationTitle = 'Yes';
        var IncludeCustomValue = 'NO';
        var PMTName = 'EcatPMT';
        AdminId = '3127';
        AdminGroupID = '6';
        var BrandIds = '';
        var SubBrandIds = '';
        var SubPLine = '';
        var PartTypeIds = '';
        var VehicleTypeIds = '';
        var MakeIds = '';
        var RegionIds = '';
        var Equipment = '';
        var searchdata = &quot;&quot;;
        var searchMdata = &quot;&quot;;
        var Process = &quot;&quot;;
        var hdUnitComp = &quot;&quot;;
        var hdCapital = &quot;&quot;;
        var hdIncludeCustomValue = &quot;&quot;;
        var P2P = &quot;&quot;;
        var XMLTOFTP = &quot;&quot;;
        var hdExportType = &quot;&quot;;
        var LineTPwise = &quot;&quot;;
        var hdAmazon = &quot;&quot;;
        var Services = &quot;&quot;;
        var hdbrand = &quot;false&quot;;
        var PCompany = &quot;&quot;;
        var PContactName = &quot;&quot;;
        var PContactEmail = &quot;&quot;;
        var PPLA = &quot;&quot;;
        var PVendorNumber = &quot;&quot;;
        var PPIESSubmissionType = &quot;&quot;;
        var PPriceSheetNum = &quot;&quot;;
        var PBlanketEffectiveDate = &quot;&quot;;
        var ACompanyName = &quot;&quot;;
        var ACompanyContact = &quot;&quot;;
        var AEffectiveDate = &quot;&quot;;
        var Adoctitle = &quot;&quot;;
        var ADocformnumber = &quot;&quot;;
        var ASenderCompany = &quot;&quot;;
        var ASenderContact = &quot;&quot;;
        var ASenderPhone = &quot;&quot;;
        var Asenderphoneext = &quot;&quot;;
        var Asenderemail = &quot;&quot;;
        var AMapperCompany = &quot;&quot;;
        var AMapperContact = &quot;&quot;;
        var AMapperPhone = &quot;&quot;;
        var AMapperPhoneext = &quot;&quot;;
        var AMapperEmail = &quot;&quot;;
        var AApprovedfordata = &quot;&quot;;
        var ExportFTP = &quot;&quot;;
        var customizedflag = &quot;0&quot;;
        $(document).ready(function () {
            GetexportMenu();
            GetCustomExportImage();
            loadhdvalues();
            BrandIds = '0';
            SubBrandIds = '0';
            SubPLine = '0';
            PartTypeIds = '0';
            VehicleTypeIds = '0';
            MakeIds = '0';
            Equipment = '0';
            RegionIds = '0';
            $(&quot;#loaddatabox&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;.tablinks&quot;).click(function () {
                event.preventDefault();
                $(&quot;.tablinks&quot;).css(&quot;background-color&quot;, &quot;&quot;);
                $(this).css(&quot;background-color&quot;, &quot;#ddd&quot;);
            });
            $(&quot;.Cusimgexport&quot;).click(function () {
                event.preventDefault();
                let imgSrc = $(this).find('img').attr('src');
                let fileName = imgSrc.split('/').pop();
                //console.log(fileName);
                 var data = {
                   &quot;adminid&quot;: AdminId,
                   &quot;FileName&quot;: fileName
                            }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'GetCustomExportid',
                    data: JSON.stringify(data),
                    //async: false,
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    timeout: 120000,
                    success: function (result) {
                        debugger
                        var Exportid = &quot;&quot;;
                        var ExportType = &quot;&quot;;
                        var CompanyName = &quot;&quot;;
                        var companycontact = &quot;&quot;;
                        var effectivedate = &quot;&quot;;
                        var submissiontype = &quot;&quot;;
                        var doctitle = &quot;&quot;;
                        var docformnumber = &quot;&quot;;
                        var approvedfor = &quot;&quot;;
                        var sendercompany = &quot;&quot;;
                        var sendercontact = &quot;&quot;;
                        var senderphone = &quot;&quot;;
                        var senderphoneext = &quot;&quot;;
                        var senderemail = &quot;&quot;;
                        var mappercompany = &quot;&quot;;
                        var mappercontact = &quot;&quot;;
                        var mapperphone = &quot;&quot;;
                        var mapperphoneext = &quot;&quot;;
                        var mapperemail = &quot;&quot;;
                        var BrandID = &quot;&quot;;
                        var Acesname = &quot;&quot;;
                        var Line = &quot;&quot;;
                        var AdminID = AdminId;
                        if (result.length > 0) {
                            var data = JSON.parse(result);
                            $.each(data, function () {
                                Exportid = this['Exportid'];
                                ExportType = this['ExportType'];
                                CompanyName = this['CompanyName'];
                                companycontact = this['companycontact'];
                                effectivedate = this['effectivedate'];
                                submissiontype = this['submissiontype'];
                                doctitle = this['doctitle'];
                                docformnumber = this['docformnumber'];
                                approvedfor = this['approvedfor'];
                                sendercompany = this['sendercompany'];
                                sendercontact = this['sendercontact'];
                                senderphone = this['senderphone'];
                                senderphoneext = this['senderphoneext'];
                                senderemail = this['senderemail'];
                                mappercompany = this['mappercompany'];
                                mappercontact = this['mappercontact'];
                                mapperphone = this['mapperphone'];
                                mapperphoneext = this['mapperphoneext'];
                                mapperemail = this['mapperemail'];
                                BrandID = this['BrandID'];
                                Acesname = this['PIES'];
                                Equipment = this['Equipment'];
                                Line = this['Line'];

                                if (Acesname == &quot;ACES with QDB Codes&quot;) {
                                    Qualifier = true;
                                }
                                else {
                                    Qualifier = false;
                                }
                            })
                            var _data = {
                                &quot;CompanyName&quot;: CompanyName,
                                &quot;Acesname&quot;: Acesname,
                                &quot;drpSubmissionType&quot;: submissiontype,
                                &quot;Contact&quot;: companycontact,
                                &quot;EffectiveDate&quot;: effectivedate,
                                &quot;DocTitle&quot;: doctitle,
                                &quot;DocFormNo&quot;: docformnumber,
                                &quot;Approvedfor&quot;: approvedfor,
                                &quot;SenderCompany&quot;: sendercompany,
                                &quot;SenderContact&quot;: sendercontact,
                                &quot;SenderPhone&quot;: senderphone,
                                &quot;SenderPhoneExt&quot;: senderphoneext,
                                &quot;SenderEmail&quot;: senderemail,
                                &quot;MapperCompany&quot;: mappercompany,
                                &quot;MapperContact&quot;: mappercontact,
                                &quot;MapperPhone&quot;: mapperphone,
                                &quot;MapperPhoneExt&quot;: mapperphoneext,
                                &quot;MapperEmail&quot;: mapperemail,
                                &quot;BrandID&quot;: BrandID,
                                &quot;ExportType&quot;: ExportType,
                                &quot;Exportid&quot;: Exportid,
                                &quot;Line&quot;: Line,
                                &quot;AdminId&quot;: AdminId
                            }
                            if (ACESPIESQueue == &quot;false&quot;) {
                                $.ajax({
                                    type: &quot;POST&quot;,
                                    url: WebAPIURL + 'GetAcesCustomimgExportxmldataNew',
                                    data: JSON.stringify(_data),
                                    contentType: &quot;application/json; charset=utf-8&quot;,
                                    success: function (response) {
                                        debugger
                                        $('.loader_main_spin').hide();
                                        var data = JSON.parse(response);
                                        var count = data.Count;
                                        var name = data.Name;
                                        var result = data.Result;
                                        var services = Acesname;
                                        var rbb = $('input[name=&quot;exportFormat&quot;]:checked').val();
                                        if (rbb != &quot;&quot; &amp;&amp; rbb != undefined) {
                                            rbb = &quot;4.2&quot;;
                                        }
                                        const sanitizedName = name.replace(/[^a-zA-Z0-9-_ ]+/g, &quot;&quot;);
                                        const fullURL = `downloadAcesXml.aspx?Aces=${services}&amp;company=${sanitizedName}&amp;Qualifier=${Qualifier}&amp;Equipment=${Equipment}&amp;ExportFormat=${rbb}`;
                                        if (count != &quot;0&quot;) {
                                            if (result == &quot;Success&quot;) {
                                                window.open(fullURL, '_blank', 'status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px');
                                            }
                                            else {
                                                alert(&quot;Run Api mode contact administator&quot;);
                                            }
                                        }
                                        else {
                                            $('.loader_main_spin').hide();
                                            alert(&quot;There is no data for this criteria&quot;);
                                        }

                                    },
                                    error: function () {

                                        alert(&quot;Failed!&quot;)
                                        $('.loader_main_spin').hide();
                                    }
                                })
                            }
                            else {
                                $.ajax({
                                    type: &quot;POST&quot;,
                                    url: WebAPIURL + 'SaveAcesCustomimgExportxmldataNew',
                                    data: JSON.stringify(_data),
                                    contentType: &quot;application/json; charset=utf-8&quot;,
                                    success: function (response) {
                                        $('.loader_main_spin').hide();
                                        var msg = JSON.parse(response);
                                        //if (response > 0)
                                        if (msg == &quot;Success&quot;) {

                                            alert('Your export is initiated. Please check the Queue Management page for more details');

                                        }
                                        else {
                                            alert(&quot;Run Api mode contact administator&quot;);
                                        }

                                    },
                                    error: function (err) {
                                        console.log(err);
                                        alert(&quot;Failed!&quot;)
                                        $('.loader_main_spin').hide();
                                    }
                                })
                            }
                        }
                    }, error: function (x, t, m) {
                            if (t === &quot;timeout&quot;) {
                                Swal.fire({
                                    icon: 'warning',
                                    //title: 'Cancelled',
                                    title: &quot;Request timed out. Please contact system administrator&quot;,
                                    allowOutsideClick: false,
                                    allowEscapeKey: false,
                                })
                                //alert(&quot;Request timed out. Please contact system administrator&quot;);
                            } else {
                                Swal.fire({
                                    icon: 'warning',
                                    //title: 'Cancelled',
                                    title: &quot;Already Exists&quot;,
                                    allowOutsideClick: false,
                                    allowEscapeKey: false,
                                })
                                //alert(&quot;Error Occured. Please contact system adminstrator&quot;);
                            }
                            $(&quot;.loader_main_spin&quot;).hide();
                        }

                    
                });

            });
            $(&quot;#DrpLine&quot;).change(function () {
                CloseTab();
                $(&quot;#overpopulate&quot;).hide();
                if ($(&quot;#DrpLine&quot;).val() != &quot;-SELECT-&quot;) {
                    Loadinterchange();
                    $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
                    $(&quot;#accordion&quot;).show();
                    $(&quot;#Bottomdata&quot;).show();
                    if (LineTPwise != &quot;TP&quot;) {
                        LineTPwise = &quot;Line&quot;;
                    }
                }
                else {
                    $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
                    $(&quot;#drpinterchange&quot;).empty();
                    $(&quot;#accordion&quot;).hide();
                    $(&quot;#Bottomdata&quot;).hide();
                    if (LineTPwise != &quot;TP&quot;) {
                        LineTPwise = &quot;&quot;;
                        LoadTradingPartner();
                    }

                }
                if (LineTPwise == &quot;Line&quot;) {
                    if (($(&quot;#drptradingpartner&quot;).val()) == &quot;0&quot;) {
                        LoadTradingPartner();
                    }
                }
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    $(&quot;#alllinebrandnote&quot;).show();
                    if (LineTPwise != &quot;TP&quot;) {
                        $(&quot;#alllineptnote&quot;).show();
                    }
                    else {
                        $(&quot;#alllineptnote&quot;).hide();
                    }
                }
                else {
                    $(&quot;#alllinebrandnote&quot;).hide();
                    $(&quot;#alllineptnote&quot;).hide();
                }
                EnptyChkboxs();
                CheckSubPline();
                if (LineTPwise != &quot;TP&quot;) {
                    $(&quot;#drptradingpartner&quot;).val(&quot;0&quot;);
                }
                
                if (Process == &quot;PIES&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;.overlap&quot;).hide();
                    $(&quot;#overpopulate&quot;).hide();
                    $(&quot;#PIESHeader3&quot;).show();
                    $(&quot;#Header3&quot;).hide();
                    $(&quot;#Acesversion&quot;).hide();
                    if (syncwithopticat == &quot;true&quot;) {
                        if (FMP == &quot;true&quot;) {
                            $(&quot;#ImportOpticat&quot;).hide();
                        } else {
                            $(&quot;#ImportOpticat&quot;).show();
                        }
                        
                    }
                    else {
                        $(&quot;#ImportOpticat&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    $(&quot;#XMLExport&quot;).show();
                    $(&quot;#CSVExport&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#ExcelExport&quot;).show();
                    $(&quot;#checkAllbrand&quot;).prop('disabled', false);
                    $(&quot;#checkAllSubbrand&quot;).prop('disabled', false);
                    $(&quot;#checkAllSubPline&quot;).prop('disabled', false);
                    $(&quot;#checkAllPartType&quot;).prop('disabled', false);
                    $(&quot;.brandchk&quot;).prop('disabled', false);
                    $(&quot;.Subbrandchk&quot;).prop('disabled', false);
                    $(&quot;.SubPlinechk&quot;).prop('disabled', false);
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        $(&quot;#checkAllbrand&quot;).prop('disabled', true);
                        $(&quot;#checkAllSubbrand&quot;).prop('disabled', true);
                        $(&quot;#checkAllSubPline&quot;).prop('disabled', true);
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#checkAllPartType&quot;).prop('disabled', true);
                        }
                        else {
                            $(&quot;#checkAllPartType&quot;).prop('disabled', false);
                        }
                        $(&quot;.brandchk&quot;).prop('disabled', true);
                        $(&quot;.Subbrandchk&quot;).prop('disabled', true);
                        $(&quot;.SubPlinechk&quot;).prop('disabled', true);
                    }
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#checkAllbrand&quot;).prop('disabled', false);
                            $(&quot;#checkAllSubbrand&quot;).prop('disabled', false);
                            $(&quot;.brandchk&quot;).prop('disabled', false);
                            $(&quot;.Subbrandchk&quot;).prop('disabled', false);
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).show();
                            $(&quot;#PIESXMLExport&quot;).show();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#Interchangelbldep&quot;).hide();
                            $(&quot;#trading&quot;).hide();
                            $(&quot;#CSVExport&quot;).hide();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#XMLExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();
                            $(&quot;#FMPPIESXML&quot;).show();
                            $(&quot;#FMPPIESEXCEL&quot;).show();

                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;#PIESHeader3&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;#Interchangelbldep&quot;).show();
                            $(&quot;#trading&quot;).show();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#FMPPIESXML&quot;).hide();
                            $(&quot;#FMPPIESEXCEL&quot;).hide();
                            $(&quot;#CSVExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#XMLExport&quot;).show();
                        }
                    }
                    loadPIESHeaderdetails();
                }
                else if (Process == &quot;AllApplication&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#checkAllbrand&quot;).prop('disabled', false);
                    $(&quot;#checkAllSubbrand&quot;).prop('disabled', false);
                    $(&quot;#checkAllSubPline&quot;).prop('disabled', false);
                    $(&quot;#checkAllPartType&quot;).prop('disabled', false);
                    $(&quot;.brandchk&quot;).prop('disabled', false);
                    $(&quot;.Subbrandchk&quot;).prop('disabled', false);
                    $(&quot;.SubPlinechk&quot;).prop('disabled', false);
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        $(&quot;#checkAllbrand&quot;).prop('disabled', true);
                        $(&quot;#checkAllSubbrand&quot;).prop('disabled', true);
                        $(&quot;#checkAllSubPline&quot;).prop('disabled', true);
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#checkAllPartType&quot;).prop('disabled', true);
                        }
                        else {
                            $(&quot;#checkAllPartType&quot;).prop('disabled', false);
                        }
                        $(&quot;.brandchk&quot;).prop('disabled', true);
                        $(&quot;.Subbrandchk&quot;).prop('disabled', true);
                        $(&quot;.SubPlinechk&quot;).prop('disabled', true);
                    }
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;#checkAllbrand&quot;).prop('disabled', false);
                            $(&quot;#checkAllSubbrand&quot;).prop('disabled', false);
                            $(&quot;.brandchk&quot;).prop('disabled', false);
                            $(&quot;.Subbrandchk&quot;).prop('disabled', false);
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#CSVExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();
                            $(&quot;#FMPCSVExport&quot;).show();

                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPCSVExport&quot;).hide();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#CSVExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).show();
                            $(&quot;#Makeh3&quot;).show();
                        }
                    }
                    //$(&quot;#Overlapdata&quot;).show();
                    $(&quot;.overlap&quot;).show();
                }
                else if (Process == 'ACESwithQDB') {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#Approvedfor&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (CustomizedXmlExp == &quot;1&quot;) {
                        $(&quot;#CustomXML&quot;).show();
                    }
                    if (Export_Overpopulate == &quot;true&quot;) {
                        $(&quot;#overpopulate&quot;).show();
                    }
                    else {
                        $(&quot;#overpopulate&quot;).hide();
                    }
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    $(&quot;#Approvedfor&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();
                            $(&quot;#QDBXMLExport&quot;).show();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPQDBXML&quot;).show();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#XMLExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();
                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).show();
                            $(&quot;#Makeh3&quot;).show();
                            $(&quot;#Regionh3&quot;).show();
                            $(&quot;#Header3&quot;).show();
                            //$(&quot;#Overlapdata&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;.overlap&quot;).show();
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPQDBXML&quot;).hide();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#XMLExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                        }
                    }
                    loadHeaderdetails();
                    if (XMLTOFTP == &quot;1&quot;) {
                        $(&quot;#xmltoftp&quot;).show();
                    }
                }
                else if (Process == 'ACESwithRawNote') {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (CustomizedXmlExp == &quot;1&quot;) {
                        $(&quot;#CustomXML&quot;).show();
                    }
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    if (Export_Overpopulate == &quot;true&quot;) {
                        $(&quot;#overpopulate&quot;).show();
                    }
                    else {
                        $(&quot;#overpopulate&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).show();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPRAWNotesXML&quot;).show();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#XMLExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();

                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).show();
                            $(&quot;#Makeh3&quot;).show();
                            $(&quot;#Regionh3&quot;).show();
                            $(&quot;#Header3&quot;).show();
                            //$(&quot;#Overlapdata&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;.overlap&quot;).show();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPRAWNotesXML&quot;).hide();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#XMLExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                        }
                    }
                    loadHeaderdetails();
                    if (XMLTOFTP == &quot;1&quot;) {
                        $(&quot;#xmltoftp&quot;).show();
                    }
                }
                else if (Process == &quot;ACESwithRawNoteandInvalid&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;.overlap&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();

                        }
                    }
                }
                else if (Process == &quot;AcesInvalid&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();

                        }
                    }
                }
                else if (Process == &quot;Amazon&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#XMLExport&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    $(&quot;#trading&quot;).hide();
                }
                else if (Process == &quot;WalmartPIES&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#ImportOpticat&quot;).hide();
                    $(&quot;.overlap&quot;).hide();
                    $(&quot;#PIESHeader3&quot;).show();
                    $(&quot;#Header3&quot;).hide();
                }
                else if (Process == &quot;Walmart&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                }
                else {
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).hide();
                    $(&quot;#PIESHeader3&quot;).hide();
                    $(&quot;#Header3&quot;).hide();
                    $(&quot;#Acesversion&quot;).hide();
                }
                //if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                //    $(&quot;#incequipment&quot;).hide();
                //    $(&quot;#trading&quot;).hide();
                //    $(&quot;#PTalllist&quot;).hide();
                //    $(&quot;#Acesversion&quot;).hide();
                //    $(&quot;#Ebaylbldrp&quot;).hide();
                //}
                $(&quot;.Exportdate&quot;).show();
                if (FMP == &quot;true&quot;) {
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        $(&quot;#csvinfo&quot;).hide();
                    } else {
                        $(&quot;#csvinfo&quot;).show();
                    }
                    
                } else {
                    $(&quot;#csvinfo&quot;).show();
                }
            })
            $(function () {
                $(&quot;#accordion&quot;).accordion({
                    header: &quot;h3&quot;, collapsible: true, heightStyle: &quot;content&quot;, active: false,

                    activate: function (event, ui) {
                        if (!$.isEmptyObject(ui.newHeader.offset())) {
                            $('html:not(:animated), body:not(:animated)').animate({ scrollTop: ui.newHeader.offset().top }, 'fast');
                        }
                    }
                });
                //$(&quot;#accordion h3&quot;).eq(0).off(&quot;click&quot;);
                //$(&quot;#accordion h3&quot;).eq(1).off(&quot;click&quot;);
            });
            //$(&quot;#accordion&quot;).on(&quot;click&quot;, &quot;.ui-accordion-header&quot;, function () {
            //    var header = $(this);
            //    var index = header.index();

            //    if (header.hasClass(&quot;ui-accordion-header-active&quot;)) {
            //        // Close the clicked panel
            //        header.removeClass(&quot;ui-accordion-header-active&quot;);
            //        header.next().slideUp();
            //    } else {
            //        // Open the clicked panel
            //        header.addClass(&quot;ui-accordion-header-active&quot;);
            //        header.next().slideDown();
            //    }
            //    if (index == &quot;0&quot;) {
            //        loadBrand();
            //    } else if (index == &quot;2&quot;) {
            //        loadSubBrand();
            //    }
            //});
            $(&quot;#accordion h3&quot;).eq(0).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadBrand();
                }
            });
            $(&quot;#accordion h3&quot;).eq(1).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadSubBrand();
                }
            });
            $(&quot;#accordion h3&quot;).eq(2).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    CheckSubPline();
                }
            });
            $(&quot;#accordion h3&quot;).eq(3).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadPartType();
                }
            });
            $(&quot;#accordion h3&quot;).eq(4).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadVehicleType();
                }
            });
            $(&quot;#accordion h3&quot;).eq(5).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadMake();
                }
            });
            $(&quot;#accordion h3&quot;).eq(6).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadRegion();
                }
            });
            $(&quot;#accordion h3&quot;).eq(7).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadSubHeader();
                    loadHeaderdetails();
                    $(&quot;#SubmissionType&quot;).val(&quot;1&quot;);
                }
            });
            $(&quot;#accordion h3&quot;).eq(8).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadSubHeader();
                    loadPIESHeaderdetails();
                    $(&quot;#PIESSubmissionType&quot;).val(&quot;1&quot;);
                }
            });
            $('#checkAllbrand').click(function () {
                $('input.brandchk').prop('checked', this.checked);
                BrandIds = $(&quot;.brandchk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $('#checkAllSubbrand').click(function () {
                $('input.Subbrandchk').prop('checked', this.checked);
                SubBrandIds = $(&quot;.Subbrandchk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $('#checkAllSubPline').click(function () {
                $('input.SubPlinechk').prop('checked', this.checked);
                SubPLine = $(&quot;.SubPlinechk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $('#checkAllPartType').click(function () {
                $('input.PartTypechk').prop('checked', this.checked);
                PartTypeIds = $(&quot;.PartTypechk:checked&quot;).filter(function () {
                    // Check if this checkbox is within a visible .filterclassPT element
                    return $(this).closest('.filterclassPT').is(':visible');
                }).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $('#checkAllVehicleType').click(function () {
                $('input.VehicleTypechk').prop('checked', this.checked);
                VehicleTypeIds = $(&quot;.VehicleTypechk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $('#checkAllMake').click(function () {
                $('input.Makechk').prop('checked', this.checked);
                MakeIds = $(&quot;.Makechk:checked&quot;).filter(function () {
                    return $(this).closest('.filterclassM').is(':visible');
                }).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $('#checkAllRegion').click(function () {
                $('input.Regionchk').prop('checked', this.checked);
                RegionIds = $(&quot;.Regionchk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $('#chkequ').click(function () {
                EnptyChkboxs();
                CloseTab();
            });
            $(&quot;#DrpEbay&quot;).change(function () {
                $(&quot;#accordion&quot;).show();
                $(&quot;#Ebaylbldrp&quot;).show();
                $(&quot;#loaddatabox&quot;).show();
                $(&quot;#Regionh3&quot;).show();
                $(&quot;#vehicletypeh3&quot;).show();
                $(&quot;#Makeh3&quot;).show();
                $(&quot;#Bottomdata&quot;).show();
                $(&quot;.Exportdate&quot;).show();
                $(&quot;#ExcelExport&quot;).show();
            })
        });
        function GetexportMenu() {
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'GetexportMenu',
                data: '',
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    data.forEach(function (item) {
                        if (item.Iconlist === &quot;All Applications&quot;) {
                            $(&quot;#AllApplication&quot;).show();
                        }
                        else if (item.Iconlist === &quot;ACES with QDB Codes&quot;) {
                            $(&quot;#ACESwithQDB&quot;).show();
                        }
                        else if (item.Iconlist === &quot;ACES with Raw Notes&quot;) {
                            $(&quot;#ACESwithRawNotes&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Pies&quot;) {
                            $(&quot;#PIES&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Amazon&quot;) {
                            $(&quot;#Amazon&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Walmart&quot;) {
                            $(&quot;#Walmart&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Walmart XML&quot;) {
                            $(&quot;#WalmartPIES&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Ebay&quot;) {
                            $(&quot;#Ebay&quot;).show();
                        }
                        else if (item.Iconlist === &quot;AcesInvalid&quot;) {
                            $(&quot;#ACESInvalid&quot;).show();
                        }
                        else if (item.Iconlist === &quot;AcesRawNotes with Invalid&quot;) {
                            $(&quot;#ACESwithRawNotesandAttributeInvalid&quot;).show();
                        }
                    });
                },
            });
        }
        function GetCustomExportImage() {
            var data = {
                &quot;AdminID&quot;: AdminId
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'GetCustomExportImage',
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    var url = window.location.origin;
                    $.each(data, function (index, item) {
                        var urlpath = url + '/' + item.Filepath.replace('~', '');
                        var $button = $('&lt;button>', {
                            class: 'tablinks Cusimgexport',
                            title: item.Nameofoutput,
                            id: item.Nameofoutput
                        });
                        var $img = $('&lt;img>', {
                            src: urlpath,
                            alt: item.Nameofoutput,
                            class: 'tab-icon1'
                        });
                        $button.append($img);
                        $('#buttonContainer').append($button);
                    });
                },
            });
        }
        $.fn.select2.amd.require([
            'select2/selection/single',
            'select2/selection/placeholder',
            'select2/selection/allowClear',
            'select2/dropdown',
            'select2/dropdown/search',
            'select2/dropdown/attachBody',
            'select2/utils'
        ], function (SingleSelection, Placeholder, AllowClear, Dropdown, DropdownSearch, AttachBody, Utils) {

            var SelectionAdapter = Utils.Decorate(
                SingleSelection,
                Placeholder
            );

            SelectionAdapter = Utils.Decorate(
                SelectionAdapter,
                AllowClear
            );

            var DropdownAdapter = Utils.Decorate(
                Utils.Decorate(
                    Dropdown,
                    DropdownSearch
                ),
                AttachBody
            );

            var base_element = $('#drpinterchange');
            $(base_element).select2({
                placeholder: 'Select multiple items',
                selectionAdapter: SelectionAdapter,
                dropdownAdapter: DropdownAdapter,
                allowClear: true,
                selectOnClose: false,
                templateResult: function (data) {
                    if (!data.id) { return data.text; }

                    var $res = $('&lt;div>&lt;/div>');

                    $res.text(data.text);
                    $res.addClass('wrap');

                    return $res;
                },
                templateSelection: function (data) {

                    if (!data.id) {
                        return data.text;
                    }

                    var selected = ($('#drpinterchange').val() || []).length;
                    var total = $('option', $('#drpinterchange')).length;
                    return &quot;Selected &quot; + selected + &quot; of &quot; + total;
                }
            });
        });
        function select2onclose() {
            var Attribute = $(&quot;#drpinterchange&quot;).val().join();
            if (Attribute == &quot;&quot; || Attribute == undefined) {
                Attribute = &quot;0&quot;;
            }
            $(&quot;#drpinterchange1&quot;).val(Attribute);
            EnptyChkboxs();
            CloseTab();
        }
        function loadhdvalues() {
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'loadhdvalues',
                data: '',
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    var UnitComp = data.Table;
                    var Capital = data.Table1;
                    var custonval = data.Table2;
                    var ptp = data.Table3;
                    var Brandidcnt = data.Table4;
                    var xmlftp = data.Table5;

                    if (UnitComp.length > 0) {
                        hdUnitComp = UnitComp[0].UnitCompcnt;
                    }
                    if (Capital.length > 0) {
                        hdCapital = Capital[0].Capitalcnt;
                    }
                    if (custonval.length > 0) {
                        hdIncludeCustomValue = custonval[0].Custonvalcnt;
                    }
                    if (ptp.length > 0) {
                        P2P = ptp[0].P2Pcnt;
                    }
                    if (Brandidcnt.length > 0) {
                        var brandhide = Brandidcnt[0].Brandidcnt;
                        if (brandhide == 1) {
                            hdbrand = &quot;true&quot;;
                            $(&quot;#Brandexport&quot;).show();
                        }
                    }
                    if (xmlftp.length > 0) {
                        XMLTOFTP = xmlftp[0].xmltoftp;
                    }
                },
            });
        }
        function OpenPIES() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;PIES&quot;;
            Services = &quot;EPI&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).hide();
            $(&quot;#Makeh3&quot;).hide();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;#ExcelExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Interchangelbldep&quot;).show();
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            hdExportType = &quot;Services&quot;;
			$(&quot;#exportst&quot;).show();
        }
        function OpenAllApplications() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;AllApplication&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#trading&quot;).hide();
            $(&quot;#accordion&quot;).hide();
            $(&quot;#incequipment&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).hide();
            $(&quot;#PIESHeader3&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;#exportst&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).hide();
            $(&quot;#ExcelExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#XMLExport&quot;).hide();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#ExcelExport&quot;).show();
            hdExportType = &quot;AllApplication&quot;;
            Services = &quot;ACES&quot;;
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            $(&quot;#unitcomplbldrp&quot;).hide();
			$(&quot;status-text overlap&quot;).hide();
        }
        function OpenACESwithQDBCodes() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;ACESwithQDB&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            $(&quot;#drpCompetitor1&quot;).val(&quot;&quot;);
            $(&quot;#chkequ&quot;).prop(&quot;checked&quot;, false);
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).show();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Approvedfor&quot;).show();
            $(&quot;#Interchangelbldep&quot;).show();
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#ExcelExport&quot;).show();
            hdExportType = &quot;ACESwithQDBCodes&quot;;
            hdAmazon = &quot;0&quot;;
            Services = &quot;ACES&quot;;
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
			$(&quot;#exportst&quot;).show();
        }
        function OpenACESwithRawNotes() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Services = &quot;ACES&quot;;
            Process = &quot;ACESwithRawNote&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            if (syncwithopticat == &quot;true&quot;) {
                $(&quot;#ImportOpticat&quot;).show();
            }
            else {
                $(&quot;#ImportOpticat&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).show();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Approvedfor&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            hdAmazon = &quot;0&quot;;
            $(&quot;#Interchangelbldep&quot;).show();
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#ExcelExport&quot;).show();
            hdExportType = &quot;ACESwithRawNotes&quot;;
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
			$(&quot;#exportst&quot;).show();
        }
        function OpenACESwithRawNotesandInvalid() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Services = &quot;ACES&quot;;
            Process = &quot;ACESwithRawNoteandInvalid&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            hdAmazon = &quot;0&quot;;
            hdExportType = &quot;ACESwithRawNotesandInvalid&quot;;
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
        }
        function OpenACESInvalid() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;ACESInvalid&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            hdAmazon = &quot;0&quot;;
            hdExportType = &quot;ACESInvalid&quot;;
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
        }
        function OpenAmazon() {
            Process = &quot;Amazon&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#accordion&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Interchangelbldep&quot;).show();
            Loadlinecode();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#trading&quot;).hide();
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            $(&quot;#XMLExport&quot;).show();
            hdExportType = &quot;Amazon&quot;;
            Services = &quot;Amazon&quot;;
            hdAmazon = &quot;1&quot;;
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
        }
        function OpenWalmart() {
            LineTPwise = &quot;&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            Process = &quot;Walmart&quot;;
            Services = &quot;Walmart&quot;;
            $(&quot;#accordion&quot;).hide();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).show();
            $(&quot;#XMLExport&quot;).show();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            $(&quot;#trading&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
        }
        function OpenWalmartPIES() {
            LineTPwise = &quot;&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            Process = &quot;WalmartPIES&quot;;
            Services = &quot;WalmartPIES&quot;;
            $(&quot;#accordion&quot;).hide();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).hide();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            $(&quot;#trading&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
            $(&quot;#vehicletypeh3&quot;).hide();
            $(&quot;#Makeh3&quot;).hide();
            $(&quot;#Regionh3&quot;).hide();
            Services = &quot;WAL&quot;;
            $(&quot;#Header3&quot;).hide();
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            $(&quot;#PIESHeader3&quot;).show();
            hdExportType = &quot;Services&quot;;
        }
        function OpenEbay() {
            LineTPwise = &quot;&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            Services = &quot;Ebay&quot;;
            Process = &quot;Ebay&quot;;           
            $(&quot;#accordion&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).show();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;#unitcomplbldrp&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).hide();
            $(&quot;#trading&quot;).hide();                  
            $(&quot;#subplineh3&quot;).hide();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;#vehicletypeh3&quot;).hide();
            $(&quot;#Makeh3&quot;).hide();
            $(&quot;#Header3&quot;).hide();
            $(&quot;#PIESHeader3&quot;).hide();           
            $(&quot;#Brandh3&quot;).hide();
            $(&quot;#Subbrandh3&quot;).hide();
            $(&quot;#Bottomdata&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#XMLExport&quot;).hide();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            LoadEbayStore();
        }
        function Loadlinecode() {
            var Trading = &quot;0&quot;;
            if (LineTPwise == &quot;TP&quot;) {
                Trading = $(&quot;#drptradingpartner&quot;).val();
            }
            var data1 = {
                &quot;AdminId&quot;: AdminId,
                &quot;Trading&quot;: Trading
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'Exportdatalinedrp',
                data: JSON.stringify(data1),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {

                    $(&quot;#DrpLine&quot;).empty();
                    if (data.length == 0) {
                        $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                    }
                    else if (data.length == 1) {
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                        }
                    }
                    else if (data.length > 1) {
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                        }
                        if (Process == &quot;PIES&quot;) {
                            $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;ALL&quot;));
                        }
                        else if (Process == &quot;AllApplication&quot;) {
                            if (AllExcelExportOption == &quot;&quot;) {
                                $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;ALL&quot;));
                            }
                        }
                        else if (FMP == &quot;true&quot;) {
                            if (Process == &quot;ACESwithQDB&quot; || Process == &quot;ACESwithRawNote&quot;) {
                                if (AllExcelExportOption == &quot;&quot;) {
                                    $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;ALL&quot;));
                                }
                            }
                        }
                    }

                    $.each(data, function () {
                        $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(this['MfrBrandID']).text(this['MfrBrandName']));
                    });
					if (LineTPwise == &quot;TP&quot;){
						$('#DrpLine').trigger('change');
					}
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: 'warning',
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: 'warning',
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }

                }
            });

        }
        function Loadinterchange() {
            var linecode = $(&quot;#DrpLine&quot;).val();
            var data = {
                &quot;Linecode&quot;: linecode
            }
            var url = WebAPIURL + 'Exportinterchangedrp';
            if (ReadOnlyDB == &quot;true&quot;) {
                url = WebAPIURLReadOnly + 'Exportinterchangedrp';
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: url,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    $(&quot;#drpinterchange&quot;).empty();
                    $.each(data, function () {
                        $(&quot;#drpinterchange&quot;).append($(&quot;&lt;option/>&quot;).val(this['CompetitorID']).text(this['CompetitorName']));
                    });
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        Swal.fire({
                            icon: 'warning',
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        Swal.fire({
                            icon: 'warning',
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }
                }
            });
        }
        function LoadTradingPartner() {
            var Linecode = &quot;0&quot;;
            if (LineTPwise == &quot;Line&quot;) {
                Linecode = $(&quot;#DrpLine&quot;).val();
            }
            var data1 = {
                &quot;AdminId&quot;: AdminId,
                &quot;Linecode&quot;: Linecode
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'LoadTradingPartner',
                data: JSON.stringify(data1),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {

                    $(&quot;#drptradingpartner&quot;).empty();
                    if (data.length == 1 || data.length == 0) {
                        $(&quot;#drptradingpartner&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                    }
                    else if (data.length > 1) {
                        $(&quot;#drptradingpartner&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                    }

                    $.each(data, function () {
                        $(&quot;#drptradingpartner&quot;).append($(&quot;&lt;option/>&quot;).val(this['ID']).text(this['TradingName']));
                    });
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: 'warning',
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: 'warning',
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }

                }
            });

        }
        function LoadEbayStore() {
            var Marketid = &quot;1&quot;;
            var data1 = {
                &quot;MarketId&quot;: Marketid
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'LoadStoreNameMarketplace',
                data: JSON.stringify(data1),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {

                    $(&quot;#DrpEbay&quot;).empty();
                    if (data.length == 1 || data.length == 0) {
                        $(&quot;#DrpEbay&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                    }
                    else if (data.length > 1) {
                        $(&quot;#DrpEbay&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));                        
                    }

                    $.each(data, function () {
                        $(&quot;#DrpEbay&quot;).append($(&quot;&lt;option/>&quot;).val(this['Storeid']).text(this['Storename']));
                    });
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: 'warning',
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: 'warning',
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }

                }
            });

        }
        function EnptyChkboxs() {
            $('#checkAllbrand').prop('checked', true);
            BrandIds = '0';
            SubBrandIds = '0';
            SubPLine = '0';
            PartTypeIds = '0';
            Equipment = '0';
            searchdata = &quot;&quot;;
            searchMdata = &quot;&quot;;
            VehicleTypeIds = '0';
            MakeIds = '0';
            RegionIds = '0';
        }
        function CloseTab() {
            $(function () {
                $(&quot;#accordion&quot;).accordion({
                    header: &quot;h3&quot;, collapsible: true, heightStyle: &quot;content&quot;, active: false,

                    activate: function (event, ui) {
                        if (!$.isEmptyObject(ui.newHeader.offset())) {
                            $('html:not(:animated), body:not(:animated)').animate({ scrollTop: ui.newHeader.offset().top }, 'fast');
                        }
                    }
                });
            });
        }
        function loadBrand() {
            event.preventDefault();
            $('.loader_main_spin').show();
            $(&quot;#chkbrandlist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            var trading = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                if ($(&quot;#drptradingpartner&quot;).val() != 0) {
                    trading = $(&quot;#drptradingpartner&quot;).val();
                }
            }
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;AdminGroupID&quot;: AdminGroupID,
                &quot;Trading&quot;: trading
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'GetMainBrandsBasedonLineNew',
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    $('.loader_main_spin').show();
                    var divEdit = $(&quot;#chkbrandlist&quot;);
                    $(&quot;#Balllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (BrandIds != '0') {
                            var isChecked = BrandIds.split(',').includes(String(this['BrandAAIAID']));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp brandchk' checked='checked' id=&quot; + this['BrandAAIAID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Brandname'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['BrandAAIAID'] + &quot;>&quot; + this['Brandname'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp brandchk' id=&quot; + this['BrandAAIAID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Brandname'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['BrandAAIAID'] + &quot;>&quot; + this['Brandname'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp brandchk' checked='checked' id=&quot; + this['BrandAAIAID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Brandname'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['BrandAAIAID'] + &quot;>&quot; + this['Brandname'] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (BrandIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (BrandIds == &quot;0&quot;) {
                    //            BrandIds = '';
                    //        }
                    //        BrandIds += (BrandIds ? ',' : '') + this['BrandAAIAID'];
                    //    });
                    //}
                    $(&quot;.brandchk&quot;).change(function () {
                        if (LineTPwise != &quot;TP&quot;) {
                            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                                $(&quot;.brandchk&quot;).not(this).prop('checked', false);
                            }
                        }
                        BrandIds = $(&quot;.brandchk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.brandchk&quot;).length === $(&quot;.brandchk:checked&quot;).length;
                        $('#checkAllbrand').prop('checked', allChecked);
                    });
                    var allChecked = $(&quot;.brandchk&quot;).length === $(&quot;.brandchk:checked&quot;).length;
                    $('#checkAllbrand').prop('checked', allChecked);
                    if (LineTPwise != &quot;TP&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;.brandchk&quot;).prop('checked', true);
                            $(&quot;.brandchk&quot;).prop('disabled', true);
                        }
                        else {
                            $(&quot;#checkAllbrand&quot;).prop('disabled', false);
                        }
                    }
                    else {
                        $(&quot;.brandchk&quot;).prop(&quot;checked&quot;, true);
                    }
                    $('.loader_main_spin').hide();
                }
            });
            //$('.loader_main_spin').hide();
        }
        function loadSubBrand() {
            event.preventDefault();
            $('.loader_main_spin').show();
            $(&quot;#chkSubbrandlist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            var trading = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                if ($(&quot;#drptradingpartner&quot;).val() != 0) {
                    trading = $(&quot;#drptradingpartner&quot;).val();
                }
            }
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;BrandIds&quot;: BrandIds,
                &quot;Trading&quot;: trading
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'GetBrandsBasedonLineNew',
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    $('.loader_main_spin').show();
                    var divEdit = $(&quot;#chkSubbrandlist&quot;);
                    $(&quot;#SBalllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (SubBrandIds != '0') {
                            var isChecked = SubBrandIds.split(',').includes(String(this['BrandAAIAID']));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp Subbrandchk' checked='checked' id=&quot; + this['BrandAAIAID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Brandname'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['BrandAAIAID'] + &quot;>&quot; + this['Brandname'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp Subbrandchk' id=&quot; + this['BrandAAIAID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Brandname'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['BrandAAIAID'] + &quot;>&quot; + this['Brandname'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp Subbrandchk' checked='checked' id=&quot; + this['BrandAAIAID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Brandname'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['BrandAAIAID'] + &quot;>&quot; + this['Brandname'] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (SubBrandIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (SubBrandIds == &quot;0&quot;) {
                    //            SubBrandIds = '';
                    //        }
                    //        SubBrandIds += (SubBrandIds ? ',' : '') + this['BrandAAIAID'];
                    //    });
                    //}
                    $(&quot;.Subbrandchk&quot;).change(function () {
                        if (LineTPwise != &quot;TP&quot;) {
                            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                                $(&quot;.Subbrandchk&quot;).not(this).prop('checked', false);
                            }
                        }
                        SubBrandIds = $(&quot;.Subbrandchk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.Subbrandchk&quot;).length === $(&quot;.Subbrandchk:checked&quot;).length;
                        $('#checkAllSubbrand').prop('checked', allChecked);
                    });
                    var allChecked = $(&quot;.Subbrandchk&quot;).length === $(&quot;.Subbrandchk:checked&quot;).length;
                    $('#checkAllSubbrand').prop('checked', allChecked);
                    if (LineTPwise != &quot;TP&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;.Subbrandchk&quot;).prop('checked', true);
                            $(&quot;.Subbrandchk&quot;).prop('disabled', true);
                        }
                        else {
                            $(&quot;#checkAllSubbrand&quot;).prop('disabled', false);
                        }
                    }
                    else {
                        $(&quot;.Subbrandchk&quot;).prop(&quot;checked&quot;, true);
                    }
                    $('.loader_main_spin').hide();
                }
            });
            //$('.loader_main_spin').hide();
        }
        function CheckSubPline() {
            event.preventDefault();
            $('.loader_main_spin').show();
            var linecode = $(&quot;#DrpLine&quot;).val();
            $(&quot;#chkSubplinelist&quot;).empty();
            var data = {
                &quot;linecode&quot;: linecode
            }
            var url = WebAPIURL + 'CheckSubPline';
            if (ReadOnlyDB == &quot;true&quot;) {
                url = WebAPIURLReadOnly + 'CheckSubPline';
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: url,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    $('.loader_main_spin').show();
                    if (data.length > 0) {
                        $(&quot;#subplineh3&quot;).show();
                        var divEdit = $(&quot;#chkSubplinelist&quot;);
                        $(&quot;#Splalllist&quot;).show();
                        $.each(data, function (index, value) {
                            if (SubPLine != '0') {
                                var isChecked = SubPLine.split(',').includes(String(this['id']));
                                if (isChecked) {
                                    var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp SubPlinechk' checked='checked' id=&quot; + this['id'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Productline'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['id'] + &quot;>&quot; + this['Productline'] + &quot;&lt;/label>&lt;/li>&quot;;
                                }
                                else {
                                    var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp SubPlinechk' id=&quot; + this['id'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Productline'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['id'] + &quot;>&quot; + this['Productline'] + &quot;&lt;/label>&lt;/li>&quot;;
                                }
                                divEdit.append(rdb);
                            } else {
                                var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp SubPlinechk' checked='checked' id=&quot; + this['id'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Productline'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['id'] + &quot;>&quot; + this['Productline'] + &quot;&lt;/label>&lt;/li>&quot;;
                                divEdit.append(rdb);
                            }

                        });
                        //if (SubPLine == &quot;0&quot;) {
                        //    $.each(data, function (index, value) {
                        //        if (SubPLine == &quot;0&quot;) {
                        //            SubPLine = '';
                        //        }
                        //        SubPLine += (SubPLine ? ',' : '') + this['id'];
                        //    });
                        //}
                        $(&quot;.SubPlinechk&quot;).change(function () {
                            SubPLine = $(&quot;.SubPlinechk:checked&quot;).map(function () {
                                return this.id;
                            }).get().join(&quot;,&quot;);
                            var allChecked = $(&quot;.SubPlinechk&quot;).length === $(&quot;.SubPlinechk:checked&quot;).length;
                            $('#checkAllSubPline').prop('checked', allChecked);
                        });
                        var allChecked = $(&quot;.SubPlinechk&quot;).length === $(&quot;.SubPlinechk:checked&quot;).length;
                        $('#checkAllSubPline').prop('checked', allChecked);
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;.SubPlinechk&quot;).prop('checked',true);
                            $(&quot;.SubPlinechk&quot;).prop('disabled',true);
                        }
                        else {
                            $(&quot;#checkAllSubPline&quot;).prop('disabled', false);
                        }
                    }
                    else {
                        $(&quot;#subplineh3&quot;).hide();
                        SubPLine = '0';
                    }
                    $('.loader_main_spin').hide();
                },
                error: function (x, t, m) {
                    $('.loader_main_spin').hide();
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function loadPartType() {
            event.preventDefault();
			$(&quot;#filter&quot;).val(&quot;&quot;);
            $('.loader_main_spin').show();
            $(&quot;#chkPartTypelist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            var trading = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                if ($(&quot;#drptradingpartner&quot;).val() != 0) {
                    trading = $(&quot;#drptradingpartner&quot;).val();
                }
            }
            var storeid = $(&quot;#DrpEbay&quot;).val();
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;SubBrandIds&quot;: SubBrandIds,
                &quot;BrandIds&quot;: BrandIds,
                &quot;Adminid&quot;: AdminId,
                &quot;Trading&quot;: trading,
                &quot;storeid&quot;: storeid
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'GetPartTypedata',
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    debugger
                    $('.loader_main_spin').show();
                    var divEdit = $(&quot;#chkPartTypelist&quot;);
                    $(&quot;#PTalllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (PartTypeIds != '0') {
                            var isChecked = PartTypeIds.split(',').includes(String(this['PartDescriptionId']));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class='filterclass filterclassPT'>&lt;input class='filterinp PartTypechk' checked='checked' id=&quot; + this['PartDescriptionId'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['PartDescription'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['PartDescriptionId'] + &quot;>&quot; + this['PartDescription'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class='filterclass filterclassPT'>&lt;input class='filterinp PartTypechk' id=&quot; + this['PartDescriptionId'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['PartDescription'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['PartDescriptionId'] + &quot;>&quot; + this['PartDescription'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class='filterclass filterclassPT'>&lt;input class='filterinp PartTypechk' checked='checked' id=&quot; + this['PartDescriptionId'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['PartDescription'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['PartDescriptionId'] + &quot;>&quot; + this['PartDescription'] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (PartTypeIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (PartTypeIds == &quot;0&quot;) {
                    //            PartTypeIds = '';
                    //        }
                    //        PartTypeIds += (PartTypeIds ? ',' : '') + this['PartDescriptionId'];
                    //    });
                    //}
                    $(&quot;.PartTypechk&quot;).change(function () {
                        if (LineTPwise != &quot;TP&quot;) {
                            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                                $(&quot;.PartTypechk&quot;).not(this).prop('checked', false);
                            }
                        }
                        PartTypeIds = $(&quot;.PartTypechk:checked&quot;).filter(function () {
                            // Check if this checkbox is within a visible .filterclassPT element
                            return $(this).closest('.filterclassPT').is(':visible');
                        }).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.PartTypechk&quot;).length === $(&quot;.PartTypechk:checked&quot;).length;
                        $('#checkAllPartType').prop('checked', allChecked);
                    });
                    var allChecked = $(&quot;.PartTypechk&quot;).length === $(&quot;.PartTypechk:checked&quot;).length;
                    $('#checkAllPartType').prop('checked', allChecked);
                    if (LineTPwise != &quot;TP&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            if (PartTypeIds == '0') {
                                $(&quot;.PartTypechk&quot;).prop('checked', false);
                            }
                        }
                        else {
                            $(&quot;#checkAllPartType&quot;).prop('disabled', false);
                        }
                    }
                    else {
                        $(&quot;.PartTypechk&quot;).prop(&quot;checked&quot;, true);
                    }
                    $('.loader_main_spin').hide();
                }
            });
            
        }
        function searchPTpart() {
            var result = false;
            if ($(&quot;#filter&quot;).val() == &quot;&quot;) {
                alert(&quot;please enter a value&quot;);
                searchdata = &quot;&quot;;
            }
            if (searchdata == &quot;&quot;) {
                searchdata = $(&quot;#filter&quot;).val();
            }
            else {
                searchdata = searchdata + ',' + $(&quot;#filter&quot;).val();
            }
            var searchArray = searchdata.split(',');
            var re = new RegExp('^(' + searchArray.join('|') + ')', &quot;i&quot;);

            $('.filterclassPT').each(function () {
                var text = $(this).text(),
                    matches = !!text.match(re);
                $(this).toggle(matches);
                if (matches) {
                    result = true;
                }
            });
            PartTypeIds = $(&quot;.PartTypechk:checked&quot;).filter(function () {
                // Check if this checkbox is within a visible .filterclassPT element
                return $(this).closest('.filterclassPT').is(':visible');
            }).map(function () {
                return this.id;
            }).get().join(&quot;,&quot;);
        }
        function resetPTdata() {
            searchdata = &quot;&quot;;
            $('#filter').val('');
            $('.filterclassPT').each(function () {
                $(this).show();
            });
            //$('#checkAllPartType').prop('checked', true);
        }
        function loadVehicleType() {
            event.preventDefault();
            $('.loader_main_spin').show();
            $(&quot;#chkVehicleTypelist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            Equipment = &quot;0&quot;;
            if ($(&quot;#chkequ&quot;).is(':visible')) {
                Equipment = $(&quot;#chkequ&quot;).prop('checked') ? &quot;1&quot; : &quot;0&quot;;
            }
			if (Process == &quot;AllApplication&quot;){
				Equipment = &quot;1&quot;;
			}
            var storeid = $(&quot;#DrpEbay&quot;).val();
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;SubBrandIds&quot;: SubBrandIds,
                &quot;BrandIds&quot;: BrandIds,
                &quot;AdminID&quot;: AdminId,
                &quot;Partdesc&quot;: PartTypeIds,
                &quot;Type&quot;: &quot;Vehicle&quot;,
                &quot;Equipment&quot;: Equipment,
                &quot;VehicleTypeIds&quot;: &quot;&quot;,
                &quot;storeid&quot;: storeid
            }
            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                if (FMP != &quot;true&quot;) {
                    if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                        Swal.fire({
                            icon: 'warning',
                            title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        });
                        $(&quot;.loader_main_spin&quot;).hide();
                        return;
                    }

                }
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'GetVehicleTypeandMake',
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    debugger
                    $('.loader_main_spin').show();
                    var divEdit = $(&quot;#chkVehicleTypelist&quot;);
                    $(&quot;#VTalllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (VehicleTypeIds != '0') {
                            var isChecked = VehicleTypeIds.split(',').includes(String(this['VehicleTypeId']));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class='filterclass filterclassVT'>&lt;input class='filterinp VehicleTypechk' checked='checked' id=&quot; + this['VehicleTypeId'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['VehicleTypeName'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['VehicleTypeId'] + &quot;>&quot; + this['VehicleTypeName'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class='filterclass filterclassVT'>&lt;input class='filterinp VehicleTypechk' id=&quot; + this['VehicleTypeId'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['VehicleTypeName'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['VehicleTypeId'] + &quot;>&quot; + this['VehicleTypeName'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class='filterclass filterclassVT'>&lt;input class='filterinp VehicleTypechk' checked='checked' id=&quot; + this['VehicleTypeId'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['VehicleTypeName'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['VehicleTypeId'] + &quot;>&quot; + this['VehicleTypeName'] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (VehicleTypeIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (VehicleTypeIds == &quot;0&quot;) {
                    //            VehicleTypeIds = '';
                    //        }
                    //        VehicleTypeIds += (VehicleTypeIds ? ',' : '') + this['VehicleTypeId'];
                    //    });
                    //}
                    $(&quot;.VehicleTypechk&quot;).change(function () {
                        VehicleTypeIds = $(&quot;.VehicleTypechk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.VehicleTypechk&quot;).length === $(&quot;.VehicleTypechk:checked&quot;).length;
                        $('#checkAllVehicleType').prop('checked', allChecked);
                    });
                    var allChecked = $(&quot;.VehicleTypechk&quot;).length === $(&quot;.VehicleTypechk:checked&quot;).length;
                    $('#checkAllVehicleType').prop('checked', allChecked);
                    $('.loader_main_spin').hide();
                }
            });
            
        }
        function loadMake() {
            event.preventDefault();
			$(&quot;#filterM&quot;).val(&quot;&quot;);
            $('.loader_main_spin').show();
            $(&quot;#chkMakelist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            Equipment = &quot;1&quot;;
            if ($(&quot;#chkequ&quot;).is(':visible')) {
                Equipment = $(&quot;#chkequ&quot;).prop('checked') ? &quot;1&quot; : &quot;0&quot;;
            }
            var storeid = $(&quot;#DrpEbay&quot;).val();
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;SubBrandIds&quot;: SubBrandIds,
                &quot;BrandIds&quot;: BrandIds,
                &quot;AdminID&quot;: AdminId,
                &quot;Partdesc&quot;: PartTypeIds,
                &quot;Type&quot;: &quot;Make&quot;,
                &quot;Equipment&quot;: Equipment,
                &quot;VehicleTypeIds&quot;: VehicleTypeIds,
                &quot;storeid&quot;: storeid
            }
            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                if (FMP != &quot;true&quot;) {
                    if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                        Swal.fire({
                            icon: 'warning',
                            title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        });
                        $(&quot;.loader_main_spin&quot;).hide();
                        return;
                    }

                }
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'GetVehicleTypeandMake',
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    debugger
                    var divEdit = $(&quot;#chkMakelist&quot;);
                    $(&quot;#Malllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (MakeIds != '0') {
                            var isChecked = MakeIds.split(',').includes(String(this['MakeID']));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class='filterclass filterclassM'>&lt;input class='filterinp Makechk' checked='checked' id=&quot; + this['MakeID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Makename'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['MakeID'] + &quot;>&quot; + this['Makename'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class='filterclass filterclassM'>&lt;input class='filterinp Makechk' id=&quot; + this['MakeID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Makename'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['MakeID'] + &quot;>&quot; + this['Makename'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class='filterclass filterclassM'>&lt;input class='filterinp Makechk' checked='checked' id=&quot; + this['MakeID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['Makename'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['MakeID'] + &quot;>&quot; + this['Makename'] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (MakeIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (MakeIds == &quot;0&quot;) {
                    //            MakeIds = '';
                    //        }
                    //        MakeIds += (MakeIds ? ',' : '') + this['MakeID'];
                    //    });
                    //}
                    $(&quot;.Makechk&quot;).change(function () {
                        MakeIds = $(&quot;.Makechk:checked&quot;).filter(function () {
                            return $(this).closest('.filterclassM').is(':visible');
                        }).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.Makechk&quot;).length === $(&quot;.Makechk:checked&quot;).length;
                        $('#checkAllMake').prop('checked', allChecked);
                    });
                    var allChecked = $(&quot;.Makechk&quot;).length === $(&quot;.Makechk:checked&quot;).length;
                    $('#checkAllMake').prop('checked', allChecked);
                    $(&quot;.loader_main_spin&quot;).hide();
                }
            });
            //$('.loader_main_spin').hide();
        }
        function searchMpart() {
            var result = false;
            if ($(&quot;#filterM&quot;).val() == &quot;&quot;) {
                alert(&quot;please enter a value&quot;);
                searchMdata = &quot;&quot;;
            }
            if (searchMdata == &quot;&quot;) {
                searchMdata = $(&quot;#filterM&quot;).val();
            }
            else {
                searchMdata = searchMdata + ',' + $(&quot;#filterM&quot;).val();
            }
            var searchArray = searchMdata.split(',');
            var re = new RegExp('^(' + searchArray.join('|') + ')', &quot;i&quot;);

            $('.filterclassM').each(function () {
                var text = $(this).text(),
                    matches = !!text.match(re);
                $(this).toggle(matches);
                if (matches) {
                    result = true;
                }
            });
            MakeIds = $(&quot;.Makechk:checked&quot;).filter(function () {
                return $(this).closest('.filterclassM').is(':visible');
            }).map(function () {
                return this.id;
            }).get().join(&quot;,&quot;);
        }
        function resetMdata() {
            searchMdata = &quot;&quot;;
            $('#filterM').val('');
            $('.filterclassM').each(function () {
                $(this).show();
            });
        }
        function loadRegion() {
            event.preventDefault();
            $(&quot;#chkRegionlist&quot;).empty();
            var data = {}
            var url = WebAPIURL + 'loadRegion';
            if (ReadOnlyDB == &quot;true&quot;) {
                url = WebAPIURLReadOnly + 'loadRegion';
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: url,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    var divEdit = $(&quot;#chkRegionlist&quot;);
                    $(&quot;#Ralllist&quot;).show();
                    $.each(data, function (index, value) {
                        if (RegionIds != '0') {
                            var isChecked = RegionIds.split(',').includes(String(this['RegionID']));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp Regionchk' checked='checked' id=&quot; + this['RegionID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['RegionName'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['RegionID'] + &quot;>&quot; + this['RegionName'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp Regionchk' id=&quot; + this['RegionID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['RegionName'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['RegionID'] + &quot;>&quot; + this['RegionName'] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class='filterclass'>&lt;input class='filterinp Regionchk' checked='checked' id=&quot; + this['RegionID'] + &quot;  type='checkbox' name='rbCategories' value=&quot; + this['RegionName'] + &quot; />&lt;label class='filterlbl' for=&quot; + this['RegionID'] + &quot;>&quot; + this['RegionName'] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    if (RegionIds == &quot;0&quot;) {
                        RegionIds = '';
                        $.each(data, function (index, value) {
                            RegionIds += (RegionIds ? ',' : '') + value.RegionID;
                        });
                    }
                    $(&quot;.Regionchk&quot;).change(function () {
                        RegionIds = $(&quot;.Regionchk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.Regionchk&quot;).length === $(&quot;.Regionchk:checked&quot;).length;
                        $('#checkAllRegion').prop('checked', allChecked);
                    });
                    var allChecked = $(&quot;.Regionchk&quot;).length === $(&quot;.Regionchk:checked&quot;).length;
                    $('#checkAllRegion').prop('checked', allChecked);
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function Tradingchange() {
            var trading = $(&quot;#drptradingpartner&quot;).val();
            //CloseTab();
            //if (LineTPwise != &quot;Line&quot;) {
            //    Loadlinecode();
            //}
            //if ($(&quot;#drptradingpartner&quot;).val() != &quot;-SELECT-&quot;) {
            //    $(&quot;#drpinterchange&quot;).empty();
            //    $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
            //    $(&quot;#accordion&quot;).show();
            //    $(&quot;#Bottomdata&quot;).show();
            //    LineTPwise = &quot;TP&quot;;
            //}
            //else {
            //    $(&quot;#drpinterchange&quot;).empty();
            //    $(&quot;#accordion&quot;).hide();
            //    $(&quot;#Bottomdata&quot;).hide();
            //}
            if ($(&quot;#drptradingpartner&quot;).val() != &quot;0&quot;) {
                if (LineTPwise != &quot;Line&quot;) {
                    LineTPwise = &quot;TP&quot;;
                }
            }
            else {
                if (LineTPwise != &quot;Line&quot;) {
                    LineTPwise = &quot;&quot;;
                    Loadlinecode();
                }

            }
            if (LineTPwise == &quot;TP&quot;) {
                Loadlinecode();
            }
            if (trading != &quot;0&quot;) {
                $(&quot;#PartExport&quot;).hide();
                $(&quot;#checkExportSt&quot;).prop('checked', false).prop('disabled', true);
            }
            else {
                $(&quot;#PartExport&quot;).show();
                $(&quot;#checkExportSt&quot;).prop('checked', true).prop('disabled', false);
            }
            if (Process == &quot;Amazon&quot; || Process == &quot;Walmart&quot;) {
                $(&quot;#ExcelExport&quot;).hide();
                $(&quot;#CSVExport&quot;).hide();
            }
            Getoverlapdate();
            EnptyChkboxs();
            CloseTab();
        }
        function Getoverlapdate() {
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'Addpopupdetailscount',
                data: '',
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    var count = data[0].OverlapCount;
                    $('#getupdatecountvalue').text(data[0]['LastRunDate']);
                    $('#getupdatecount').text(data[0]['OverlapCount']);
                    if (count == 0) {
                        $('#Overlapcheckbox').hide();
                        $('#getupdatecountvalue').text(&quot;Not Run&quot;);
                    }
                },
            });
        }
        function loadSubHeader() {
            $(&quot;#SubmissionType&quot;).empty();
            $(&quot;#PIESSubmissionType&quot;).empty();
            if (Submissiontype == &quot;true&quot;) {
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;2&quot;).text(&quot;Update&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;2&quot;).text(&quot;Update&quot;));
            }
            else {
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
            }
            if (P2P == &quot;1&quot;) {
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;4&quot;).text(&quot;NET CHANGES&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;4&quot;).text(&quot;NET CHANGES&quot;));
            }
            $(&quot;#SubmissionType&quot;).val(&quot;1&quot;);
            $(&quot;#PIESSubmissionType&quot;).val(&quot;1&quot;);

        }
        function loadHeaderdetails() {
            event.preventDefault();
            var data = {
                &quot;AdminId&quot;: AdminId
            }
            var apiurl = WebAPIURL + 'loadHeaderdetails';
            if (ReadOnlyDB == &quot;true&quot;) {
                apiurl = WebAPIURLReadOnly + 'loadHeaderdetails';
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: apiurl,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    var Table = data.Table;
                    var Table1 = data.Table1;

                    ACompanyName = Table[0][&quot;CompanyName&quot;] ?? &quot;&quot;;
                    ACompanyContact = Table1[0][&quot;ContactName&quot;] ?? &quot;&quot;;
                    AEffectiveDate = Table[0][&quot;EffectiveDate&quot;] ? Table[0][&quot;EffectiveDate&quot;].split(&quot;T&quot;)[0] : &quot;&quot;;
                    Adoctitle = Table[0][&quot;doctitle&quot;] ?? &quot;&quot;;
                    ADocformnumber = Table[0][&quot;Docformnumber&quot;] ?? &quot;&quot;;
                    ASenderCompany = Table[0][&quot;SenderCompany&quot;] ?? &quot;&quot;;
                    ASenderContact = Table1[0][&quot;ContactName&quot;] ?? &quot;&quot;;
                    ASenderPhone = Table1[0][&quot;Phonenumber&quot;] ?? &quot;&quot;;
                    Asenderphoneext = Table[0][&quot;senderphoneext&quot;] ?? &quot;&quot;;
                    Asenderemail = Table1[0][&quot;Email&quot;] ?? &quot;&quot;;
                    AMapperCompany = Table[0][&quot;MapperCompany&quot;] ?? &quot;&quot;;
                    AMapperContact = Table[0][&quot;MapperContact&quot;] ?? &quot;&quot;;
                    AMapperPhone = Table[0][&quot;MapperPhone&quot;] ?? &quot;&quot;;
                    AMapperPhoneext = Table[0][&quot;MapperPhoneext&quot;] ?? &quot;&quot;;
                    AMapperEmail = Table[0][&quot;MapperEmail&quot;] ?? &quot;&quot;;
                    AApprovedfor = Table[0][&quot;Approvedfor&quot;] ?? &quot;&quot;;

                    $(&quot;#CompanyName&quot;).val(ACompanyName);
                    $(&quot;#CompanyContact&quot;).val(ACompanyContact);
                    $(&quot;#EffectiveDate&quot;).val(AEffectiveDate);
                    $('#DocumentTitle').val(Adoctitle);
                    $('#DocumentForm').val(ADocformnumber);
                    $('#SenderCompany').val(ASenderCompany);
                    $('#SenderContact').val(ASenderContact);
                    $('#SenderPhone').val(ASenderPhone);
                    $('#SenderPhoneExt').val(Asenderphoneext);
                    $('#SenderEmail').val(Asenderemail);
                    $('#MapperCompany').val(AMapperCompany);
                    $('#MapperContact').val(AMapperContact);
                    $('#MapperPhone').val(AMapperPhone);
                    $('#MapperPhoneExt').val(AMapperPhoneext);
                    $('#MapperEmail').val(AMapperEmail);
                    $('#txtapprove').val(AApprovedfor);
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function loadPIESHeaderdetails() {
            event.preventDefault();
            var data = {
                &quot;state&quot;: Services,
                &quot;AdminId&quot;: AdminId
            }
            var apiurl = WebAPIURL + 'loadPIESHeaderdetails';
            if (ReadOnlyDB == &quot;true&quot;) {
                apiurl = WebAPIURLReadOnly + 'loadPIESHeaderdetails';
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: apiurl,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    var Table = data.Table;
                    var Table1 = data.Table1;

                    PContactName = Table1[0][&quot;ContactName&quot;] ?? &quot;&quot;;
                    PContactEmail = Table1[0][&quot;Email&quot;] ?? &quot;&quot;;
                    $(&quot;#ContactName&quot;).val(PContactName);
                    $(&quot;#ContactEmail&quot;).val(PContactEmail);

                    PCompany = Table[0][&quot;CompanyName&quot;] ?? &quot;&quot;;
                    PPLA = Table[0][&quot;PLA&quot;] ?? &quot;&quot;;
                    PVendorNumber = Table[0][&quot;VendorNumber&quot;] ?? &quot;&quot;;
                    PPIESSubmissionType = Table[0][&quot;PIESSubmissionType&quot;] ?? &quot;&quot;;
                    PPriceSheetNum = Table[0][&quot;PriceSheetNum&quot;] ?? &quot;&quot;;
                    PBlanketEffectiveDate = Table[0][&quot;BlanketEffectiveDate&quot;]? Table[0][&quot;BlanketEffectiveDate&quot;].split(&quot;T&quot;)[0]: &quot;&quot;;

                    $(&quot;#CompanyNamePIES&quot;).val(PCompany);
                    $(&quot;#ProdLineAbbr&quot;).val(PPLA);
                    $(&quot;#Vendor&quot;).val(PVendorNumber);

                    // Select the matching option for submission type, safely
                    $(&quot;#PIESSubmissionType option&quot;).each(function () {
                        if ($(this).text() === PPIESSubmissionType) {
                            $(this).prop(&quot;selected&quot;, true);
                        }
                    });

                    $(&quot;#PriceSheet&quot;).val(PPriceSheetNum);
                    $(&quot;#PIESEffectiveDate&quot;).val(PBlanketEffectiveDate);

                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function getExcel() {
            if (Process == &quot;PIES&quot;) {
                if (LineTPwise == &quot;Line&quot;) {
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        if (FMP != &quot;true&quot;) {
                            var isOpen = $(&quot;#accordion h3&quot;).eq(3).next().is(&quot;:visible&quot;);
                            if (!isOpen) {
                                $(&quot;#accordion h3&quot;).eq(3).click();
                            }
                            if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                                Swal.fire({
                                    icon: 'warning',
                                    title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                                    allowOutsideClick: false,
                                    allowEscapeKey: false,
                                });
                                $(&quot;.loader_main_spin&quot;).hide();
                                return;
                            }
                            
                        }
                    }
                }
                Generate_PiesExportExcel();
            }
            if (Process == &quot;AllApplication&quot;) {
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    if (FMP != &quot;true&quot;) {
                        var isOpen = $(&quot;#accordion h3&quot;).eq(3).next().is(&quot;:visible&quot;);
                        if (!isOpen) {
                            $(&quot;#accordion h3&quot;).eq(3).click();
                        }
                        if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                            Swal.fire({
                                icon: 'warning',
                                title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                                allowOutsideClick: false,
                                allowEscapeKey: false,
                            });
                            $(&quot;.loader_main_spin&quot;).hide();
                            return;
                        }
                        
                    }
                }
                Generate_All_ApplicationExcel();
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                GenerateQDBRawExportExcel();
            }
            if (Process == &quot;ACESwithRawNote&quot;) {
                GenerateQDBRawExportExcel();
            }
            if (Process == &quot;Ebay&quot;) {
                GenerateEbayExcel();
            }
        }
        function getcsv() {
            if (Process == &quot;AllApplication&quot;) {
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    if (FMP != &quot;true&quot;) {
                        var isOpen = $(&quot;#accordion h3&quot;).eq(3).next().is(&quot;:visible&quot;);
                        if (!isOpen) {
                            $(&quot;#accordion h3&quot;).eq(3).click();
                        }
                        if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                            Swal.fire({
                                icon: 'warning',
                                title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                                allowOutsideClick: false,
                                allowEscapeKey: false,
                            });
                            $(&quot;.loader_main_spin&quot;).hide();
                            return;
                        }
                        
                    }
                }
                Generate_All_ApplicationCSV();
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                GenerateQDBRawExportCSV();
            }
            if (Process == &quot;ACESwithRawNote&quot;) {
                GenerateQDBRawExportCSV();
            }
        }
        function getxml() {
            if (Process == &quot;PIES&quot; || Process == &quot;WalmartPIES&quot;) {
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                        Swal.fire({
                            icon: 'warning',
                            title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        });
                        $(&quot;.loader_main_spin&quot;).hide();
                        return;
                    }
                }
                Generate_PiesXML();
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                ExportFTP = &quot;&quot;;
                if (customizedflag == &quot;1&quot;) {
                    GenerateACESXML();
                } else {
                    openPopup();
                }
                
            }
            if (Process == &quot;ACESwithRawNote&quot;) {
                ExportFTP = &quot;&quot;;
                if (customizedflag == &quot;1&quot;) {
                    GenerateACESXML();
                } else {
                    openPopup();
                }
            }
            if (Process == &quot;Amazon&quot;) {
                ExportFTP = &quot;&quot;;
                GenerateACESXML();
            }
            if (Process == &quot;Walmart&quot;) {
                ExportFTP = &quot;&quot;;
                GenerateACESXML();
            }

        }
        function getxmltoftp() {
            ExportFTP = &quot;Yes&quot;;
            GenerateACESXML();
        }
        function Generate_PiesExportExcel() {
            $('.loader_main_spin').show();
            var companyname = $(&quot;#CompanyNamePIES&quot;).val();
            companyname = companyname.replace(/[^A-Z0-9-_ ]/ig, &quot;&quot;);
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var SelectAllPartPiessxl = &quot;0&quot;;
            var Partdes = PartTypeIds;
            var MfrName = $(&quot;#DrpLine option:selected&quot;).text();
            MfrName = MfrName.split(&quot;|&quot;);
            MfrName = MfrName[0].trim();
            var ProductLine = SubPLine;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();

            if (Line != &quot;0&quot;) {

                if (Line == &quot;-SELECT-&quot;) {
                    alert(&quot;Please Select Line !!&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
                if (Brand == &quot;&quot;) {
                    alert(&quot;Please Select BrandName!&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
                if (ChkSubProdLineAlert == &quot;true&quot;) {
                    if (ProductLine == &quot;&quot;) {
                        alert(&quot;Please Select Sub Product Line!&quot;);
                        $('.loader_main_spin').hide();
                        return false;
                    }
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }

            if (ProductLine == &quot;&quot;) {
                ProductLine = &quot;0&quot;;
            }

            if ($(&quot;#checkExportSt&quot;).prop('checked')) {
                SelectAllPartPiessxl = &quot;1&quot;;
            }
            var unit = &quot;Unit&quot;;
            if (hdUnitComp == &quot;1&quot;) {
                unit = $(&quot;#Unitcomp option:selected&quot;).text();
            }
            var Filename = &quot;&quot;;

            var _data = {
                &quot;CompanyName&quot;: &quot;companyname&quot;,
                &quot;Piess&quot;: &quot;EPI&quot;,
                &quot;MfrBrandId&quot;: Line,
                &quot;MfrName&quot;: MfrName,
                &quot;PartDescriptionId&quot;: Partdes,
                &quot;BrandAAIAID&quot;: Brand,
                &quot;Productline&quot;: ProductLine,
                &quot;SelectAllParts&quot;: SelectAllPartPiessxl,
                &quot;AdminId&quot;: AdminId,
                &quot;Competitor&quot;: Competitor,
                &quot;Tradingpartner&quot;: Tradingpartner,
                &quot;UnitComponent&quot;: unit,
                &quot;Filename&quot;: Filename,
                &quot;BrandSubbrand&quot;: BrandSubbrand

            }
            if (ACESPIESQueue == &quot;false&quot;) {

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'GeneratePIESExcelExportNew',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })

            }
            else if (ACESPIESQueue == &quot;true&quot;) {

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'SavePiesExportexceldataNew',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            alert('Your export is initiated. Please check the Queue Management page for more details');

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Fail&quot;)
                        $('.loader_main_spin').hide();
                    }
                })
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                return false;
            }

        }
        function Generate_PiesXML() {
            $('.loader_main_spin').show();
            var companyname = $(&quot;#CompanyNamePIES&quot;).val().trim();
            companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
            if (typeof companyname === 'undefined' || companyname === null || companyname === '') {
                companyname = PCompany;  
            }
            var Pla = $(&quot;#PLA&quot;).val().trim();
            if (typeof Pla === 'undefined' || Pla === null || Pla === '') {
                Pla = PPLA || '';
            }
            var VendorNumber = $(&quot;#Vendor&quot;).val();
            if (typeof VendorNumber === 'undefined' || VendorNumber === null || VendorNumber === '') {
                VendorNumber = PVendorNumber;
            }
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            if (typeof drpSubmissionType === 'undefined' || drpSubmissionType === null || drpSubmissionType === '') {
                drpSubmissionType = &quot;Full&quot;;
            }
            var ContactPies = $(&quot;#ContactName&quot;).val();
            ContactPies = ContactPies.replace(/[&lt;>]/ig, &quot;&quot;);
            if (typeof ContactPies === 'undefined' || ContactPies === null || ContactPies === '') {
                ContactPies = PContactName;
            }
            var Email = $(&quot;#ContactEmail&quot;).val();
            if (typeof Email === 'undefined' || Email === null || Email === '') {
                Email = PContactEmail;
            }
            var EDate = $(&quot;#PIESEffectiveDate&quot;).val();
            if (typeof EDate === 'undefined' || EDate === null || EDate === '') {
                EDate = PBlanketEffectiveDate;
            }
            var PriceSheetNum = $(&quot;#PriceSheet&quot;).val();
            if (typeof PriceSheetNum === 'undefined' || PriceSheetNum === null || PriceSheetNum === '') {
                PriceSheetNum = PPriceSheetNum;
            }

            var ProductLine = SubPLine;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Partdes = PartTypeIds;

            var SelectAllPartPiessxml = &quot;1&quot;;
            if (ProductLine == &quot;&quot;) {
                ProductLine = &quot;0&quot;;
            }
            if (Process != &quot;WalmartPIES&quot;) {
                if ($(&quot;#checkExportSt&quot;).prop('checked')) {
                    SelectAllPartPiessxml = &quot;1&quot;;
                }
                else {
                    SelectAllPartPiessxml = &quot;0&quot;;
                }
            }
            var piesname = &quot;&quot;;
            var Tradingpartner = &quot;0&quot;;
            if (Process == &quot;WalmartPIES&quot;) {
                piesname = &quot;WAL&quot;;
                piesname = &quot;Walmart PIES&quot;;
            }
            else if (Process == &quot;PIES&quot;) {
                piesname = &quot;EPI&quot;;
                if (TradingPartnerwebconfig == &quot;true&quot;) {
                    var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
                }
                else {
                    var Tradingpartner = &quot;0&quot;;
                }
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;

            var txtUptodate = &quot;&quot;
            var txtFromDate = &quot;&quot;
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == &quot;&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (companyname == &quot;&quot; || companyname == undefined) {
                alert(&quot;Please enter the company name!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (ContactPies == &quot;&quot; || ContactPies == undefined) {
                alert(&quot;Please enter the Contact Name!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (Email == &quot;&quot; || Email == undefined) {
                alert(&quot;Please enter the Contact Email!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (EDate == &quot;&quot; || EDate == undefined) {
                alert(&quot;Please enter the Effective Date!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (PriceSheetNum == &quot;&quot; || PriceSheetNum == undefined) {
                alert(&quot;Please enter the Price Sheet #&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (drpSubmissionType == &quot;0&quot; || drpSubmissionType == undefined) {
                alert(&quot;Please select the Submission Type!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            var _data = {
                &quot;Line&quot;: Line,
                &quot;Brand&quot;: Brand,
                &quot;BrandSubbrand&quot;: BrandSubbrand,
                &quot;SubProductLine&quot;: ProductLine,
                &quot;Partdescription&quot;: Partdes,
                &quot;SelectAllPartPiessxml&quot;: SelectAllPartPiessxml,
                &quot;companyname&quot;: companyname,
                &quot;Pla&quot;: Pla,
                &quot;VendorNumber&quot;: VendorNumber,
                &quot;drpSubmissionType&quot;: drpSubmissionType,
                &quot;ContactPies&quot;: ContactPies,
                &quot;Email&quot;: Email,
                &quot;EDate&quot;: EDate,
                &quot;PriceSheetNum&quot;: PriceSheetNum,
                &quot;AdminId&quot;: AdminId,
                &quot;piesname&quot;: piesname,
                &quot;TradingPartner&quot;: Tradingpartner,
                &quot;Competitor&quot;: Competitor,
                &quot;Units&quot;: Units,
                &quot;Comp&quot;: Comp
            }

            if (ACESPIESQueue == &quot;false&quot;) {
                var dataxml = {
                    &quot;acespies&quot;: &quot;Pies&quot;,
                }
                $.ajax({
                    type: &quot;POST&quot;, 
                    url: WebAPIURL + 'queuecheckxmlPermission',
                    data: JSON.stringify(dataxml),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        if (response == '&quot;Yes&quot;') {
                            $('.loader_main_spin').hide();
                            alert(&quot;An XML file creation is in progress for another user. Please try after some time.&quot;);
                        } else {
                            $.ajax({
                                type: &quot;POST&quot;,
                                url: WebAPIURL + 'GeneratePIESXMLExportNew',
                                data: JSON.stringify(_data),
                                contentType: &quot;application/json; charset=utf-8&quot;,
                                success: function (response) {
                                    $('.loader_main_spin').hide();
                                    var data = JSON.parse(response);
                                    var count = data.Count;
                                    var name = data.Name;
                                    var result = data.Result;
                                    let services = piesname;

                                    if (piesname === &quot;Walmart PIES&quot;) {
                                        services = &quot;WAL&quot;;
                                    }
                                    const sanitizedName = name.replace(/[^a-zA-Z0-9-_ ]+/g, &quot;&quot;);
                                    const fullURL = `downloadPiesXml.aspx?Services=${services}&amp;company=${sanitizedName}`;
                                    if (count != &quot;0&quot;) {
                                        if (result == &quot;Success&quot;) {
                                            window.open(fullURL, '_blank', 'status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px');
                                        }
                                        else {
                                            alert(&quot;Run Api mode contact administator&quot;);
                                        }
                                    }
                                    else {
                                        alert(&quot;There is no data for this criteria&quot;);
                                    }


                                },
                                error: function () {

                                    alert(&quot;Failed!&quot;)
                                    $('.loader_main_spin').hide();
                                }
                            })
                        }
                    },
                    error: function () {
                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                });
            }
            else if (ACESPIESQueue == &quot;true&quot;) {               
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'SavePiesExportxmldataNew',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {

                            alert('Your export is initiated. Please check the Queue Management page for more details');

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function (err) {
                        console.log(err);
                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                return false;
            }

        }
        function Generate_All_ApplicationExcel() {
            $('.loader_main_spin').show();
            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;-SELECT-&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $('.loader_main_spin').hide();
                return false;
            } 

            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (Vehicle == &quot;&quot;) {
                alert(&quot;Select atleast one Vehicle!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (Make == &quot;&quot;) {
                alert(&quot;Select atleast one Make!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'AllApplicaionExcelExportQueueNew',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert('Your export is initiated. Please check the Queue Management page for more details');
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })
                //------------------  Queue end --------------------//
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'AllApplicaionExcelExport',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })
            }

        }
        function Generate_All_ApplicationCSV() {
            $('.loader_main_spin').show();
            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;-SELECT-&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }

            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (Vehicle == &quot;&quot;) {
                alert(&quot;Select atleast one Vehicle!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (Make == &quot;&quot;) {
                alert(&quot;Select atleast one Make!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'AllApplicaionExcelExportQueueNew',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert('Your export is initiated. Please check the Queue Management page for more details');
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })
                //------------------  Queue end --------------------//
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'AllApplicaionExcelExport',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })
            }

        }
        function GenerateQDBRawExportExcel() {
            $('.loader_main_spin').show();
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;

            var companyname = $(&quot;#CompanyNamePIES&quot;).val();
            companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var Tradingpartner = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(':visible')) {
                Equipment = $(&quot;#chkequ&quot;).prop('checked') ? &quot;True&quot; : &quot;False&quot;;
                
            }
            var ACES = &quot;ACES&quot;;
            var Customer = 0;
            var ChkAlloverlap = 0;
            var SelectAllPartsxl = &quot;0&quot;;
            if ($(&quot;#overlapchk&quot;).is(':visible')) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop('checked') ? &quot;1&quot; : &quot;0&quot;;
            }
            var ChkACESNotes = &quot;&quot;;
            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $('input[name=&quot;exportFormat&quot;]:checked').val() || &quot;4.2&quot;;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                ChkACESNotes = &quot;ACES with QDB Codes&quot;
            }
            else {
                Qualifierid = &quot;False&quot;;
                ChkACESNotes = &quot;ACES with Raw Notes&quot;
            }
            

            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;0&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if ($(&quot;#checkExportSt&quot;).prop('checked')) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var capitalcust = hdCapital;
            var IncludeCustomevalue = IncludeCustomValue;
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'ACESQDBRawNotesExcelExportQueueNew',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert('Your export is initiated. Please check the Queue Management page for more details');
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }
                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })

                // -----------------End Queue Process ------------
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'GetACESQDBRawNotesExportNew',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })

            }
        }
        function GenerateQDBRawExportCSV() {
            $('.loader_main_spin').show();
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;

            var companyname = $(&quot;#CompanyNamePIES&quot;).val();
            companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var Tradingpartner = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(':visible')) {
                Equipment = $(&quot;#chkequ&quot;).prop('checked') ? &quot;True&quot; : &quot;False&quot;;

            }
            var ACES = &quot;ACES&quot;;
            var Customer = 0;
            var ChkAlloverlap = 0;
            var SelectAllPartsxl = 0;
            if ($(&quot;#overlapchk&quot;).is(':visible')) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop('checked') ? &quot;1&quot; : &quot;0&quot;;
            }
            var ChkACESNotes = &quot;&quot;;
            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $('input[name=&quot;exportFormat&quot;]:checked').val()||&quot;4.2&quot;;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                ChkACESNotes = &quot;ACES with QDB Codes&quot;
            }
            else {
                Qualifierid = &quot;False&quot;;
                ChkACESNotes = &quot;ACES with Raw Notes&quot;
            }


            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;0&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if ($(&quot;#checkExportSt&quot;).prop('checked')) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var capitalcust = hdCapital;
            var IncludeCustomevalue = IncludeCustomValue;
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'ACESQDBRawNotesExcelExportQueueNew',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert('Your export is initiated. Please check the Queue Management page for more details');
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }
                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })

                // -----------------End Queue Process ------------
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'GetACESQDBRawNotesExportNew',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })

            }
        }
        function openPopup() {
            event.preventDefault();
            $('#modal_pop1').show();
            $(&quot;#modal_pop1&quot;).dialog({
                width: 800,
                iframeFix: true,
                close: function () {
                    $('.backgroud_fixed').hide();
                },
                buttons: {
                    YES: function btnsave_Click() {
                        Checkoutputcustom();
                        $(this).dialog(&quot;close&quot;);
                    },
                    NO: function Direct_Click() {
                        GenerateACESXML();
                        $(this).dialog(&quot;close&quot;);
                    }
                }
            });

            return true;
        }
        function Checkoutputcustom() {
            $('.loader_main_spin').show();
            var ExportType = hdExportType;
            var companyname = $(&quot;#CompanyName&quot;).val();
            if (typeof companyname === 'undefined' || companyname === null || companyname === '') {
                companyname = ACompanyName;
            }
            var companycontact = $(&quot;#CompanyContact&quot;).val();
            if (typeof companycontact === 'undefined' || companycontact === null || companycontact === '') {
                companycontact = ACompanyContact;
            }
            var txtEffectiveDate1 = $(&quot;#EffectiveDate&quot;).val();
            if (typeof txtEffectiveDate1 === 'undefined' || txtEffectiveDate1 === null || txtEffectiveDate1 === '') {
                txtEffectiveDate1 = AEffectiveDate;
            }
            var txtDocTitle = $('#DocumentTitle').val();
            if (typeof txtDocTitle === 'undefined' || txtDocTitle === null || txtDocTitle === '') {
                txtDocTitle = Adoctitle;
            }
            var cblapprovedfor = $('#txtapprove').val();
            if (typeof cblapprovedfor === 'undefined' || cblapprovedfor === null || cblapprovedfor === '') {
                cblapprovedfor = AApprovedfordata;
            }
            var txtSenderCompany = $('#SenderCompany').val();
            if (typeof txtSenderCompany === 'undefined' || txtSenderCompany === null || txtSenderCompany === '') {
                txtSenderCompany = ASenderCompany;
            }
            var txtSenderPhone = $('#SenderPhone').val();
            if (typeof txtSenderPhone === 'undefined' || txtSenderPhone === null || txtSenderPhone === '') {
                txtSenderPhone = ASenderPhone;
            }
            var txtSenderEmail = $('#SenderEmail').val();
            if (typeof txtSenderEmail === 'undefined' || txtSenderEmail === null || txtSenderEmail === '') {
                txtSenderEmail = Asenderemail;
            }
            var txtMapperCompany = $('#MapperCompany').val();
            if (typeof txtMapperCompany === 'undefined' || txtMapperCompany === null || txtMapperCompany === '') {
                txtMapperCompany = AMapperCompany;
            }
            var txtMapperPhone = $('#MapperPhone').val();
            if (typeof txtMapperPhone === 'undefined' || txtMapperPhone === null || txtMapperPhone === '') {
                txtMapperPhone = AMapperPhone;
            }
            var txtMapperEmail = $('#MapperEmail').val();
            if (typeof txtMapperEmail === 'undefined' || txtMapperEmail === null || txtMapperEmail === '') {
                txtMapperEmail = AMapperEmail;
            }
            var txtContact = $('#SenderContact').val();
            if (typeof txtContact === 'undefined' || txtContact === null || txtContact === '') {
                txtContact = ASenderContact;
            }
            var drpSubmissionType = $(&quot;#SubmissionType option:selected&quot;).text();
            if (typeof drpSubmissionType === 'undefined' || drpSubmissionType === null || drpSubmissionType === '') {
                drpSubmissionType = &quot;FULL&quot;;
            }
            var txtDocFormNo = $('#DocumentForm').val();
            if (typeof txtDocFormNo === 'undefined' || txtDocFormNo === null || txtDocFormNo === '') {
                txtDocFormNo = ADocformnumber;
            }
            var txtSenderContact = $('#SenderContact').val();
            if (typeof txtSenderContact === 'undefined' || txtSenderContact === null || txtSenderContact === '') {
                txtSenderContact = ASenderContact;
            }
            var txtSenderPhoneExt = $('#SenderPhoneExt').val();
            if (typeof txtSenderPhoneExt === 'undefined' || txtSenderPhoneExt === null || txtSenderPhoneExt === '') {
                txtSenderPhoneExt = Asenderphoneext;
            }
            var txtMapperContact = $('#MapperContact').val();
            if (typeof txtMapperContact === 'undefined' || txtMapperContact === null || txtMapperContact === '') {
                txtMapperContact = AMapperContact;
            }
            var txtMapperPhoneExt = $('#MapperPhoneExt').val();
            if (typeof txtMapperPhoneExt === 'undefined' || txtMapperPhoneExt === null || txtMapperPhoneExt === '') {
                txtMapperPhoneExt = AMapperPhoneext;
            }
            if (hdbrand == &quot;false&quot;) {
                var BrandAAIAIDHeader = &quot;&quot;;
            }
            else {
                var BrandAAIAIDHeader = $(&quot;#txtbrandid&quot;).val();
                if (BrandAAIAIDHeader != &quot;&quot; &amp;&amp; BrandAAIAIDHeader.length &lt; 4) {
                    alert(&quot;Brand AAIAID must have 4 characters&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
                var regex = /^[a-zA-Z]+$/;
                if (!regex.test(BrandAAIAIDHeader)) {
                    alert(&quot;Invalid BrandID&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
            }

            var date = txtEffectiveDate1;
            //var txtEffectiveDate = &quot;&quot;;
            //txtEffectiveDate = (date.substr(6, 4) + &quot;-&quot; + date.substr(0, 2) + &quot;-&quot; + date.substr(3, 2));
            txtEffectiveDate = txtEffectiveDate1;


            var Qualifier = &quot;&quot;;
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifier = true;
            }
            else {
                Qualifier = false;
            }
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == '0') {
                alert(&quot;Please select Line&quot;);
                return false;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(':visible')) {
                Equipment = $(&quot;#chkequ&quot;).prop('checked') ? &quot;True&quot; : &quot;False&quot;;
            }
            var ChkAlloverlap = 0;
            if ($(&quot;#overlapchk&quot;).is(':visible')) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop('checked') ? &quot;1&quot; : &quot;0&quot;;
            }
            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $('input[name=&quot;group_header&quot;]:checked').val() || 'Both';
            }
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var SelectAllPartsxl = &quot;0&quot;;
            if ($(&quot;#checkExportSt&quot;).prop('checked')) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var CustomerId = 0;
            var PartDescriptionId = PartTypeIds;
            var BrandIDs = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var makename = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;
            if (BrandIDs == &quot;&quot;) {
                alert(&quot;Please select Brand&quot;);
                return false;
            }
            if (companyname == &quot;&quot;) {
                alert(&quot;Please select  Company Name&quot;);
                return false;
            }
            if (companycontact == &quot;&quot;) {
                alert(&quot;Please select  Company Contact&quot;);
                return false;
            }
            if (date == &quot;&quot;) {
                alert(&quot;Please select Effective Date&quot;);
                return false;
            }
            if (txtDocTitle == &quot;&quot;) {
                alert(&quot;Please select Document Title&quot;);
                return false;
            }
            if (txtSenderPhone == &quot;&quot;) {
                alert(&quot;Please select Sender Phone&quot;);
                return false;
            }
            if (txtSenderContact == &quot;&quot;) {
                alert(&quot;Please select Sender Contact&quot;);
                return false;
            }
            if (txtContact == &quot;&quot;) {
                alert(&quot;Please select Company Contact &quot;);
                return false;
            }
            if (drpSubmissionType == &quot;0&quot;) {
                alert(&quot;Please select Submission Type &quot;);
                return false;
            }
            if (PartDescriptionId == &quot;&quot;) {
                alert(&quot;Please select atleast 1 Part Description(s)&quot;);
                return false;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                var Acesname = &quot;ACES with QDB Codes&quot;
            }
            else if (Process == &quot;ACESwithRawNote&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;ACES with Raw Notes&quot;
            }
            var ExporttoFTP = &quot;&quot;;
            var path = window.location.href.replace(window.location.hostname + '/', '').replace(window.location.protocol + '//', '').replace(window.location.search, '').replace(':' + window.location.port, '')
            var sitename = path.substring(0, path.indexOf('/'));
            if (sitename == 'localhost') {
                sitename = &quot;&quot;;
            }
            else if (sitename == 'APAPMTTEST') {
                sitename = sitename + '/'
            }
            else if (sitename == 'Youtechpmt') {
                sitename = sitename + '/'
            }
            else {
                //sitename = sitename + '/'
                sitename = &quot;&quot;;
            }

            debugger
            var AcesExportVersion = &quot;&quot;;
            var ObjData = {
                &quot;Line&quot;: Line,
                &quot;Equipment&quot;: Equipment.toString(),
                &quot;Competitorid&quot;: Competitor,
                &quot;Unit&quot;: Units.toString(),
                &quot;comp&quot;: Comp.toString(),
                &quot;Tradingpartner&quot;: Tradingpartner,
                &quot;Brandname&quot;: BrandIDs,
                &quot;SubBrandName&quot;: BrandSubbrand,
                &quot;Productline&quot;: ProductLine,
                &quot;PartDescription&quot;: PartDescriptionId,
                &quot;SelectAllParts&quot;: SelectAllPartsxl,
                &quot;VehicleType&quot;: Vehicle,
                &quot;MakeId&quot;: makename,
                &quot;region&quot;: region,
                &quot;CompanyName&quot;: companyname,
                &quot;AdminId&quot;: AdminId,
                &quot;Contact&quot;: txtContact,
                &quot;EffectiveDate&quot;: txtEffectiveDate,
                &quot;drpSubmissionType&quot;: drpSubmissionType,
                &quot;DocTitle&quot;: txtDocTitle,
                &quot;DocFormNo&quot;: txtDocFormNo,
                &quot;Approvedfor&quot;: cblapprovedfor,
                &quot;SenderCompany&quot;: txtSenderCompany,
                &quot;SenderContact&quot;: txtSenderContact,
                &quot;SenderPhone&quot;: txtSenderPhone,
                &quot;SenderPhoneExt&quot;: txtSenderPhoneExt,
                &quot;SenderEmail&quot;: txtSenderEmail,
                &quot;MapperCompany&quot;: txtMapperCompany,
                &quot;MapperContact&quot;: txtMapperContact,
                &quot;MapperPhone&quot;: txtMapperPhone,
                &quot;MapperPhoneExt&quot;: txtMapperPhoneExt,
                &quot;MapperEmail&quot;: txtMapperEmail,
                &quot;BrandID&quot;: BrandAAIAIDHeader,
                &quot;Acesname&quot;: Acesname,
                &quot;strACES&quot;: &quot;Aces&quot;,
                &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                &quot;AcesOverpopulate&quot;: Overpopulate,
                &quot;ExporttoFTP&quot;: ExporttoFTP
            }
            //var ObjData = '{&quot;PartDescriptionId&quot;: &quot;' + PartDescription + '&quot;, &quot;ACES&quot;: &quot;ACES&quot;,&quot;SP&quot;:&quot;' + Sp + '&quot;, &quot;CustomerId&quot;: &quot;' + CustomerId + '&quot;, &quot;LineNo&quot;: &quot;' + Line + '&quot;, &quot;Brandss&quot;: &quot;' + Brandssss + '&quot;,&quot;productliness&quot;: &quot;' + productliness + '&quot;, &quot;Vehicless&quot;: &quot;' + Vehicles + '&quot;, &quot;makenamess&quot;: &quot;' + makenames + '&quot;, &quot;companyname&quot;: &quot;' + companyname + '&quot;, &quot;txtEffectiveDate&quot;: &quot;' + txtEffectiveDate + '&quot;,&quot;txtDocTitle&quot;: &quot;' + txtDocTitle + '&quot;, &quot;cblapprovedfor&quot;: &quot;' + cblapprovedfor + '&quot;,&quot;txtSenderCompany&quot;:&quot;' + txtSenderCompany + '&quot;,&quot;txtSenderPhone&quot;:&quot;' + txtSenderPhone + '&quot;,&quot;txtSenderEmail&quot;: &quot;' + txtSenderEmail + '&quot;, &quot;txtMapperCompany&quot;:&quot;' + txtMapperCompany + '&quot;,&quot;txtMapperPhone&quot;:&quot;' + txtMapperPhone + '&quot;,&quot;txtMapperEmail&quot;:&quot;' + txtMapperEmail + '&quot;,&quot;txtContact&quot;:&quot;' + txtContact + '&quot;,&quot;drpSubmissionType&quot;:&quot;' + drpSubmissionType + '&quot;,&quot;txtDocFormNo&quot;:&quot;' + txtDocFormNo + '&quot;,&quot;txtSenderContact&quot;:&quot;' + txtSenderContact + '&quot;,&quot;txtMapperContact&quot;:&quot;' + txtMapperContact + '&quot;,&quot;txtMapperPhoneExt&quot;:&quot;' + txtMapperPhoneExt + '&quot;,&quot;Qualifier&quot;:&quot;' + Qualifier + '&quot;,&quot;Competitor&quot;:&quot;' + Competitor + '&quot;,&quot;TradingPartner&quot;:&quot;' + TradingPartner + '&quot;,&quot;Equipment&quot;:&quot;' + Equipment + '&quot;,&quot;Class&quot;:&quot;' + Classs + '&quot;,&quot;Acesname&quot;:&quot;' + Acesname + '&quot;,&quot;ACESExportVersion&quot;:&quot;' + AcesExportVersion + '&quot;,&quot;BrandAAIAIDHeader&quot;:&quot;' + BrandAAIAIDHeader + '&quot;}';
            var obj = 0;
            $.ajax({
                type: &quot;POST&quot;,
                async: false,
                url: WebAPIURL + 'GetsaveCustomexport',
                data: JSON.stringify(ObjData),
                dataType: &quot;JSON&quot;,
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    obj = response;
                    $('.loader_main_spin').hide();
                    return;
                },
                error: function () {
                    $('.loader_main_spin').hide();
                    alert(&quot;Failed!&quot;);
                    //$('.loader_main_spin').hide();
                }
            });

            if (obj > 0) {
                //window.showModalDialog(&quot;/&quot; + sitename + &quot;/Reports/output.aspx&quot; + &quot;?Exportid=&quot; + obj, &quot;_blank&quot;, &quot;dialogWidth:700px; dialogHeight:550px; dialogLeft:450; dialogTop:200; center:1; status:0; help:0&quot;);
                window.open(&quot;../Reports/output.aspx&quot; + &quot;?Exportid=&quot; + obj, &quot;_blank&quot;, &quot;width=700,height=550,left=450,top=200,status=no,menubar=no,toolbar=no&quot;);
                //OpenPartNoPopupExportcustom(sitename + 'Reports', 'output.aspx', '' + PartDescription + '', ExportType, Ecommerece, Sp, CustomerId, Line, Brandssss, productliness, Vehicles, makenames, companyname, txtEffectiveDate, txtDocTitle, cblapprovedfor, txtSenderCompany, txtSenderPhone, txtSenderEmail, txtMapperCompany, txtMapperPhone, txtMapperEmail, txtContact, drpSubmissionType, txtDocFormNo, txtSenderContact, txtMapperContact, txtMapperPhoneExt, Qualifier, '700', '550', '450', '200', Competitor, TradingPartner, Equipment, Classs, Acesname, AcesExportVersion, BrandAAIAIDHeader);
            }
            return true;
            ClosePopUp();

        }
        function GenerateACESXML() {
            var companyname = $(&quot;#CompanyName&quot;).val();
            if (typeof companyname === 'undefined' || companyname === null || companyname === '') {
                companyname = ACompanyName;
            }
            var txtEffectiveDate1 = $(&quot;#EffectiveDate&quot;).val();
            if (typeof txtEffectiveDate1 === 'undefined' || txtEffectiveDate1 === null || txtEffectiveDate1 === '') {
                txtEffectiveDate1 = AEffectiveDate;
            }
            var txtDocTitle = $('#DocumentTitle').val();
            if (typeof txtDocTitle === 'undefined' || txtDocTitle === null || txtDocTitle === '') {
                txtDocTitle = Adoctitle;
            }
            var cblapprovedfor = $('#txtapprove').val();
            if (typeof cblapprovedfor === 'undefined' || cblapprovedfor === null || cblapprovedfor === '') {
                cblapprovedfor = AApprovedfordata;
            }
            var txtSenderCompany = $('#SenderCompany').val();
            if (typeof txtSenderCompany === 'undefined' || txtSenderCompany === null || txtSenderCompany === '') {
                txtSenderCompany = ASenderCompany;
            }
            var txtSenderPhone = $('#SenderPhone').val();
            if (typeof txtSenderPhone === 'undefined' || txtSenderPhone === null || txtSenderPhone === '') {
                txtSenderPhone = ASenderPhone;
            }
            var txtSenderEmail = $('#SenderEmail').val();
            if (typeof txtSenderEmail === 'undefined' || txtSenderEmail === null || txtSenderEmail === '') {
                txtSenderEmail = Asenderemail;
            }
            var txtMapperCompany = $('#MapperCompany').val();
            if (typeof txtMapperCompany === 'undefined' || txtMapperCompany === null || txtMapperCompany === '') {
                txtMapperCompany = AMapperCompany;
            }
            var txtMapperPhone = $('#MapperPhone').val();
            if (typeof txtMapperPhone === 'undefined' || txtMapperPhone === null || txtMapperPhone === '') {
                txtMapperPhone = AMapperPhone;
            }
            var txtMapperEmail = $('#MapperEmail').val();
            if (typeof txtMapperEmail === 'undefined' || txtMapperEmail === null || txtMapperEmail === '') {
                txtMapperEmail = AMapperEmail;
            }
            var txtContact = $('#SenderContact').val();
            if (typeof txtContact === 'undefined' || txtContact === null || txtContact === '') {
                txtContact = ASenderContact;
            }
            var drpSubmissionType = $(&quot;#SubmissionType option:selected&quot;).text();
            if (typeof drpSubmissionType === 'undefined' || drpSubmissionType === null || drpSubmissionType === '') {
                drpSubmissionType = &quot;FULL&quot;;
            }
            var txtDocFormNo = $('#DocumentForm').val();
            if (typeof txtDocFormNo === 'undefined' || txtDocFormNo === null || txtDocFormNo === '') {
                txtDocFormNo = ADocformnumber;
            }
            var txtSenderContact = $('#SenderContact').val();
            if (typeof txtSenderContact === 'undefined' || txtSenderContact === null || txtSenderContact === '') {
                txtSenderContact = ASenderContact;
            }
            var txtSenderPhoneExt = $('#SenderPhoneExt').val();
            if (typeof txtSenderPhoneExt === 'undefined' || txtSenderPhoneExt === null || txtSenderPhoneExt === '') {
                txtSenderPhoneExt = Asenderphoneext;
            }
            var txtMapperContact = $('#MapperContact').val();
            if (typeof txtMapperContact === 'undefined' || txtMapperContact === null || txtMapperContact === '') {
                txtMapperContact = AMapperContact;
            }
            var txtMapperPhoneExt = $('#MapperPhoneExt').val();
            if (typeof txtMapperPhoneExt === 'undefined' || txtMapperPhoneExt === null || txtMapperPhoneExt === '') {
                txtMapperPhoneExt = AMapperPhoneext;
            }
            if (hdbrand == &quot;false&quot;) {
                var BrandAAIAIDHeader = &quot;&quot;;
            }
            else {
                var BrandAAIAIDHeader = $(&quot;#txtbrandid&quot;).val();
                if (BrandAAIAIDHeader != &quot;&quot; &amp;&amp; BrandAAIAIDHeader.length &lt; 4) {
                    alert(&quot;Brand AAIAID must have 4 characters&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
                var regex = /^[a-zA-Z]+$/;
                if (!regex.test(BrandAAIAIDHeader)) {
                    alert(&quot;Invalid BrandID&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
            }

            var date = txtEffectiveDate1;
            //var txtEffectiveDate = &quot;&quot;;
            //txtEffectiveDate = (date.substr(6, 4) + &quot;-&quot; + date.substr(0, 2) + &quot;-&quot; + date.substr(3, 2));
            txtEffectiveDate = txtEffectiveDate1;

            var Qualifier = &quot;&quot;;
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifier = &quot;true&quot;;
            }
            else {
                Qualifier = &quot;false&quot;;
            }
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == '0') {
                alert(&quot;Please select Line&quot;);
                return false;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(':visible')) {
                Equipment = $(&quot;#chkequ&quot;).prop('checked') ? &quot;True&quot; : &quot;False&quot;;
            }
            var ChkAlloverlap = 0;
            if ($(&quot;#overlapchk&quot;).is(':visible')) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop('checked') ? &quot;1&quot; : &quot;0&quot;;
            }
            var exportFormat = &quot;&quot;
            exportFormat = $('input[name=&quot;exportFormat&quot;]:checked').val() || &quot;4.2&quot;;

            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $('input[name=&quot;group_header&quot;]:checked').val() || 'Both';
            }
            var Tradingpartner = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            if (Tradingpartner == undefined) {
                Tradingpartner = &quot;0&quot;;
            }
            if (Overpopulate == undefined) {
                Overpopulate = &quot;&quot;;
            }
            var SelectAllPartsxl = &quot;0&quot;;
            if ($(&quot;#checkExportSt&quot;).prop('checked')) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var CustomerId = 0;
            var PartDescriptionId = PartTypeIds;
            var BrandIDs = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var makename = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;
            if (BrandIDs == &quot;&quot;) {
                alert(&quot;Please select Brand&quot;);
                return false;
            }
            if (companyname == &quot;&quot;) {
                alert(&quot;Please select  Company Name&quot;);
                return false;
            }
            if (date == &quot;&quot;) {
                alert(&quot;Please select Effective Date&quot;);
                return false;
            }
            if (txtDocTitle == &quot;&quot;) {
                alert(&quot;Please select Document Title&quot;);
                return false;
            }
            if (txtSenderPhone == &quot;&quot;) {
                alert(&quot;Please select Sender Phone&quot;);
                return false;
            }
            if (txtSenderContact == &quot;&quot;) {
                alert(&quot;Please select Sender Contact&quot;);
                return false;
            }
            if (txtContact == &quot;&quot;) {
                alert(&quot;Please select Company Contact &quot;);
                return false;
            }
            if (drpSubmissionType == &quot;0&quot;) {
                alert(&quot;Please select Submission Type &quot;);
                return false;
            }
            if (PartDescriptionId == &quot;&quot;) {
                alert(&quot;Please select atleast 1 Part Description(s)&quot;);
                return false;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                var Acesname = &quot;ACES with QDB Codes&quot;
            }
            else if (Process == &quot;ACESwithRawNote&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;ACES with Raw Notes&quot;
            }
            else if (Process == &quot;Amazon&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;Amazon&quot;
            }
            else if (Process == &quot;Walmart&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;Walmart&quot;
            }

            if (ExportFTP == &quot;Yes&quot;) {
                var ExporttoFTP = &quot;Yes&quot;;
            }
            else {
                var ExporttoFTP = &quot;&quot;;
            }

            var _data = {
                &quot;Line&quot;: Line,
                &quot;Equipment&quot;: Equipment.toString(),
                &quot;Competitorid&quot;: Competitor,
                &quot;Unit&quot;: Units.toString(),
                &quot;comp&quot;: Comp.toString(),
                &quot;Tradingpartner&quot;: Tradingpartner,
                &quot;Brandname&quot;: BrandIDs,
                &quot;SubBrandName&quot;: BrandSubbrand,
                &quot;Productline&quot;: ProductLine,
                &quot;PartDescription&quot;: PartDescriptionId,
                &quot;SelectAllParts&quot;: SelectAllPartsxl,
                &quot;VehicleType&quot;: Vehicle,
                &quot;MakeId&quot;: makename,
                &quot;region&quot;: region,
                &quot;CompanyName&quot;: companyname,
                &quot;AdminId&quot;: AdminId,
                &quot;Contact&quot;: txtContact,
                &quot;EffectiveDate&quot;: txtEffectiveDate,
                &quot;drpSubmissionType&quot;: drpSubmissionType,
                &quot;DocTitle&quot;: txtDocTitle,
                &quot;DocFormNo&quot;: txtDocFormNo,
                &quot;Approvedfor&quot;: cblapprovedfor,
                &quot;SenderCompany&quot;: txtSenderCompany,
                &quot;SenderContact&quot;: txtSenderContact,
                &quot;SenderPhone&quot;: txtSenderPhone,
                &quot;SenderPhoneExt&quot;: txtSenderPhoneExt,
                &quot;SenderEmail&quot;: txtSenderEmail,
                &quot;MapperCompany&quot;: txtMapperCompany,
                &quot;MapperContact&quot;: txtMapperContact,
                &quot;MapperPhone&quot;: txtMapperPhone,
                &quot;MapperPhoneExt&quot;: txtMapperPhoneExt,
                &quot;MapperEmail&quot;: txtMapperEmail,
                &quot;BrandID&quot;: BrandAAIAIDHeader,
                &quot;Acesname&quot;: Acesname,
                &quot;strACES&quot;: &quot;Aces&quot;,
                &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                &quot;AcesOverpopulate&quot;: Overpopulate,
                &quot;ExporttoFTP&quot;: ExporttoFTP,
                &quot;exportFormat&quot;: exportFormat,
                &quot;Qualifier&quot;: Qualifier,
                &quot;customizedflag&quot;: customizedflag
            }
            $('.loader_main_spin').show();
            if (ACESPIESQueue == &quot;true&quot;) {
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'SaveAcesExportxmldataNew',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {

                            alert('Your export is initiated. Please check the Queue Management page for more details');

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function (err) {
                        console.log(err);
                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })
            }
            else {
                var dataxml = {
                    &quot;acespies&quot;: &quot;Aces&quot;,
                }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'queuecheckxmlPermission',
                    data: JSON.stringify(dataxml),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        if (response == '&quot;Yes&quot;') {
                            $('.loader_main_spin').hide();
                            alert(&quot;An XML file creation is in progress for another user. Please try after some time.&quot;);
                        }
                        else {
                            $.ajax({
                                type: &quot;POST&quot;,
                                url: WebAPIURL + 'GetAcesExportxmldataNew',
                                data: JSON.stringify(_data),
                                contentType: &quot;application/json; charset=utf-8&quot;,
                                success: function (response) {
                                    debugger
                                    $('.loader_main_spin').hide();
                                    var data = JSON.parse(response);
                                    var count = data.Count;
                                    var name = data.Name;
                                    var result = data.Result;
                                    var services = Acesname;
                                    var rbb = $('input[name=&quot;exportFormat&quot;]:checked').val();
                                    if (rbb == &quot;&quot; &amp;&amp; rbb == undefined) {
                                        rbb = &quot;4.2&quot;;
                                    }
                                    const sanitizedName = name.replace(/[^a-zA-Z0-9-_ ]+/g, &quot;&quot;);
                                    const fullURL = `downloadAcesXml.aspx?Aces=${services}&amp;company=${sanitizedName}&amp;Qualifier=${Qualifier}&amp;Equipment=${Equipment}&amp;ExportFormat=${rbb}`;
                                    if (count != &quot;0&quot;) {
                                        if (result == &quot;Success&quot;) {
                                            window.open(fullURL, '_blank', 'status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px');
                                        }
                                        else {
                                            alert(&quot;Run Api mode contact administator&quot;);
                                        }
                                    }
                                    else {
                                        $('.loader_main_spin').hide();
                                        alert(&quot;There is no data for this criteria&quot;);
                                    }

                                },
                                error: function () {

                                    alert(&quot;Failed!&quot;)
                                    $('.loader_main_spin').hide();
                                }
                            })
                        }
                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                return false;
            }
        }
        function specificspecialchar(e) {
            var k = e.keyCode == 0 ? e.charCode : e.keyCode;
            if ((k > 64 &amp;&amp; k &lt; 91) || (k > 96 &amp;&amp; k &lt; 123) || k == 8 || k == 32 || (k >= 48 &amp;&amp; k &lt;= 57)) {
                return true;
            }
            else {
                return false;
            }
        }
        function handlePaste(e) {
            var clipboardData = event.clipboardData || window.clipboardData;
            var pastedData = clipboardData.getData('Text');

            var prohibitedChars = [&quot;;&quot;, &quot;[&quot;, &quot;]&quot;, &quot;{&quot;, &quot;}&quot;, &quot;~&quot;, &quot;|&quot;, &quot;,&quot;, &quot;\&quot;&quot;, &quot;%&quot;, &quot;!&quot;, &quot;@&quot;, &quot;#&quot;, &quot;^&quot;, &quot;&amp;&quot;, &quot;(&quot;, &quot;)&quot;, &quot;,&quot;, &quot;.&quot;, &quot;/&quot;, &quot;:&quot;, &quot;+&quot;, &quot;-&quot;, &quot;_&quot;, &quot;=&quot;, &quot;$&quot;, &quot;*&quot;, &quot;?&quot;, &quot;'&quot;];
            for (var i = 0; i &lt; prohibitedChars.length; i++) {
                if (pastedData.includes(prohibitedChars[i])) {
                    event.preventDefault();
                    Swal.fire({
                        icon: 'warning',
                        text: &quot;Pasted Value has Restricted Special Characters&quot;,
                        allowOutsideClick: false,
                        allowEscapeKey: false,
                    });
                    return false;
                }
            }
            return true;
        }
        function Checknewexport() {
            debugger
            var PartDescriptionId = PartTypeIds;
            var BrandIDs = BrandIds;
            var productlines = SubPLine;
            var ExportType = hdExportType;
            var Ecommerece = Services;
            
            var Trading = &quot;0&quot;;
            if (Services == 'ACES') {
                if (TradingPartnerwebconfig == &quot;true&quot;) {
                    var Trading = $(&quot;#drptradingpartner option:selected&quot;).val();
                }
                else {
                    var Trading = &quot;0&quot;;
                }
            }

            if (ExportType != 'Ebay') {
                var Line = $(&quot;#DrpLine option:selected&quot;).val();
                if (Line == &quot;&quot;) {
                    alert(&quot;Please Select Line !!&quot;);
                    $('.loader_main_spin').hide();
                    return false;
                }
            }
            if (ExportType == 'Services') {
                ExportType = &quot;ACES&quot;
                if (TradingPartnerwebconfig == &quot;true&quot;) {
                    var Trading = $(&quot;#drptradingpartner option:selected&quot;).val();
                }
                else {
                    var Trading = &quot;0&quot;;
                }
            }
            if (ExportType == 'Network') {
                ExportType = &quot;ACES&quot;
            }
            if (ExportType == 'Walmart') {
                ExportType = &quot;ACES&quot;
            }  

            var Sp = &quot;&quot;;
            var Competitor = &quot;0&quot;;
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(':visible')) {
                Equipment = $(&quot;#chkequ&quot;).prop('checked') ? &quot;True&quot; : &quot;False&quot;;
            }
            var CustomerId = 0;
            var counter = 0;
            var PartDescription = PartDescriptionId.replace(/(^[,\s]+)|([,\s]+$)/g, '');
            var productliness = productlines.replace(/(^[,\s]+)|([,\s]+$)/g, '');
            
            PartDescription = &quot;&quot;;
            var Brandssss = BrandIDs.replace(/(^[,\s]+)|([,\s]+$)/g, '');

            var path = window.location.href.replace(window.location.hostname + '/', '').replace(window.location.protocol + '//', '').replace(window.location.search, '').replace(':' + window.location.port, '')
            var sitename = path.substring(0, path.indexOf('/'));
            if (sitename == 'localhost') {
                sitename = &quot;&quot;;
            }
            else if (sitename == 'APAPMTTEST') {
                sitename = sitename + '/'
            }
            else if (sitename == 'Youtechpmt') {
                sitename = sitename + '/'
            }
            else {
                //sitename = sitename + '/'
                sitename = &quot;&quot;;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var AdminGroupID = '6';
            debugger
            OpenPartNoPopupExportcustom(sitename + 'Parts', 'ViewPartsExport.aspx', '' + PartDescription + '', ExportType, Ecommerece, Sp, Competitor, Line, Brandssss, productliness, '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '', '700', '550', '450', '200', Competitor, Trading, Equipment, '', '', '', '', AdminGroupID);

            return true;
        }
        function generateopticat() {
            debugger
            $('.loader_main_spin').show();
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == &quot;&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            $(&quot;#MainContent_hdlinecode&quot;).val(Line);
            if (Process == &quot;PIES&quot;) {
                var companyname = $(&quot;#CompanyNamePIES&quot;).val().trim();
                companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
                if (typeof companyname === 'undefined' || companyname === null || companyname === '') {
                    companyname = PCompany;
                }
                var Pla = $(&quot;#PLA&quot;).val().trim();
                if (typeof Pla === 'undefined' || Pla === null || Pla === '') {
                    Pla = PPLA || '';
                }
                var VendorNumber = $(&quot;#Vendor&quot;).val();
                if (typeof VendorNumber === 'undefined' || VendorNumber === null || VendorNumber === '') {
                    VendorNumber = PVendorNumber;
                }
                var ContactPies = $(&quot;#ContactName&quot;).val();
                ContactPies = ContactPies.replace(/[&lt;>]/ig, &quot;&quot;);
                if (typeof ContactPies === 'undefined' || ContactPies === null || ContactPies === '') {
                    ContactPies = PContactName;
                }
                var Email = $(&quot;#ContactEmail&quot;).val();
                if (typeof Email === 'undefined' || Email === null || Email === '') {
                    Email = PContactEmail;
                }
                var EDate = $(&quot;#PIESEffectiveDate&quot;).val();
                if (typeof EDate === 'undefined' || EDate === null || EDate === '') {
                    EDate = PBlanketEffectiveDate;
                }
                var PriceSheetNum = $(&quot;#PriceSheet&quot;).val();
                if (typeof PriceSheetNum === 'undefined' || PriceSheetNum === null || PriceSheetNum === '') {
                    PriceSheetNum = PPriceSheetNum;
                }
                $(&quot;#MainContent_hdtxtCompanyName&quot;).val(companyname);
                $(&quot;#MainContent_hdtxtParent&quot;).val(&quot;&quot;);
                $(&quot;#MainContent_hdtxtBrand&quot;).val(&quot;&quot;);
                $(&quot;#MainContent_hdtxtContactPies&quot;).val(ContactPies);
                $(&quot;#MainContent_hdtxtEmail&quot;).val(Email);
                $(&quot;#MainContent_hdtxtPla&quot;).val(Pla);
                $(&quot;#MainContent_hdtxtVendorNumber&quot;).val(VendorNumber);
                $(&quot;#MainContent_hdtxtPriceSheetNum&quot;).val(PriceSheetNum);
                $(&quot;#MainContent_hdtxtEDate&quot;).val(EDate);
                var Competitor = $(&quot;#drpinterchange1&quot;).val();
                if (Competitor == &quot;&quot; || Competitor == undefined) {
                    Competitor = &quot;0&quot;;
                }
                $(&quot;#MainContent_hddrpCustomer&quot;).val(Competitor);
                $(&quot;#MainContent_Opticatpies1&quot;).click();
            }
            else {
                var companyname = $(&quot;#CompanyName&quot;).val();
                if (typeof companyname === 'undefined' || companyname === null || companyname === '') {
                    companyname = ACompanyName;
                }
                var txtEffectiveDate1 = $(&quot;#EffectiveDate&quot;).val();
                if (typeof txtEffectiveDate1 === 'undefined' || txtEffectiveDate1 === null || txtEffectiveDate1 === '') {
                    txtEffectiveDate1 = AEffectiveDate;
                }
                var txtDocTitle = $('#DocumentTitle').val();
                if (typeof txtDocTitle === 'undefined' || txtDocTitle === null || txtDocTitle === '') {
                    txtDocTitle = Adoctitle;
                }
                var cblapprovedfor = $('#txtapprove').val();
                if (typeof cblapprovedfor === 'undefined' || cblapprovedfor === null || cblapprovedfor === '') {
                    cblapprovedfor = AApprovedfordata;
                }
                var txtSenderCompany = $('#SenderCompany').val();
                if (typeof txtSenderCompany === 'undefined' || txtSenderCompany === null || txtSenderCompany === '') {
                    txtSenderCompany = ASenderCompany;
                }
                var txtSenderPhone = $('#SenderPhone').val();
                if (typeof txtSenderPhone === 'undefined' || txtSenderPhone === null || txtSenderPhone === '') {
                    txtSenderPhone = ASenderPhone;
                }
                var txtSenderEmail = $('#SenderEmail').val();
                if (typeof txtSenderEmail === 'undefined' || txtSenderEmail === null || txtSenderEmail === '') {
                    txtSenderEmail = Asenderemail;
                }
                var txtMapperCompany = $('#MapperCompany').val();
                if (typeof txtMapperCompany === 'undefined' || txtMapperCompany === null || txtMapperCompany === '') {
                    txtMapperCompany = AMapperCompany;
                }
                var txtMapperPhone = $('#MapperPhone').val();
                if (typeof txtMapperPhone === 'undefined' || txtMapperPhone === null || txtMapperPhone === '') {
                    txtMapperPhone = AMapperPhone;
                }
                var txtMapperEmail = $('#MapperEmail').val();
                if (typeof txtMapperEmail === 'undefined' || txtMapperEmail === null || txtMapperEmail === '') {
                    txtMapperEmail = AMapperEmail;
                }
                var txtContact = $('#SenderContact').val();
                if (typeof txtContact === 'undefined' || txtContact === null || txtContact === '') {
                    txtContact = ASenderContact;
                }
                var drpSubmissionType = $(&quot;#SubmissionType option:selected&quot;).text();
                if (typeof drpSubmissionType === 'undefined' || drpSubmissionType === null || drpSubmissionType === '') {
                    drpSubmissionType = &quot;FULL&quot;;
                }
                var txtDocFormNo = $('#DocumentForm').val();
                if (typeof txtDocFormNo === 'undefined' || txtDocFormNo === null || txtDocFormNo === '') {
                    txtDocFormNo = ADocformnumber;
                }
                var txtSenderContact = $('#SenderContact').val();
                if (typeof txtSenderContact === 'undefined' || txtSenderContact === null || txtSenderContact === '') {
                    txtSenderContact = ASenderContact;
                }
                var txtSenderPhoneExt = $('#SenderPhoneExt').val();
                if (typeof txtSenderPhoneExt === 'undefined' || txtSenderPhoneExt === null || txtSenderPhoneExt === '') {
                    txtSenderPhoneExt = Asenderphoneext;
                }
                var txtMapperContact = $('#MapperContact').val();
                if (typeof txtMapperContact === 'undefined' || txtMapperContact === null || txtMapperContact === '') {
                    txtMapperContact = AMapperContact;
                }
                var txtMapperPhoneExt = $('#MapperPhoneExt').val();
                if (typeof txtMapperPhoneExt === 'undefined' || txtMapperPhoneExt === null || txtMapperPhoneExt === '') {
                    txtMapperPhoneExt = AMapperPhoneext;
                }
                if (hdbrand == &quot;false&quot;) {
                    var BrandAAIAIDHeader = &quot;&quot;;
                }
                else {
                    var BrandAAIAIDHeader = $(&quot;#txtbrandid&quot;).val();
                    if (BrandAAIAIDHeader != &quot;&quot; &amp;&amp; BrandAAIAIDHeader.length &lt; 4) {
                        alert(&quot;Brand AAIAID must have 4 characters&quot;);
                        $('.loader_main_spin').hide();
                        return false;
                    }
                    var regex = /^[a-zA-Z]+$/;
                    if (!regex.test(BrandAAIAIDHeader)) {
                        alert(&quot;Invalid BrandID&quot;);
                        $('.loader_main_spin').hide();
                        return false;
                    }
                }

                var date = txtEffectiveDate1;
                //var txtEffectiveDate = &quot;&quot;;
                //txtEffectiveDate = (date.substr(6, 4) + &quot;-&quot; + date.substr(0, 2) + &quot;-&quot; + date.substr(3, 2));
                txtEffectiveDate = txtEffectiveDate1;

                $(&quot;#MainContent_hdtxtCompany&quot;).val(companyname);
                $(&quot;#MainContent_hdtxtContact&quot;).val(txtContact);
                $(&quot;#MainContent_hdtxtEffectiveDate&quot;).val(txtEffectiveDate);
                $(&quot;#MainContent_hdtxtDocTitle&quot;).val(txtDocTitle);
                $(&quot;#MainContent_hdtxtDocFormNo&quot;).val(txtDocFormNo);
                $(&quot;#MainContent_hdtxtApprovedfor&quot;).val(cblapprovedfor);
                $(&quot;#MainContent_hdtxtSenderCompany&quot;).val(txtSenderCompany);
                $(&quot;#MainContent_hdtxtSenderContact&quot;).val(txtSenderContact);
                $(&quot;#MainContent_hdtxtSenderPhone&quot;).val(txtSenderPhone);
                $(&quot;#MainContent_hdtxtSenderEmail&quot;).val(txtSenderEmail);
                $(&quot;#MainContent_hdtxtMapperCompany&quot;).val(txtMapperCompany);
                $(&quot;#MainContent_hdtxtMapperContact&quot;).val(txtMapperContact);
                $(&quot;#MainContent_hdtxtMapperPhone&quot;).val(txtMapperPhone);
                $(&quot;#MainContent_hdtxtMapperPhoneExt&quot;).val(txtMapperPhoneExt);
                $(&quot;#MainContent_hdtxtMapperEmail&quot;).val(txtMapperEmail);
                $(&quot;#MainContent_hdtxtBrandID&quot;).val(BrandAAIAIDHeader);
                var Competitor = $(&quot;#drpinterchange1&quot;).val();
                if (Competitor == &quot;&quot; || Competitor == undefined) {
                    Competitor = &quot;0&quot;;
                }
                $(&quot;#MainContent_hddrpCustomer&quot;).val(Competitor);
                $(&quot;#MainContent_Opticataces1&quot;).click();
            }
            $('.loader_main_spin').hide();
        }
        function Generate_All_ApplicationExportBasedMfrBrandId_csv() {
            $('.loader_main_spin').show();
            var _data = {
                &quot;AdminId&quot;: AdminId,
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'SaveAcesAllApplicationExportCSVdata',
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $('.loader_main_spin').hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert('Your export is initiated. Please check the Queue Management page for more details');

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $('.loader_main_spin').hide();
                }
            })
        }
        function Generate_PiesExcelExportBasedMfrBrand() {
            $('.loader_main_spin').show();
            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: 'PIES'
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'SavePiesExcelExportdata',
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $('.loader_main_spin').hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert('Your export is initiated. Please check the Queue Management page for more details');

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $('.loader_main_spin').hide();
                }
            })
        }
        function Generate_PiesXMLExportBasedMfrBrand() {
            $('.loader_main_spin').show();
            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: 'PIES'
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'SavePiesXMLExportdata',
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $('.loader_main_spin').hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert('Your export is initiated. Please check the Queue Management page for more details');

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $('.loader_main_spin').hide();
                }
            })
        }
        function Generate_AllProdLineAcesQdbCodeXML() {
            $('.loader_main_spin').show();

            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: 'ACES with QDB Codes'
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'SaveAcesQdbCodeXMLdata',
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $('.loader_main_spin').hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert('Your export is initiated. Please check the Queue Management page for more details');

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $('.loader_main_spin').hide();
                }
            })
        }
        function Generate_AllProdLineAcesRawNotesXML() {
            $('.loader_main_spin').show();

            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: 'ACES with Raw Notes'
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + 'SaveAcesQdbCodeXMLdata',
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $('.loader_main_spin').hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert('Your export is initiated. Please check the Queue Management page for more details');

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $('.loader_main_spin').hide();
                }
            })
        }
        function GenerateEbayExcel() {
            $('.loader_main_spin').show();
            var Partdes = PartTypeIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var region = RegionIds;
            var partdescription = Partdes.split(',');
            var Name = &quot;&quot;;
            var storeid = $(&quot;#DrpEbay&quot;).val();
            if (partdescription.length > 1) {
                Name = PMTName + &quot;_&quot; + &quot;Products_&quot;;
            }
            else {
                Name = PMTName + &quot;_&quot; + partdescription;
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            if (storeid == &quot;&quot;) {
                alert(&quot;Please select storeid&quot;);
                $('.loader_main_spin').hide();
                return false;
            }
            var _data = {
                &quot;MakeId&quot;: Make,
                &quot;PartDescription&quot;: Partdes,
                &quot;VehicleType&quot;: Vehicle,
                &quot;region&quot;: region,
                &quot;Storeid&quot;: storeid,
                &quot;AdminId&quot;: AdminId
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'SaveEbayExportExcel',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {

                            alert('Your export is initiated. Please check the Queue Management page for more details');

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function (err) {
                        console.log(err);
                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })
            }
            else {
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + 'GenerateEbayExportExcel',
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $('.loader_main_spin').hide();
                        var data = JSON.parse(response);
                        var count = data.Count;
                        var result = data.Result;
                        const fullURL = `downloadebayExcel.aspx?Services= Download`;
                        if (count != &quot;0&quot;) {
                            if (result == &quot;Success&quot;) {
                                window.open(fullURL, '_blank', 'status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px');
                            }
                            else {
                                alert(&quot;Run Api mode contact administator&quot;);
                            }
                        }
                        else {
                            $('.loader_main_spin').hide();
                            alert(&quot;There is no data for this criteria&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $('.loader_main_spin').hide();
                    }
                })

            }


        }
    
    
        
            
                Export Data : Select the format you like to export
            
        
        
            
                * Excel/XML will contain information of Parts selected in the respective Parts Export Page. By default when a Part is created in PMT is selected for Export
            
        
    
    
        
            
                
                All Applications
            
            
                
                ACES with QDB Codes
            
            
                
                ACES with Raw Notes
            
            
                
                ACES Invalid
            
            
                
                ACES with Raw Notes and Attribute Invalids
            
            
                
                PIES
            
            
                
                Compatibility
            
            
                
                ACES
            
            
                
            
            
                
            
            
            
        
    
    
        
            
                Line *
                -SELECT-ALL1234 | mani testAmazonBasics |  KTM Sportmotorcycle GmbHAuto | AutomateBBBB | 3MBBHN |  KTM Sportmotorcycle GmbHBDBC |  KTM Sportmotorcycle GmbHBDFL | Air Pro/Maritta RadiatorBDGB |  AGS CompanyBDGS | AP Emissions TechnologiesBDJK | Automann USA IncBDLK | Gates CorporationBDLV | Robert Bosch LLCBDMB | Brembo SpABDMR | Buyers Products CompanyBDNL | Cambro Products IncBDPV | Charter V-BeltsBDPZ | Chicago RawhideBDRB | Cooper Tire &amp; Rubber CompanyBDRQ | CRC Industries IncBDTG | Donaldson Company IncBDVG | East Penn Manufacturing Company IncBDWL | Stryten EnergyBFCN | Grote IndustriesBFCZ |  KTM Sportmotorcycle GmbHBFFD | SAF-HOLLAND GroupBFFX | Interstate BatteriesBFHC | KD Lamp CompanyBFLP | Meritor IncBFNQ | Muncie Power ProductsBFRX | PermatexBFSB | Peterson Manufacturing CompanyBFTR | BendixBGBN | Sealco Air ControlBGDK | Standard Motor Products IncBGDS | Stemco IncBGGK | The Timken CompanyBGKG | Velvac IncBGLB | DRiV IncorporatedBGMG | Dana IncorporatedBHLZ | RatechBHWM | EBC Brakes USABKMG |  KTM Sportmotorcycle GmbHBKQD | WABCO Holdings IncBQWN | BagshawBXXS | Consolidated Metco IncCBXN | CumminsCDFX | Dexter Axle CompanyCJFL | FergusonCKTK | GSLCPCM | Marmon Holdings IncCPDN | Hutchens IndustriesCRBF | EZ Ziegler Carparts GmbH &amp; CoCRDW | HendricksonCRWK | Larson SystemsCTQN | RycoCTRD | SafewayCVKW | Thermo-KingCWFP | Horizon Brands LLCCWJD | ZF Friedrichshafen AGDMGT | TectranDMJM | Shur-Co CorporationDNVX | Illusions IncDPFJ | Milwaukee Electric Tool CorporationDTTX | NEAPCO LLCDWBR | Hoosier TankDWFB | Midwest Truck &amp; Auto Parts IncDWJB | Kinedyne LLCDXGH | Sirco IndustriesDXJK | TramecECA |  KTM Sportmotorcycle GmbHECAT | ECATFBBB |  KTM Sportmotorcycle GmbHFBHL | CTEK IncFFHT | Lippert ComponentsFJTW | Henkel CorporationFMBL | StyluzFMCT | CarParts.com IncFMGV |  KTM Sportmotorcycle GmbHFMWN | Scrubblade IncFNSL | Willpak Industries IncFSTX |  KTM Sportmotorcycle GmbHGCPV |  KTM Sportmotorcycle GmbHGFVN | Globetech ManufacturingGJFQ | Grand Rock Co IncGJKV | Car Sound Exhaust System IncGKQK | Terminal Supply CompanyGNTG | Phillips IndustriesGNXP | Ms Carita SafeTruck IncGPNH |  KTM Sportmotorcycle GmbHGTQB | KTM Sportmotorcycle GmbHHDA6 |  KTM Sportmotorcycle GmbHHGFJ | Myers Engineering IncHGYW | Dailey EngineeringHHDL | The Miner CorporationHHGG |  KTM Sportmotorcycle GmbHHHRS | Bezares SAHJMF | BettsHDHLBS |  KTM Sportmotorcycle GmbHHLNC |  KTM Sportmotorcycle GmbHHLYF | Sensata TechnologiesHNDT | Tramec Sloan LLCHQBF | Eiko North AmericaHSYH |  KTM Sportmotorcycle GmbHHTHF |  KTM Sportmotorcycle GmbHHVZQ |  KTM Sportmotorcycle GmbHHWGV |  KTM Sportmotorcycle GmbHHWGW | First Brands GroupHWHT |  KTM Sportmotorcycle GmbHHWJL |  KTM Sportmotorcycle GmbHHWKC | BorgWarner IncHWSL |  KTM Sportmotorcycle GmbHHWTQ |  KTM Sportmotorcycle GmbHHWWX | REV Group IncHYYW | Archived BrandsHZRJ | Webb Wheel Products IncHZSM |  KTM Sportmotorcycle GmbHJBRH |  KTM Sportmotorcycle GmbHJBXC | Weitron IncJBZM |  KTM Sportmotorcycle GmbHJDSR |  KTM Sportmotorcycle GmbHJFVK |  KTM Sportmotorcycle GmbHJGWM |  KTM Sportmotorcycle GmbHJHTD |  KTM Sportmotorcycle GmbHJHWD |  KTM Sportmotorcycle GmbHJJBY | JOST InternationalJJLJ |  KTM Sportmotorcycle GmbHJJQM |  KTM Sportmotorcycle GmbHJJVN |  KTM Sportmotorcycle GmbHJJWG |  KTM Sportmotorcycle GmbHJJXP |  KTM Sportmotorcycle GmbHJKJT |  KTM Sportmotorcycle GmbHJKLP |  KTM Sportmotorcycle GmbHJKSH | ATRO Engineered Systems IncJLNV |  KTM Sportmotorcycle GmbHJLRV |  KTM Sportmotorcycle GmbHJNE | JNEJNFJ |  KTM Sportmotorcycle GmbHJNGN |  KTM Sportmotorcycle GmbHJNTR |  KTM Sportmotorcycle GmbHJNVY |  KTM Sportmotorcycle GmbHJPCZ |  KTM Sportmotorcycle GmbHJPDC |  KTM Sportmotorcycle GmbHJPHL |  KTM Sportmotorcycle GmbHJPJZ | Maxiforce IncJPMK |  KTM Sportmotorcycle GmbHJRTR |  KTM Sportmotorcycle GmbHJRYR |  KTM Sportmotorcycle GmbHJSXZ |  KTM Sportmotorcycle GmbHJTBH |  KTM Sportmotorcycle GmbHJTFR |  KTM Sportmotorcycle GmbHJTVF |  KTM Sportmotorcycle GmbHJTZF |  KTM Sportmotorcycle GmbHJUNDA |  KTM Sportmotorcycle GmbHJVBL |  KTM Sportmotorcycle GmbHJVHV |  KTM Sportmotorcycle GmbHJVLY |  KTM Sportmotorcycle GmbHJVMB |  KTM Sportmotorcycle GmbHJVTB |  KTM Sportmotorcycle GmbHJWGV |  KTM Sportmotorcycle GmbHJWXJ |  KTM Sportmotorcycle GmbHJXRW | stymartJXYR |  KTM Sportmotorcycle GmbHJYBK | RR USA IncJYPP |  KTM Sportmotorcycle GmbHJZRD | Norcalway LLCJZRY |  KTM Sportmotorcycle GmbHKBVS |  KTM Sportmotorcycle GmbHKBWY | Trux AccessoriesKFHH | Intellitec Products LLCKRCQ | vmDSTechLCZM | TNAIYHSKP |  KTM Sportmotorcycle GmbHTEA | TealpartsTES | TESTEST | TESTTOW |  KTM Sportmotorcycle GmbHZAER |  KTM Sportmotorcycle GmbHZAPG |  KTM Sportmotorcycle GmbHZASE |  KTM Sportmotorcycle GmbHZAUT |  KTM Sportmotorcycle GmbHZCMS |  KTM Sportmotorcycle GmbHZCVL |  KTM Sportmotorcycle GmbHZETT |  KTM Sportmotorcycle GmbHZFRY |  KTM Sportmotorcycle GmbHZKAT |  KTM Sportmotorcycle GmbHZKEL |  KTM Sportmotorcycle GmbHZLKI |  KTM Sportmotorcycle GmbHZLUB |  KTM Sportmotorcycle GmbHZMAT |  KTM Sportmotorcycle GmbHZMEP |  KTM Sportmotorcycle GmbHZMIV |  KTM Sportmotorcycle GmbHZMOW |  KTM Sportmotorcycle GmbHZNOR |  KTM Sportmotorcycle GmbHZPRO |  KTM Sportmotorcycle GmbHZRIH |  KTM Sportmotorcycle GmbHZSKI |  KTM Sportmotorcycle GmbHZSTA |  KTM Sportmotorcycle GmbHZTLT |  KTM Sportmotorcycle GmbHZTOD |  KTM Sportmotorcycle GmbHZTOM |  KTM Sportmotorcycle GmbHZTRA |  KTM Sportmotorcycle GmbHZVAN |  KTM Sportmotorcycle GmbHZVEE |  KTM Sportmotorcycle GmbHZVUL |  KTM Sportmotorcycle GmbHZWTC |  KTM Sportmotorcycle GmbH
            
            
                Ebay :
                
            
            
                Interchange :
                AAATest Rite InternationalSelect multiple items
                
            
            
                Unit/Comp :
                
                    Unit
                    Comp
                
            
            
                Trading Partner :
                
                    
                        Trading Partner
                        The changes to the parts export settings for the Trading Partner can be done through the Trading Partner Master
                
                -SELECT-
            
             
                 
                  Include Equipment
            
        
    
    
        
            Brand*
            
                
                    
                    Select All
                    The Brand filter will be disabled when All lines are selected. The exported file will list all the Brands available in the PMT
                
                
                
            
            Sub Brand
            
                
                    
                    Select All
                    If there are no sub-brand(s) associated with the selected brand(s), only the brand information will be displayed here.
                
                
                
            
            Sub Product line*
            
                
                    
                    Select All
                
                Base#skp
            
            Part Description* 
            
                
                    
                        
                        Select All
                        
                            PARTS EXPORT SETTINGS
                            
                            Select All. Overwrite Export settings
                        
                        You can select only one Part Description when All Lines are selected
                    
                    
                        
                        
                        
                    
                
                
                
            
            VehicleType
            
                
                    
                    Select All
                    
                
                
                
            
            Make
            
                
                    
                    Select All
                    
                        
                        
                        
                    
                
                
                
            
            Region
            
                
                    
                    Select All
                
                
                
            
            ACES Header Info
            
                
                    
                        Export in ACES Version:
                        
                            
                            3.2

                            
                            4.0

                            
                            4.2
                        
                        
                            Overpopulate :
                            
                                
                                Both
                                
                                Submodel
                                
                                EngineBase
                            
                        
                    
                    
                        
                            Company Name*
                            
                        
                        
                            Company Contact*
                            
                        
                        
                            Effective Date*
                            
                        
                        
                            Submission Type*
                            -SELECT-FullUpdate
                        
                        
                            Document Title*
                            
                        
                        
                            Document Form #
                            
                        
                        
                            Approved for  
                            
                                
                                 CN 
                                
                                 MX 
                                
                                 US 
                            
                            ( CA-Canada , MX-Mexico , US-United States )
                            
                        
                    
                    
                        
                            Sender Company*
                            
                        
                        
                            Sender Contact*
                            
                        
                        
                            Sender Phone*
                            
                        
                        
                            Sender Phone Ext
                            
                        
                        
                            Sender Email
                            
                        
                        
                            Mapper Company
                            
                        
                        
                            Mapper Contact
                            
                        
                        
                            Mapper Phone
                            
                        
                        
                            Mapper Phone Ext
                            
                        
                        
                            Mapper Email
                            
                        
                        
                            Brand AAIAID
                            
                            Please provide the Brand AAIAID with 4 characters.
                            
                        
                    
                
            
            PIES Header Info
            
                
                    
                        
                            Company Name*
                            
                        
                        
                            PLA
                            
                        
                        
                            Vendor #
                            
                        
                        
                            Submission Type*
                            -SELECT-FullUpdate
                        
                        
                            Contact Name*
                            
                        
                        
                            Contact Email*
                            
                        
                        
                            Effective Date*
                            
                        
                        
                            Price Sheet #*
                            
                        
                    
                
            
        
       
    
        
        
            
            Enable this field to exclude the overlapping records in the export you want to generate
        
        
            If you have more than 1,048,576 rows, use CSV to export.
        
        
            Generate Excel
            Generate CSV
            Generate CSV Files
            Generate PIES Excel Files
            Generate PIES XML Files
            Generate QDB XML Files
            Generate Raw Notes XML Files
            Generate XML
            Import to Opticat
            Generate Customized Xml
            Generate XML to FTP
        
    
    
        
            
                Would you like to save the settings selected for this export for future use?
                If Yes, please click the 'Yes' button. If not, click the 'No' button.
                If 'Yes' is clicked, you will be redirected to another pop-up where you can specify a name for this export and upload an associated icon. Upon saving, this will be added to the Export Data page of the PMT.
                (You can download the records with overlaps from the Downloads page.)
            
        
    
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    

                           
                            </value>
      <webElementGuid>9fb10a66-f383-4423-8ca3-47fcc456515d</webElementGuid>
   </webElementProperties>
   <webElementProperties>
      <isSelected>false</isSelected>
      <matchCondition>equals</matchCondition>
      <name>xpath</name>
      <type>Main</type>
      <value>id(&quot;Form1&quot;)/div[@class=&quot;content_2&quot;]/div[@class=&quot;content_container&quot;]/div[@class=&quot;content_border&quot;]/div[@class=&quot;wrapper&quot;]</value>
      <webElementGuid>49346ee8-2afa-480f-8131-1684a0271569</webElementGuid>
   </webElementProperties>
   <webElementXpaths>
      <isSelected>true</isSelected>
      <matchCondition>equals</matchCondition>
      <name>xpath:idRelative</name>
      <type>Main</type>
      <value>//form[@id='Form1']/div[6]/div/div/div</value>
      <webElementGuid>e8bfb5d2-182f-4e58-b449-7b67361c4f34</webElementGuid>
   </webElementXpaths>
   <webElementXpaths>
      <isSelected>false</isSelected>
      <matchCondition>equals</matchCondition>
      <name>xpath:neighbor</name>
      <type>Main</type>
      <value>(.//*[normalize-space(text()) and normalize-space(.)='Feedback'])[2]/following::div[10]</value>
      <webElementGuid>5f10b1c3-0fc5-4353-84e9-bbfd49eff6e2</webElementGuid>
   </webElementXpaths>
   <webElementXpaths>
      <isSelected>false</isSelected>
      <matchCondition>equals</matchCondition>
      <name>xpath:position</name>
      <type>Main</type>
      <value>//div[6]/div/div/div</value>
      <webElementGuid>31f01369-5f17-4799-8250-19ad54d15e5a</webElementGuid>
   </webElementXpaths>
   <webElementXpaths>
      <isSelected>false</isSelected>
      <matchCondition>equals</matchCondition>
      <name>xpath:customAttributes</name>
      <type>Main</type>
      <value>//div[(text() = concat(&quot;
                      
                   
                        
    
    
    
        .select2-container {
            width: 250px !important;
        }

        .ui-accordion .ui-accordion-header {
            background: #d3d3d3 !important;
            border-radius: 3px;
        }

        .ui-icon-triangle-1-e {
            background-position: -32px -16px !important;
        }

        .ui-accordion .ui-accordion-header {
            color: #004a86 !important;
            font-weight: 600 !important;
            font-size: 15px !important;
        }

        .filterlbl {
            font-size: 13px !important;
            padding-left: 5px;
        }

        .background_lte label {
            font-size: 15px;
        }

        #divExportFormat {
            padding: 15px;
        }

        .span_head_bold {
            margin: 0px !important;
            color: #004a9af7;
        }

        .status-text.overlap #overlapchk {
            margin: 0px;
            width: 26px;
            height: 15px;
        }

        #Acesversion {
            padding-left: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #004a86;
        }

        .field_20 {
            margin-top: 10px !important;
        }

        #Acesversion span {
            font-weight: 600;
            font-size: 14px;
        }

        #overpopulate {
            padding-left: 10px;
        }

            #overpopulate span {
                font-size: 14px;
                font-weight: 600;
            }

        .field_label {
            font-weight: 600;
        }

        .tab button {
            color: #004a86 !important;
            font-weight: 700 !important;
        }

            

        #loaddatabox {
            padding-top: 15px;
        }

        .dropdown-container {
            padding-left: 8px;
        }

        .ui-state-active .ui-icon, .ui-button:active .ui-icon {
            filter: invert(1);
        }

        #divExportFormat label {
            font-weight: 500 !important;
        }

        .p_lr_5 {
            padding-left: 20px !important;
        }

        .Fmpexportbutton {
            background: #d11920;
            color: #fff;
            font-size: 12px;
            padding: 0px 10px 0px;
            border-radius: 5px;
        }

        .exportbottom {
            padding-bottom: 50px;
        }

        .Exportbutton {
            cursor: pointer;
            background: #058c40;
            color: #fff;
            margin: 0 0 0 10px;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
        }

        .status-text {
            font-family: Arial, sans-serif;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .red-text {
            color: red;
            font-weight: bold;
        }

        .underline-link {
            color: red;
            text-decoration: underline;
            cursor: pointer;
        }

        .tab {
            overflow: hidden;
            border-bottom: 1px solid #ccc;
        }

            .tab button {
                background-color: #f1f1f1;
                float: left;
                border: none;
                outline: none;
                cursor: pointer;
                padding: 10px 16px;
                transition: 0.3s;
                align-items: center;
            }

                .tab button:hover {
                    background-color: #ddd;
                }

                .tab button.active {
                    background-color: #ccc;
                }

        .tab-icon {
            width: 24px;
            height: 24px;
            margin-right: 8px;
        }

        .tab-icon1 {
            width: auto;
            height: 30px;
            margin-right: 8px;
        }

        .tabcontent {
            display: none;
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-top: none;
            margin-top: 20px;
        }

        .content {
            margin-top: 20px;
        }

        .select2-results__option .wrap:before {
            font-family: fontAwesome;
            color: #004a86;
            content: &quot;\f096&quot;;
            width: 25px;
            height: 25px;
            padding-right: 10px;
        }

        .select2-results__option[aria-selected=true] .wrap:before {
            content: &quot;\f14a&quot;;
        }

        /* not required css */

        .select2-multiple, .select2-multiple2 {
            width: 50%
        }

        .ui-accordion .ui-accordion-header {
            color: #2b43c3;
            border: 1px solid #ffffff;
            background: #ddd;
            padding: 20px; /* Adjust this as needed */
            height: 50px; /* Set a fixed height */
            display: flex; /* Use Flexbox to center content */
            align-items: center; /* Vertically center content */
            text-align: center; /* Ensure text is centered if it&quot; , &quot;'&quot; , &quot;s multiline */
        }

        #accordion {
            margin: 5px 0;
        }

        .filterclass {
            display: inline-block;
            vertical-align: top;
            width: 24%;
            padding: 3px 5px;
            margin: 3px;
        }

        .filterlbl {
            width: 85%;
            float: left;
        }

        .filterinp {
            float: left;
        }

        .panel_box {
            width: 100%;
            overflow-y: auto;
            max-height: 300px;
            border: 1px solid #ccc;
            padding: 10px;
            box-shadow: 0 0 5px rgba(0, 0, 0, .28);
        }
    
    
        var AdminId = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var AdminGroupID = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var WebAPIURL = &quot; , &quot;'&quot; , &quot;https://ecat.apapmt.com:8186/ecat/pmtapi/&quot; , &quot;'&quot; , &quot;;
        var ReadOnlyDB = &quot; , &quot;'&quot; , &quot;false&quot; , &quot;'&quot; , &quot;;
        var ACESPIESQueue = &quot; , &quot;'&quot; , &quot;true&quot; , &quot;'&quot; , &quot;;
        var ChkSubProdLineAlert = &quot; , &quot;'&quot; , &quot;false&quot; , &quot;'&quot; , &quot;;
        var TradingPartnerwebconfig = &quot; , &quot;'&quot; , &quot;true&quot; , &quot;'&quot; , &quot;;
        var Export_Overpopulate = &quot; , &quot;'&quot; , &quot;true&quot; , &quot;'&quot; , &quot;;
        var FMP = &quot; , &quot;'&quot; , &quot;true&quot; , &quot;'&quot; , &quot;;
        var AllExcelExportOption = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var Submissiontype = &quot; , &quot;'&quot; , &quot;true&quot; , &quot;'&quot; , &quot;;
        var CustomizedXmlExp = &quot; , &quot;'&quot; , &quot;1&quot; , &quot;'&quot; , &quot;;
        var syncwithopticat = &quot; , &quot;'&quot; , &quot;false&quot; , &quot;'&quot; , &quot;;
        var CustomAllApplication = &quot; , &quot;'&quot; , &quot;Yes&quot; , &quot;'&quot; , &quot;;
        var AllApplicationTitle = &quot; , &quot;'&quot; , &quot;Yes&quot; , &quot;'&quot; , &quot;;
        var IncludeCustomValue = &quot; , &quot;'&quot; , &quot;NO&quot; , &quot;'&quot; , &quot;;
        var PMTName = &quot; , &quot;'&quot; , &quot;EcatPMT&quot; , &quot;'&quot; , &quot;;
        AdminId = &quot; , &quot;'&quot; , &quot;3127&quot; , &quot;'&quot; , &quot;;
        AdminGroupID = &quot; , &quot;'&quot; , &quot;6&quot; , &quot;'&quot; , &quot;;
        var BrandIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var SubBrandIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var SubPLine = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var PartTypeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var VehicleTypeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var MakeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var RegionIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var Equipment = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var searchdata = &quot;&quot;;
        var searchMdata = &quot;&quot;;
        var Process = &quot;&quot;;
        var hdUnitComp = &quot;&quot;;
        var hdCapital = &quot;&quot;;
        var hdIncludeCustomValue = &quot;&quot;;
        var P2P = &quot;&quot;;
        var XMLTOFTP = &quot;&quot;;
        var hdExportType = &quot;&quot;;
        var LineTPwise = &quot;&quot;;
        var hdAmazon = &quot;&quot;;
        var Services = &quot;&quot;;
        var hdbrand = &quot;false&quot;;
        var PCompany = &quot;&quot;;
        var PContactName = &quot;&quot;;
        var PContactEmail = &quot;&quot;;
        var PPLA = &quot;&quot;;
        var PVendorNumber = &quot;&quot;;
        var PPIESSubmissionType = &quot;&quot;;
        var PPriceSheetNum = &quot;&quot;;
        var PBlanketEffectiveDate = &quot;&quot;;
        var ACompanyName = &quot;&quot;;
        var ACompanyContact = &quot;&quot;;
        var AEffectiveDate = &quot;&quot;;
        var Adoctitle = &quot;&quot;;
        var ADocformnumber = &quot;&quot;;
        var ASenderCompany = &quot;&quot;;
        var ASenderContact = &quot;&quot;;
        var ASenderPhone = &quot;&quot;;
        var Asenderphoneext = &quot;&quot;;
        var Asenderemail = &quot;&quot;;
        var AMapperCompany = &quot;&quot;;
        var AMapperContact = &quot;&quot;;
        var AMapperPhone = &quot;&quot;;
        var AMapperPhoneext = &quot;&quot;;
        var AMapperEmail = &quot;&quot;;
        var AApprovedfordata = &quot;&quot;;
        var ExportFTP = &quot;&quot;;
        var customizedflag = &quot;0&quot;;
        $(document).ready(function () {
            GetexportMenu();
            GetCustomExportImage();
            loadhdvalues();
            BrandIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            SubBrandIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            SubPLine = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            PartTypeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            VehicleTypeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            MakeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            Equipment = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            RegionIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            $(&quot;#loaddatabox&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;.tablinks&quot;).click(function () {
                event.preventDefault();
                $(&quot;.tablinks&quot;).css(&quot;background-color&quot;, &quot;&quot;);
                $(this).css(&quot;background-color&quot;, &quot;#ddd&quot;);
            });
            $(&quot;.Cusimgexport&quot;).click(function () {
                event.preventDefault();
                let imgSrc = $(this).find(&quot; , &quot;'&quot; , &quot;img&quot; , &quot;'&quot; , &quot;).attr(&quot; , &quot;'&quot; , &quot;src&quot; , &quot;'&quot; , &quot;);
                let fileName = imgSrc.split(&quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;).pop();
                //console.log(fileName);
                 var data = {
                   &quot;adminid&quot;: AdminId,
                   &quot;FileName&quot;: fileName
                            }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetCustomExportid&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(data),
                    //async: false,
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    timeout: 120000,
                    success: function (result) {
                        debugger
                        var Exportid = &quot;&quot;;
                        var ExportType = &quot;&quot;;
                        var CompanyName = &quot;&quot;;
                        var companycontact = &quot;&quot;;
                        var effectivedate = &quot;&quot;;
                        var submissiontype = &quot;&quot;;
                        var doctitle = &quot;&quot;;
                        var docformnumber = &quot;&quot;;
                        var approvedfor = &quot;&quot;;
                        var sendercompany = &quot;&quot;;
                        var sendercontact = &quot;&quot;;
                        var senderphone = &quot;&quot;;
                        var senderphoneext = &quot;&quot;;
                        var senderemail = &quot;&quot;;
                        var mappercompany = &quot;&quot;;
                        var mappercontact = &quot;&quot;;
                        var mapperphone = &quot;&quot;;
                        var mapperphoneext = &quot;&quot;;
                        var mapperemail = &quot;&quot;;
                        var BrandID = &quot;&quot;;
                        var Acesname = &quot;&quot;;
                        var Line = &quot;&quot;;
                        var AdminID = AdminId;
                        if (result.length > 0) {
                            var data = JSON.parse(result);
                            $.each(data, function () {
                                Exportid = this[&quot; , &quot;'&quot; , &quot;Exportid&quot; , &quot;'&quot; , &quot;];
                                ExportType = this[&quot; , &quot;'&quot; , &quot;ExportType&quot; , &quot;'&quot; , &quot;];
                                CompanyName = this[&quot; , &quot;'&quot; , &quot;CompanyName&quot; , &quot;'&quot; , &quot;];
                                companycontact = this[&quot; , &quot;'&quot; , &quot;companycontact&quot; , &quot;'&quot; , &quot;];
                                effectivedate = this[&quot; , &quot;'&quot; , &quot;effectivedate&quot; , &quot;'&quot; , &quot;];
                                submissiontype = this[&quot; , &quot;'&quot; , &quot;submissiontype&quot; , &quot;'&quot; , &quot;];
                                doctitle = this[&quot; , &quot;'&quot; , &quot;doctitle&quot; , &quot;'&quot; , &quot;];
                                docformnumber = this[&quot; , &quot;'&quot; , &quot;docformnumber&quot; , &quot;'&quot; , &quot;];
                                approvedfor = this[&quot; , &quot;'&quot; , &quot;approvedfor&quot; , &quot;'&quot; , &quot;];
                                sendercompany = this[&quot; , &quot;'&quot; , &quot;sendercompany&quot; , &quot;'&quot; , &quot;];
                                sendercontact = this[&quot; , &quot;'&quot; , &quot;sendercontact&quot; , &quot;'&quot; , &quot;];
                                senderphone = this[&quot; , &quot;'&quot; , &quot;senderphone&quot; , &quot;'&quot; , &quot;];
                                senderphoneext = this[&quot; , &quot;'&quot; , &quot;senderphoneext&quot; , &quot;'&quot; , &quot;];
                                senderemail = this[&quot; , &quot;'&quot; , &quot;senderemail&quot; , &quot;'&quot; , &quot;];
                                mappercompany = this[&quot; , &quot;'&quot; , &quot;mappercompany&quot; , &quot;'&quot; , &quot;];
                                mappercontact = this[&quot; , &quot;'&quot; , &quot;mappercontact&quot; , &quot;'&quot; , &quot;];
                                mapperphone = this[&quot; , &quot;'&quot; , &quot;mapperphone&quot; , &quot;'&quot; , &quot;];
                                mapperphoneext = this[&quot; , &quot;'&quot; , &quot;mapperphoneext&quot; , &quot;'&quot; , &quot;];
                                mapperemail = this[&quot; , &quot;'&quot; , &quot;mapperemail&quot; , &quot;'&quot; , &quot;];
                                BrandID = this[&quot; , &quot;'&quot; , &quot;BrandID&quot; , &quot;'&quot; , &quot;];
                                Acesname = this[&quot; , &quot;'&quot; , &quot;PIES&quot; , &quot;'&quot; , &quot;];
                                Equipment = this[&quot; , &quot;'&quot; , &quot;Equipment&quot; , &quot;'&quot; , &quot;];
                                Line = this[&quot; , &quot;'&quot; , &quot;Line&quot; , &quot;'&quot; , &quot;];

                                if (Acesname == &quot;ACES with QDB Codes&quot;) {
                                    Qualifier = true;
                                }
                                else {
                                    Qualifier = false;
                                }
                            })
                            var _data = {
                                &quot;CompanyName&quot;: CompanyName,
                                &quot;Acesname&quot;: Acesname,
                                &quot;drpSubmissionType&quot;: submissiontype,
                                &quot;Contact&quot;: companycontact,
                                &quot;EffectiveDate&quot;: effectivedate,
                                &quot;DocTitle&quot;: doctitle,
                                &quot;DocFormNo&quot;: docformnumber,
                                &quot;Approvedfor&quot;: approvedfor,
                                &quot;SenderCompany&quot;: sendercompany,
                                &quot;SenderContact&quot;: sendercontact,
                                &quot;SenderPhone&quot;: senderphone,
                                &quot;SenderPhoneExt&quot;: senderphoneext,
                                &quot;SenderEmail&quot;: senderemail,
                                &quot;MapperCompany&quot;: mappercompany,
                                &quot;MapperContact&quot;: mappercontact,
                                &quot;MapperPhone&quot;: mapperphone,
                                &quot;MapperPhoneExt&quot;: mapperphoneext,
                                &quot;MapperEmail&quot;: mapperemail,
                                &quot;BrandID&quot;: BrandID,
                                &quot;ExportType&quot;: ExportType,
                                &quot;Exportid&quot;: Exportid,
                                &quot;Line&quot;: Line,
                                &quot;AdminId&quot;: AdminId
                            }
                            if (ACESPIESQueue == &quot;false&quot;) {
                                $.ajax({
                                    type: &quot;POST&quot;,
                                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetAcesCustomimgExportxmldataNew&quot; , &quot;'&quot; , &quot;,
                                    data: JSON.stringify(_data),
                                    contentType: &quot;application/json; charset=utf-8&quot;,
                                    success: function (response) {
                                        debugger
                                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                        var data = JSON.parse(response);
                                        var count = data.Count;
                                        var name = data.Name;
                                        var result = data.Result;
                                        var services = Acesname;
                                        var rbb = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;exportFormat&quot;]:checked&quot; , &quot;'&quot; , &quot;).val();
                                        if (rbb != &quot;&quot; &amp;&amp; rbb != undefined) {
                                            rbb = &quot;4.2&quot;;
                                        }
                                        const sanitizedName = name.replace(/[^a-zA-Z0-9-_ ]+/g, &quot;&quot;);
                                        const fullURL = `downloadAcesXml.aspx?Aces=${services}&amp;company=${sanitizedName}&amp;Qualifier=${Qualifier}&amp;Equipment=${Equipment}&amp;ExportFormat=${rbb}`;
                                        if (count != &quot;0&quot;) {
                                            if (result == &quot;Success&quot;) {
                                                window.open(fullURL, &quot; , &quot;'&quot; , &quot;_blank&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px&quot; , &quot;'&quot; , &quot;);
                                            }
                                            else {
                                                alert(&quot;Run Api mode contact administator&quot;);
                                            }
                                        }
                                        else {
                                            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                            alert(&quot;There is no data for this criteria&quot;);
                                        }

                                    },
                                    error: function () {

                                        alert(&quot;Failed!&quot;)
                                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                    }
                                })
                            }
                            else {
                                $.ajax({
                                    type: &quot;POST&quot;,
                                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveAcesCustomimgExportxmldataNew&quot; , &quot;'&quot; , &quot;,
                                    data: JSON.stringify(_data),
                                    contentType: &quot;application/json; charset=utf-8&quot;,
                                    success: function (response) {
                                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                        var msg = JSON.parse(response);
                                        //if (response > 0)
                                        if (msg == &quot;Success&quot;) {

                                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                                        }
                                        else {
                                            alert(&quot;Run Api mode contact administator&quot;);
                                        }

                                    },
                                    error: function (err) {
                                        console.log(err);
                                        alert(&quot;Failed!&quot;)
                                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                    }
                                })
                            }
                        }
                    }, error: function (x, t, m) {
                            if (t === &quot;timeout&quot;) {
                                Swal.fire({
                                    icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                                    //title: &quot; , &quot;'&quot; , &quot;Cancelled&quot; , &quot;'&quot; , &quot;,
                                    title: &quot;Request timed out. Please contact system administrator&quot;,
                                    allowOutsideClick: false,
                                    allowEscapeKey: false,
                                })
                                //alert(&quot;Request timed out. Please contact system administrator&quot;);
                            } else {
                                Swal.fire({
                                    icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                                    //title: &quot; , &quot;'&quot; , &quot;Cancelled&quot; , &quot;'&quot; , &quot;,
                                    title: &quot;Already Exists&quot;,
                                    allowOutsideClick: false,
                                    allowEscapeKey: false,
                                })
                                //alert(&quot;Error Occured. Please contact system adminstrator&quot;);
                            }
                            $(&quot;.loader_main_spin&quot;).hide();
                        }

                    
                });

            });
            $(&quot;#DrpLine&quot;).change(function () {
                CloseTab();
                $(&quot;#overpopulate&quot;).hide();
                if ($(&quot;#DrpLine&quot;).val() != &quot;-SELECT-&quot;) {
                    Loadinterchange();
                    $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
                    $(&quot;#accordion&quot;).show();
                    $(&quot;#Bottomdata&quot;).show();
                    if (LineTPwise != &quot;TP&quot;) {
                        LineTPwise = &quot;Line&quot;;
                    }
                }
                else {
                    $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
                    $(&quot;#drpinterchange&quot;).empty();
                    $(&quot;#accordion&quot;).hide();
                    $(&quot;#Bottomdata&quot;).hide();
                    if (LineTPwise != &quot;TP&quot;) {
                        LineTPwise = &quot;&quot;;
                        LoadTradingPartner();
                    }

                }
                if (LineTPwise == &quot;Line&quot;) {
                    if (($(&quot;#drptradingpartner&quot;).val()) == &quot;0&quot;) {
                        LoadTradingPartner();
                    }
                }
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    $(&quot;#alllinebrandnote&quot;).show();
                    if (LineTPwise != &quot;TP&quot;) {
                        $(&quot;#alllineptnote&quot;).show();
                    }
                    else {
                        $(&quot;#alllineptnote&quot;).hide();
                    }
                }
                else {
                    $(&quot;#alllinebrandnote&quot;).hide();
                    $(&quot;#alllineptnote&quot;).hide();
                }
                EnptyChkboxs();
                CheckSubPline();
                if (LineTPwise != &quot;TP&quot;) {
                    $(&quot;#drptradingpartner&quot;).val(&quot;0&quot;);
                }
                
                if (Process == &quot;PIES&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;.overlap&quot;).hide();
                    $(&quot;#overpopulate&quot;).hide();
                    $(&quot;#PIESHeader3&quot;).show();
                    $(&quot;#Header3&quot;).hide();
                    $(&quot;#Acesversion&quot;).hide();
                    if (syncwithopticat == &quot;true&quot;) {
                        if (FMP == &quot;true&quot;) {
                            $(&quot;#ImportOpticat&quot;).hide();
                        } else {
                            $(&quot;#ImportOpticat&quot;).show();
                        }
                        
                    }
                    else {
                        $(&quot;#ImportOpticat&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    $(&quot;#XMLExport&quot;).show();
                    $(&quot;#CSVExport&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#ExcelExport&quot;).show();
                    $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllSubPline&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;#checkAllSubPline&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        }
                        else {
                            $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                        $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                    }
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).show();
                            $(&quot;#PIESXMLExport&quot;).show();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#Interchangelbldep&quot;).hide();
                            $(&quot;#trading&quot;).hide();
                            $(&quot;#CSVExport&quot;).hide();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#XMLExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();
                            $(&quot;#FMPPIESXML&quot;).show();
                            $(&quot;#FMPPIESEXCEL&quot;).show();

                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;#PIESHeader3&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;#Interchangelbldep&quot;).show();
                            $(&quot;#trading&quot;).show();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#FMPPIESXML&quot;).hide();
                            $(&quot;#FMPPIESEXCEL&quot;).hide();
                            $(&quot;#CSVExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#XMLExport&quot;).show();
                        }
                    }
                    loadPIESHeaderdetails();
                }
                else if (Process == &quot;AllApplication&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllSubPline&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;#checkAllSubPline&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        }
                        else {
                            $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                        $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                    }
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#CSVExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();
                            $(&quot;#FMPCSVExport&quot;).show();

                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPCSVExport&quot;).hide();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#CSVExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).show();
                            $(&quot;#Makeh3&quot;).show();
                        }
                    }
                    //$(&quot;#Overlapdata&quot;).show();
                    $(&quot;.overlap&quot;).show();
                }
                else if (Process == &quot; , &quot;'&quot; , &quot;ACESwithQDB&quot; , &quot;'&quot; , &quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#Approvedfor&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (CustomizedXmlExp == &quot;1&quot;) {
                        $(&quot;#CustomXML&quot;).show();
                    }
                    if (Export_Overpopulate == &quot;true&quot;) {
                        $(&quot;#overpopulate&quot;).show();
                    }
                    else {
                        $(&quot;#overpopulate&quot;).hide();
                    }
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    $(&quot;#Approvedfor&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();
                            $(&quot;#QDBXMLExport&quot;).show();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPQDBXML&quot;).show();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#XMLExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();
                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).show();
                            $(&quot;#Makeh3&quot;).show();
                            $(&quot;#Regionh3&quot;).show();
                            $(&quot;#Header3&quot;).show();
                            //$(&quot;#Overlapdata&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;.overlap&quot;).show();
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPQDBXML&quot;).hide();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#XMLExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                        }
                    }
                    loadHeaderdetails();
                    if (XMLTOFTP == &quot;1&quot;) {
                        $(&quot;#xmltoftp&quot;).show();
                    }
                }
                else if (Process == &quot; , &quot;'&quot; , &quot;ACESwithRawNote&quot; , &quot;'&quot; , &quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (CustomizedXmlExp == &quot;1&quot;) {
                        $(&quot;#CustomXML&quot;).show();
                    }
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    if (Export_Overpopulate == &quot;true&quot;) {
                        $(&quot;#overpopulate&quot;).show();
                    }
                    else {
                        $(&quot;#overpopulate&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).show();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPRAWNotesXML&quot;).show();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#XMLExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();

                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).show();
                            $(&quot;#Makeh3&quot;).show();
                            $(&quot;#Regionh3&quot;).show();
                            $(&quot;#Header3&quot;).show();
                            //$(&quot;#Overlapdata&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;.overlap&quot;).show();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPRAWNotesXML&quot;).hide();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#XMLExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                        }
                    }
                    loadHeaderdetails();
                    if (XMLTOFTP == &quot;1&quot;) {
                        $(&quot;#xmltoftp&quot;).show();
                    }
                }
                else if (Process == &quot;ACESwithRawNoteandInvalid&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;.overlap&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();

                        }
                    }
                }
                else if (Process == &quot;AcesInvalid&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();

                        }
                    }
                }
                else if (Process == &quot;Amazon&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#XMLExport&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    $(&quot;#trading&quot;).hide();
                }
                else if (Process == &quot;WalmartPIES&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#ImportOpticat&quot;).hide();
                    $(&quot;.overlap&quot;).hide();
                    $(&quot;#PIESHeader3&quot;).show();
                    $(&quot;#Header3&quot;).hide();
                }
                else if (Process == &quot;Walmart&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                }
                else {
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).hide();
                    $(&quot;#PIESHeader3&quot;).hide();
                    $(&quot;#Header3&quot;).hide();
                    $(&quot;#Acesversion&quot;).hide();
                }
                //if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                //    $(&quot;#incequipment&quot;).hide();
                //    $(&quot;#trading&quot;).hide();
                //    $(&quot;#PTalllist&quot;).hide();
                //    $(&quot;#Acesversion&quot;).hide();
                //    $(&quot;#Ebaylbldrp&quot;).hide();
                //}
                $(&quot;.Exportdate&quot;).show();
                if (FMP == &quot;true&quot;) {
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        $(&quot;#csvinfo&quot;).hide();
                    } else {
                        $(&quot;#csvinfo&quot;).show();
                    }
                    
                } else {
                    $(&quot;#csvinfo&quot;).show();
                }
            })
            $(function () {
                $(&quot;#accordion&quot;).accordion({
                    header: &quot;h3&quot;, collapsible: true, heightStyle: &quot;content&quot;, active: false,

                    activate: function (event, ui) {
                        if (!$.isEmptyObject(ui.newHeader.offset())) {
                            $(&quot; , &quot;'&quot; , &quot;html:not(:animated), body:not(:animated)&quot; , &quot;'&quot; , &quot;).animate({ scrollTop: ui.newHeader.offset().top }, &quot; , &quot;'&quot; , &quot;fast&quot; , &quot;'&quot; , &quot;);
                        }
                    }
                });
                //$(&quot;#accordion h3&quot;).eq(0).off(&quot;click&quot;);
                //$(&quot;#accordion h3&quot;).eq(1).off(&quot;click&quot;);
            });
            //$(&quot;#accordion&quot;).on(&quot;click&quot;, &quot;.ui-accordion-header&quot;, function () {
            //    var header = $(this);
            //    var index = header.index();

            //    if (header.hasClass(&quot;ui-accordion-header-active&quot;)) {
            //        // Close the clicked panel
            //        header.removeClass(&quot;ui-accordion-header-active&quot;);
            //        header.next().slideUp();
            //    } else {
            //        // Open the clicked panel
            //        header.addClass(&quot;ui-accordion-header-active&quot;);
            //        header.next().slideDown();
            //    }
            //    if (index == &quot;0&quot;) {
            //        loadBrand();
            //    } else if (index == &quot;2&quot;) {
            //        loadSubBrand();
            //    }
            //});
            $(&quot;#accordion h3&quot;).eq(0).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadBrand();
                }
            });
            $(&quot;#accordion h3&quot;).eq(1).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadSubBrand();
                }
            });
            $(&quot;#accordion h3&quot;).eq(2).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    CheckSubPline();
                }
            });
            $(&quot;#accordion h3&quot;).eq(3).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadPartType();
                }
            });
            $(&quot;#accordion h3&quot;).eq(4).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadVehicleType();
                }
            });
            $(&quot;#accordion h3&quot;).eq(5).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadMake();
                }
            });
            $(&quot;#accordion h3&quot;).eq(6).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadRegion();
                }
            });
            $(&quot;#accordion h3&quot;).eq(7).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadSubHeader();
                    loadHeaderdetails();
                    $(&quot;#SubmissionType&quot;).val(&quot;1&quot;);
                }
            });
            $(&quot;#accordion h3&quot;).eq(8).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadSubHeader();
                    loadPIESHeaderdetails();
                    $(&quot;#PIESSubmissionType&quot;).val(&quot;1&quot;);
                }
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllbrand&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.brandchk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                BrandIds = $(&quot;.brandchk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllSubbrand&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.Subbrandchk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                SubBrandIds = $(&quot;.Subbrandchk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllSubPline&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.SubPlinechk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                SubPLine = $(&quot;.SubPlinechk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllPartType&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.PartTypechk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                PartTypeIds = $(&quot;.PartTypechk:checked&quot;).filter(function () {
                    // Check if this checkbox is within a visible .filterclassPT element
                    return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassPT&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
                }).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllVehicleType&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.VehicleTypechk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                VehicleTypeIds = $(&quot;.VehicleTypechk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllMake&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.Makechk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                MakeIds = $(&quot;.Makechk:checked&quot;).filter(function () {
                    return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassM&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
                }).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllRegion&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.Regionchk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                RegionIds = $(&quot;.Regionchk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#chkequ&quot; , &quot;'&quot; , &quot;).click(function () {
                EnptyChkboxs();
                CloseTab();
            });
            $(&quot;#DrpEbay&quot;).change(function () {
                $(&quot;#accordion&quot;).show();
                $(&quot;#Ebaylbldrp&quot;).show();
                $(&quot;#loaddatabox&quot;).show();
                $(&quot;#Regionh3&quot;).show();
                $(&quot;#vehicletypeh3&quot;).show();
                $(&quot;#Makeh3&quot;).show();
                $(&quot;#Bottomdata&quot;).show();
                $(&quot;.Exportdate&quot;).show();
                $(&quot;#ExcelExport&quot;).show();
            })
        });
        function GetexportMenu() {
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetexportMenu&quot; , &quot;'&quot; , &quot;,
                data: &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;,
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    data.forEach(function (item) {
                        if (item.Iconlist === &quot;All Applications&quot;) {
                            $(&quot;#AllApplication&quot;).show();
                        }
                        else if (item.Iconlist === &quot;ACES with QDB Codes&quot;) {
                            $(&quot;#ACESwithQDB&quot;).show();
                        }
                        else if (item.Iconlist === &quot;ACES with Raw Notes&quot;) {
                            $(&quot;#ACESwithRawNotes&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Pies&quot;) {
                            $(&quot;#PIES&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Amazon&quot;) {
                            $(&quot;#Amazon&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Walmart&quot;) {
                            $(&quot;#Walmart&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Walmart XML&quot;) {
                            $(&quot;#WalmartPIES&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Ebay&quot;) {
                            $(&quot;#Ebay&quot;).show();
                        }
                        else if (item.Iconlist === &quot;AcesInvalid&quot;) {
                            $(&quot;#ACESInvalid&quot;).show();
                        }
                        else if (item.Iconlist === &quot;AcesRawNotes with Invalid&quot;) {
                            $(&quot;#ACESwithRawNotesandAttributeInvalid&quot;).show();
                        }
                    });
                },
            });
        }
        function GetCustomExportImage() {
            var data = {
                &quot;AdminID&quot;: AdminId
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetCustomExportImage&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    var url = window.location.origin;
                    $.each(data, function (index, item) {
                        var urlpath = url + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot; + item.Filepath.replace(&quot; , &quot;'&quot; , &quot;~&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);
                        var $button = $(&quot; , &quot;'&quot; , &quot;&lt;button>&quot; , &quot;'&quot; , &quot;, {
                            class: &quot; , &quot;'&quot; , &quot;tablinks Cusimgexport&quot; , &quot;'&quot; , &quot;,
                            title: item.Nameofoutput,
                            id: item.Nameofoutput
                        });
                        var $img = $(&quot; , &quot;'&quot; , &quot;&lt;img>&quot; , &quot;'&quot; , &quot;, {
                            src: urlpath,
                            alt: item.Nameofoutput,
                            class: &quot; , &quot;'&quot; , &quot;tab-icon1&quot; , &quot;'&quot; , &quot;
                        });
                        $button.append($img);
                        $(&quot; , &quot;'&quot; , &quot;#buttonContainer&quot; , &quot;'&quot; , &quot;).append($button);
                    });
                },
            });
        }
        $.fn.select2.amd.require([
            &quot; , &quot;'&quot; , &quot;select2/selection/single&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/selection/placeholder&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/selection/allowClear&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/dropdown&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/dropdown/search&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/dropdown/attachBody&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/utils&quot; , &quot;'&quot; , &quot;
        ], function (SingleSelection, Placeholder, AllowClear, Dropdown, DropdownSearch, AttachBody, Utils) {

            var SelectionAdapter = Utils.Decorate(
                SingleSelection,
                Placeholder
            );

            SelectionAdapter = Utils.Decorate(
                SelectionAdapter,
                AllowClear
            );

            var DropdownAdapter = Utils.Decorate(
                Utils.Decorate(
                    Dropdown,
                    DropdownSearch
                ),
                AttachBody
            );

            var base_element = $(&quot; , &quot;'&quot; , &quot;#drpinterchange&quot; , &quot;'&quot; , &quot;);
            $(base_element).select2({
                placeholder: &quot; , &quot;'&quot; , &quot;Select multiple items&quot; , &quot;'&quot; , &quot;,
                selectionAdapter: SelectionAdapter,
                dropdownAdapter: DropdownAdapter,
                allowClear: true,
                selectOnClose: false,
                templateResult: function (data) {
                    if (!data.id) { return data.text; }

                    var $res = $(&quot; , &quot;'&quot; , &quot;&lt;div>&lt;/div>&quot; , &quot;'&quot; , &quot;);

                    $res.text(data.text);
                    $res.addClass(&quot; , &quot;'&quot; , &quot;wrap&quot; , &quot;'&quot; , &quot;);

                    return $res;
                },
                templateSelection: function (data) {

                    if (!data.id) {
                        return data.text;
                    }

                    var selected = ($(&quot; , &quot;'&quot; , &quot;#drpinterchange&quot; , &quot;'&quot; , &quot;).val() || []).length;
                    var total = $(&quot; , &quot;'&quot; , &quot;option&quot; , &quot;'&quot; , &quot;, $(&quot; , &quot;'&quot; , &quot;#drpinterchange&quot; , &quot;'&quot; , &quot;)).length;
                    return &quot;Selected &quot; + selected + &quot; of &quot; + total;
                }
            });
        });
        function select2onclose() {
            var Attribute = $(&quot;#drpinterchange&quot;).val().join();
            if (Attribute == &quot;&quot; || Attribute == undefined) {
                Attribute = &quot;0&quot;;
            }
            $(&quot;#drpinterchange1&quot;).val(Attribute);
            EnptyChkboxs();
            CloseTab();
        }
        function loadhdvalues() {
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;loadhdvalues&quot; , &quot;'&quot; , &quot;,
                data: &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;,
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    var UnitComp = data.Table;
                    var Capital = data.Table1;
                    var custonval = data.Table2;
                    var ptp = data.Table3;
                    var Brandidcnt = data.Table4;
                    var xmlftp = data.Table5;

                    if (UnitComp.length > 0) {
                        hdUnitComp = UnitComp[0].UnitCompcnt;
                    }
                    if (Capital.length > 0) {
                        hdCapital = Capital[0].Capitalcnt;
                    }
                    if (custonval.length > 0) {
                        hdIncludeCustomValue = custonval[0].Custonvalcnt;
                    }
                    if (ptp.length > 0) {
                        P2P = ptp[0].P2Pcnt;
                    }
                    if (Brandidcnt.length > 0) {
                        var brandhide = Brandidcnt[0].Brandidcnt;
                        if (brandhide == 1) {
                            hdbrand = &quot;true&quot;;
                            $(&quot;#Brandexport&quot;).show();
                        }
                    }
                    if (xmlftp.length > 0) {
                        XMLTOFTP = xmlftp[0].xmltoftp;
                    }
                },
            });
        }
        function OpenPIES() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;PIES&quot;;
            Services = &quot;EPI&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).hide();
            $(&quot;#Makeh3&quot;).hide();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;#ExcelExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Interchangelbldep&quot;).show();
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            hdExportType = &quot;Services&quot;;
			$(&quot;#exportst&quot;).show();
        }
        function OpenAllApplications() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;AllApplication&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#trading&quot;).hide();
            $(&quot;#accordion&quot;).hide();
            $(&quot;#incequipment&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).hide();
            $(&quot;#PIESHeader3&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;#exportst&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).hide();
            $(&quot;#ExcelExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#XMLExport&quot;).hide();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#ExcelExport&quot;).show();
            hdExportType = &quot;AllApplication&quot;;
            Services = &quot;ACES&quot;;
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            $(&quot;#unitcomplbldrp&quot;).hide();
			$(&quot;status-text overlap&quot;).hide();
        }
        function OpenACESwithQDBCodes() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;ACESwithQDB&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            $(&quot;#drpCompetitor1&quot;).val(&quot;&quot;);
            $(&quot;#chkequ&quot;).prop(&quot;checked&quot;, false);
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).show();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Approvedfor&quot;).show();
            $(&quot;#Interchangelbldep&quot;).show();
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#ExcelExport&quot;).show();
            hdExportType = &quot;ACESwithQDBCodes&quot;;
            hdAmazon = &quot;0&quot;;
            Services = &quot;ACES&quot;;
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
			$(&quot;#exportst&quot;).show();
        }
        function OpenACESwithRawNotes() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Services = &quot;ACES&quot;;
            Process = &quot;ACESwithRawNote&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            if (syncwithopticat == &quot;true&quot;) {
                $(&quot;#ImportOpticat&quot;).show();
            }
            else {
                $(&quot;#ImportOpticat&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).show();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Approvedfor&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            hdAmazon = &quot;0&quot;;
            $(&quot;#Interchangelbldep&quot;).show();
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#ExcelExport&quot;).show();
            hdExportType = &quot;ACESwithRawNotes&quot;;
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
			$(&quot;#exportst&quot;).show();
        }
        function OpenACESwithRawNotesandInvalid() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Services = &quot;ACES&quot;;
            Process = &quot;ACESwithRawNoteandInvalid&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            hdAmazon = &quot;0&quot;;
            hdExportType = &quot;ACESwithRawNotesandInvalid&quot;;
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
        }
        function OpenACESInvalid() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;ACESInvalid&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            hdAmazon = &quot;0&quot;;
            hdExportType = &quot;ACESInvalid&quot;;
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
        }
        function OpenAmazon() {
            Process = &quot;Amazon&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#accordion&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Interchangelbldep&quot;).show();
            Loadlinecode();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#trading&quot;).hide();
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            $(&quot;#XMLExport&quot;).show();
            hdExportType = &quot;Amazon&quot;;
            Services = &quot;Amazon&quot;;
            hdAmazon = &quot;1&quot;;
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
        }
        function OpenWalmart() {
            LineTPwise = &quot;&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            Process = &quot;Walmart&quot;;
            Services = &quot;Walmart&quot;;
            $(&quot;#accordion&quot;).hide();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).show();
            $(&quot;#XMLExport&quot;).show();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            $(&quot;#trading&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
        }
        function OpenWalmartPIES() {
            LineTPwise = &quot;&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            Process = &quot;WalmartPIES&quot;;
            Services = &quot;WalmartPIES&quot;;
            $(&quot;#accordion&quot;).hide();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).hide();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            $(&quot;#trading&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
            $(&quot;#vehicletypeh3&quot;).hide();
            $(&quot;#Makeh3&quot;).hide();
            $(&quot;#Regionh3&quot;).hide();
            Services = &quot;WAL&quot;;
            $(&quot;#Header3&quot;).hide();
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            $(&quot;#PIESHeader3&quot;).show();
            hdExportType = &quot;Services&quot;;
        }
        function OpenEbay() {
            LineTPwise = &quot;&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            Services = &quot;Ebay&quot;;
            Process = &quot;Ebay&quot;;           
            $(&quot;#accordion&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).show();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;#unitcomplbldrp&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).hide();
            $(&quot;#trading&quot;).hide();                  
            $(&quot;#subplineh3&quot;).hide();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;#vehicletypeh3&quot;).hide();
            $(&quot;#Makeh3&quot;).hide();
            $(&quot;#Header3&quot;).hide();
            $(&quot;#PIESHeader3&quot;).hide();           
            $(&quot;#Brandh3&quot;).hide();
            $(&quot;#Subbrandh3&quot;).hide();
            $(&quot;#Bottomdata&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#XMLExport&quot;).hide();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            LoadEbayStore();
        }
        function Loadlinecode() {
            var Trading = &quot;0&quot;;
            if (LineTPwise == &quot;TP&quot;) {
                Trading = $(&quot;#drptradingpartner&quot;).val();
            }
            var data1 = {
                &quot;AdminId&quot;: AdminId,
                &quot;Trading&quot;: Trading
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;Exportdatalinedrp&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data1),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {

                    $(&quot;#DrpLine&quot;).empty();
                    if (data.length == 0) {
                        $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                    }
                    else if (data.length == 1) {
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                        }
                    }
                    else if (data.length > 1) {
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                        }
                        if (Process == &quot;PIES&quot;) {
                            $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;ALL&quot;));
                        }
                        else if (Process == &quot;AllApplication&quot;) {
                            if (AllExcelExportOption == &quot;&quot;) {
                                $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;ALL&quot;));
                            }
                        }
                        else if (FMP == &quot;true&quot;) {
                            if (Process == &quot;ACESwithQDB&quot; || Process == &quot;ACESwithRawNote&quot;) {
                                if (AllExcelExportOption == &quot;&quot;) {
                                    $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;ALL&quot;));
                                }
                            }
                        }
                    }

                    $.each(data, function () {
                        $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(this[&quot; , &quot;'&quot; , &quot;MfrBrandID&quot; , &quot;'&quot; , &quot;]).text(this[&quot; , &quot;'&quot; , &quot;MfrBrandName&quot; , &quot;'&quot; , &quot;]));
                    });
					if (LineTPwise == &quot;TP&quot;){
						$(&quot; , &quot;'&quot; , &quot;#DrpLine&quot; , &quot;'&quot; , &quot;).trigger(&quot; , &quot;'&quot; , &quot;change&quot; , &quot;'&quot; , &quot;);
					}
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }

                }
            });

        }
        function Loadinterchange() {
            var linecode = $(&quot;#DrpLine&quot;).val();
            var data = {
                &quot;Linecode&quot;: linecode
            }
            var url = WebAPIURL + &quot; , &quot;'&quot; , &quot;Exportinterchangedrp&quot; , &quot;'&quot; , &quot;;
            if (ReadOnlyDB == &quot;true&quot;) {
                url = WebAPIURLReadOnly + &quot; , &quot;'&quot; , &quot;Exportinterchangedrp&quot; , &quot;'&quot; , &quot;;
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: url,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    $(&quot;#drpinterchange&quot;).empty();
                    $.each(data, function () {
                        $(&quot;#drpinterchange&quot;).append($(&quot;&lt;option/>&quot;).val(this[&quot; , &quot;'&quot; , &quot;CompetitorID&quot; , &quot;'&quot; , &quot;]).text(this[&quot; , &quot;'&quot; , &quot;CompetitorName&quot; , &quot;'&quot; , &quot;]));
                    });
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }
                }
            });
        }
        function LoadTradingPartner() {
            var Linecode = &quot;0&quot;;
            if (LineTPwise == &quot;Line&quot;) {
                Linecode = $(&quot;#DrpLine&quot;).val();
            }
            var data1 = {
                &quot;AdminId&quot;: AdminId,
                &quot;Linecode&quot;: Linecode
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;LoadTradingPartner&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data1),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {

                    $(&quot;#drptradingpartner&quot;).empty();
                    if (data.length == 1 || data.length == 0) {
                        $(&quot;#drptradingpartner&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                    }
                    else if (data.length > 1) {
                        $(&quot;#drptradingpartner&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                    }

                    $.each(data, function () {
                        $(&quot;#drptradingpartner&quot;).append($(&quot;&lt;option/>&quot;).val(this[&quot; , &quot;'&quot; , &quot;ID&quot; , &quot;'&quot; , &quot;]).text(this[&quot; , &quot;'&quot; , &quot;TradingName&quot; , &quot;'&quot; , &quot;]));
                    });
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }

                }
            });

        }
        function LoadEbayStore() {
            var Marketid = &quot;1&quot;;
            var data1 = {
                &quot;MarketId&quot;: Marketid
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;LoadStoreNameMarketplace&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data1),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {

                    $(&quot;#DrpEbay&quot;).empty();
                    if (data.length == 1 || data.length == 0) {
                        $(&quot;#DrpEbay&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                    }
                    else if (data.length > 1) {
                        $(&quot;#DrpEbay&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));                        
                    }

                    $.each(data, function () {
                        $(&quot;#DrpEbay&quot;).append($(&quot;&lt;option/>&quot;).val(this[&quot; , &quot;'&quot; , &quot;Storeid&quot; , &quot;'&quot; , &quot;]).text(this[&quot; , &quot;'&quot; , &quot;Storename&quot; , &quot;'&quot; , &quot;]));
                    });
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }

                }
            });

        }
        function EnptyChkboxs() {
            $(&quot; , &quot;'&quot; , &quot;#checkAllbrand&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, true);
            BrandIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            SubBrandIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            SubPLine = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            PartTypeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            Equipment = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            searchdata = &quot;&quot;;
            searchMdata = &quot;&quot;;
            VehicleTypeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            MakeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            RegionIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
        }
        function CloseTab() {
            $(function () {
                $(&quot;#accordion&quot;).accordion({
                    header: &quot;h3&quot;, collapsible: true, heightStyle: &quot;content&quot;, active: false,

                    activate: function (event, ui) {
                        if (!$.isEmptyObject(ui.newHeader.offset())) {
                            $(&quot; , &quot;'&quot; , &quot;html:not(:animated), body:not(:animated)&quot; , &quot;'&quot; , &quot;).animate({ scrollTop: ui.newHeader.offset().top }, &quot; , &quot;'&quot; , &quot;fast&quot; , &quot;'&quot; , &quot;);
                        }
                    }
                });
            });
        }
        function loadBrand() {
            event.preventDefault();
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#chkbrandlist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            var trading = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                if ($(&quot;#drptradingpartner&quot;).val() != 0) {
                    trading = $(&quot;#drptradingpartner&quot;).val();
                }
            }
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;AdminGroupID&quot;: AdminGroupID,
                &quot;Trading&quot;: trading
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetMainBrandsBasedonLineNew&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
                    var divEdit = $(&quot;#chkbrandlist&quot;);
                    $(&quot;#Balllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (BrandIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = BrandIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp brandchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp brandchk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp brandchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (BrandIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (BrandIds == &quot;0&quot;) {
                    //            BrandIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                    //        }
                    //        BrandIds += (BrandIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;];
                    //    });
                    //}
                    $(&quot;.brandchk&quot;).change(function () {
                        if (LineTPwise != &quot;TP&quot;) {
                            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                                $(&quot;.brandchk&quot;).not(this).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, false);
                            }
                        }
                        BrandIds = $(&quot;.brandchk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.brandchk&quot;).length === $(&quot;.brandchk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllbrand&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.brandchk&quot;).length === $(&quot;.brandchk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllbrand&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    if (LineTPwise != &quot;TP&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, true);
                            $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        }
                        else {
                            $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                    }
                    else {
                        $(&quot;.brandchk&quot;).prop(&quot;checked&quot;, true);
                    }
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            });
            //$(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
        }
        function loadSubBrand() {
            event.preventDefault();
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#chkSubbrandlist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            var trading = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                if ($(&quot;#drptradingpartner&quot;).val() != 0) {
                    trading = $(&quot;#drptradingpartner&quot;).val();
                }
            }
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;BrandIds&quot;: BrandIds,
                &quot;Trading&quot;: trading
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetBrandsBasedonLineNew&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
                    var divEdit = $(&quot;#chkSubbrandlist&quot;);
                    $(&quot;#SBalllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (SubBrandIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = SubBrandIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Subbrandchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Subbrandchk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Subbrandchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (SubBrandIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (SubBrandIds == &quot;0&quot;) {
                    //            SubBrandIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                    //        }
                    //        SubBrandIds += (SubBrandIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;];
                    //    });
                    //}
                    $(&quot;.Subbrandchk&quot;).change(function () {
                        if (LineTPwise != &quot;TP&quot;) {
                            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                                $(&quot;.Subbrandchk&quot;).not(this).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, false);
                            }
                        }
                        SubBrandIds = $(&quot;.Subbrandchk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.Subbrandchk&quot;).length === $(&quot;.Subbrandchk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllSubbrand&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.Subbrandchk&quot;).length === $(&quot;.Subbrandchk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllSubbrand&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    if (LineTPwise != &quot;TP&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, true);
                            $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        }
                        else {
                            $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                    }
                    else {
                        $(&quot;.Subbrandchk&quot;).prop(&quot;checked&quot;, true);
                    }
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            });
            //$(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
        }
        function CheckSubPline() {
            event.preventDefault();
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var linecode = $(&quot;#DrpLine&quot;).val();
            $(&quot;#chkSubplinelist&quot;).empty();
            var data = {
                &quot;linecode&quot;: linecode
            }
            var url = WebAPIURL + &quot; , &quot;'&quot; , &quot;CheckSubPline&quot; , &quot;'&quot; , &quot;;
            if (ReadOnlyDB == &quot;true&quot;) {
                url = WebAPIURLReadOnly + &quot; , &quot;'&quot; , &quot;CheckSubPline&quot; , &quot;'&quot; , &quot;;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: url,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
                    if (data.length > 0) {
                        $(&quot;#subplineh3&quot;).show();
                        var divEdit = $(&quot;#chkSubplinelist&quot;);
                        $(&quot;#Splalllist&quot;).show();
                        $.each(data, function (index, value) {
                            if (SubPLine != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                                var isChecked = SubPLine.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;]));
                                if (isChecked) {
                                    var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp SubPlinechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                                }
                                else {
                                    var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp SubPlinechk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                                }
                                divEdit.append(rdb);
                            } else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp SubPlinechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                                divEdit.append(rdb);
                            }

                        });
                        //if (SubPLine == &quot;0&quot;) {
                        //    $.each(data, function (index, value) {
                        //        if (SubPLine == &quot;0&quot;) {
                        //            SubPLine = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                        //        }
                        //        SubPLine += (SubPLine ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;];
                        //    });
                        //}
                        $(&quot;.SubPlinechk&quot;).change(function () {
                            SubPLine = $(&quot;.SubPlinechk:checked&quot;).map(function () {
                                return this.id;
                            }).get().join(&quot;,&quot;);
                            var allChecked = $(&quot;.SubPlinechk&quot;).length === $(&quot;.SubPlinechk:checked&quot;).length;
                            $(&quot; , &quot;'&quot; , &quot;#checkAllSubPline&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                        });
                        var allChecked = $(&quot;.SubPlinechk&quot;).length === $(&quot;.SubPlinechk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllSubPline&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;,true);
                            $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;,true);
                        }
                        else {
                            $(&quot;#checkAllSubPline&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                    }
                    else {
                        $(&quot;#subplineh3&quot;).hide();
                        SubPLine = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
                    }
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                },
                error: function (x, t, m) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function loadPartType() {
            event.preventDefault();
			$(&quot;#filter&quot;).val(&quot;&quot;);
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#chkPartTypelist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            var trading = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                if ($(&quot;#drptradingpartner&quot;).val() != 0) {
                    trading = $(&quot;#drptradingpartner&quot;).val();
                }
            }
            var storeid = $(&quot;#DrpEbay&quot;).val();
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;SubBrandIds&quot;: SubBrandIds,
                &quot;BrandIds&quot;: BrandIds,
                &quot;Adminid&quot;: AdminId,
                &quot;Trading&quot;: trading,
                &quot;storeid&quot;: storeid
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetPartTypedata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    debugger
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
                    var divEdit = $(&quot;#chkPartTypelist&quot;);
                    $(&quot;#PTalllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (PartTypeIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = PartTypeIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassPT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp PartTypechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassPT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp PartTypechk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassPT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp PartTypechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (PartTypeIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (PartTypeIds == &quot;0&quot;) {
                    //            PartTypeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                    //        }
                    //        PartTypeIds += (PartTypeIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;];
                    //    });
                    //}
                    $(&quot;.PartTypechk&quot;).change(function () {
                        if (LineTPwise != &quot;TP&quot;) {
                            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                                $(&quot;.PartTypechk&quot;).not(this).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, false);
                            }
                        }
                        PartTypeIds = $(&quot;.PartTypechk:checked&quot;).filter(function () {
                            // Check if this checkbox is within a visible .filterclassPT element
                            return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassPT&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
                        }).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.PartTypechk&quot;).length === $(&quot;.PartTypechk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllPartType&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.PartTypechk&quot;).length === $(&quot;.PartTypechk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllPartType&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    if (LineTPwise != &quot;TP&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            if (PartTypeIds == &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                                $(&quot;.PartTypechk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, false);
                            }
                        }
                        else {
                            $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                    }
                    else {
                        $(&quot;.PartTypechk&quot;).prop(&quot;checked&quot;, true);
                    }
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            });
            
        }
        function searchPTpart() {
            var result = false;
            if ($(&quot;#filter&quot;).val() == &quot;&quot;) {
                alert(&quot;please enter a value&quot;);
                searchdata = &quot;&quot;;
            }
            if (searchdata == &quot;&quot;) {
                searchdata = $(&quot;#filter&quot;).val();
            }
            else {
                searchdata = searchdata + &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; + $(&quot;#filter&quot;).val();
            }
            var searchArray = searchdata.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;);
            var re = new RegExp(&quot; , &quot;'&quot; , &quot;^(&quot; , &quot;'&quot; , &quot; + searchArray.join(&quot; , &quot;'&quot; , &quot;|&quot; , &quot;'&quot; , &quot;) + &quot; , &quot;'&quot; , &quot;)&quot; , &quot;'&quot; , &quot;, &quot;i&quot;);

            $(&quot; , &quot;'&quot; , &quot;.filterclassPT&quot; , &quot;'&quot; , &quot;).each(function () {
                var text = $(this).text(),
                    matches = !!text.match(re);
                $(this).toggle(matches);
                if (matches) {
                    result = true;
                }
            });
            PartTypeIds = $(&quot;.PartTypechk:checked&quot;).filter(function () {
                // Check if this checkbox is within a visible .filterclassPT element
                return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassPT&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
            }).map(function () {
                return this.id;
            }).get().join(&quot;,&quot;);
        }
        function resetPTdata() {
            searchdata = &quot;&quot;;
            $(&quot; , &quot;'&quot; , &quot;#filter&quot; , &quot;'&quot; , &quot;).val(&quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);
            $(&quot; , &quot;'&quot; , &quot;.filterclassPT&quot; , &quot;'&quot; , &quot;).each(function () {
                $(this).show();
            });
            //$(&quot; , &quot;'&quot; , &quot;#checkAllPartType&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, true);
        }
        function loadVehicleType() {
            event.preventDefault();
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#chkVehicleTypelist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            Equipment = &quot;0&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
			if (Process == &quot;AllApplication&quot;){
				Equipment = &quot;1&quot;;
			}
            var storeid = $(&quot;#DrpEbay&quot;).val();
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;SubBrandIds&quot;: SubBrandIds,
                &quot;BrandIds&quot;: BrandIds,
                &quot;AdminID&quot;: AdminId,
                &quot;Partdesc&quot;: PartTypeIds,
                &quot;Type&quot;: &quot;Vehicle&quot;,
                &quot;Equipment&quot;: Equipment,
                &quot;VehicleTypeIds&quot;: &quot;&quot;,
                &quot;storeid&quot;: storeid
            }
            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                if (FMP != &quot;true&quot;) {
                    if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        });
                        $(&quot;.loader_main_spin&quot;).hide();
                        return;
                    }

                }
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetVehicleTypeandMake&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    debugger
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
                    var divEdit = $(&quot;#chkVehicleTypelist&quot;);
                    $(&quot;#VTalllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (VehicleTypeIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = VehicleTypeIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassVT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp VehicleTypechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassVT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp VehicleTypechk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassVT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp VehicleTypechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (VehicleTypeIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (VehicleTypeIds == &quot;0&quot;) {
                    //            VehicleTypeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                    //        }
                    //        VehicleTypeIds += (VehicleTypeIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;];
                    //    });
                    //}
                    $(&quot;.VehicleTypechk&quot;).change(function () {
                        VehicleTypeIds = $(&quot;.VehicleTypechk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.VehicleTypechk&quot;).length === $(&quot;.VehicleTypechk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllVehicleType&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.VehicleTypechk&quot;).length === $(&quot;.VehicleTypechk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllVehicleType&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            });
            
        }
        function loadMake() {
            event.preventDefault();
			$(&quot;#filterM&quot;).val(&quot;&quot;);
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#chkMakelist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            Equipment = &quot;1&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
            var storeid = $(&quot;#DrpEbay&quot;).val();
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;SubBrandIds&quot;: SubBrandIds,
                &quot;BrandIds&quot;: BrandIds,
                &quot;AdminID&quot;: AdminId,
                &quot;Partdesc&quot;: PartTypeIds,
                &quot;Type&quot;: &quot;Make&quot;,
                &quot;Equipment&quot;: Equipment,
                &quot;VehicleTypeIds&quot;: VehicleTypeIds,
                &quot;storeid&quot;: storeid
            }
            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                if (FMP != &quot;true&quot;) {
                    if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        });
                        $(&quot;.loader_main_spin&quot;).hide();
                        return;
                    }

                }
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetVehicleTypeandMake&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    debugger
                    var divEdit = $(&quot;#chkMakelist&quot;);
                    $(&quot;#Malllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (MakeIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = MakeIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassM&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Makechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassM&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Makechk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassM&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Makechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (MakeIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (MakeIds == &quot;0&quot;) {
                    //            MakeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                    //        }
                    //        MakeIds += (MakeIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;];
                    //    });
                    //}
                    $(&quot;.Makechk&quot;).change(function () {
                        MakeIds = $(&quot;.Makechk:checked&quot;).filter(function () {
                            return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassM&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
                        }).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.Makechk&quot;).length === $(&quot;.Makechk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllMake&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.Makechk&quot;).length === $(&quot;.Makechk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllMake&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    $(&quot;.loader_main_spin&quot;).hide();
                }
            });
            //$(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
        }
        function searchMpart() {
            var result = false;
            if ($(&quot;#filterM&quot;).val() == &quot;&quot;) {
                alert(&quot;please enter a value&quot;);
                searchMdata = &quot;&quot;;
            }
            if (searchMdata == &quot;&quot;) {
                searchMdata = $(&quot;#filterM&quot;).val();
            }
            else {
                searchMdata = searchMdata + &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; + $(&quot;#filterM&quot;).val();
            }
            var searchArray = searchMdata.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;);
            var re = new RegExp(&quot; , &quot;'&quot; , &quot;^(&quot; , &quot;'&quot; , &quot; + searchArray.join(&quot; , &quot;'&quot; , &quot;|&quot; , &quot;'&quot; , &quot;) + &quot; , &quot;'&quot; , &quot;)&quot; , &quot;'&quot; , &quot;, &quot;i&quot;);

            $(&quot; , &quot;'&quot; , &quot;.filterclassM&quot; , &quot;'&quot; , &quot;).each(function () {
                var text = $(this).text(),
                    matches = !!text.match(re);
                $(this).toggle(matches);
                if (matches) {
                    result = true;
                }
            });
            MakeIds = $(&quot;.Makechk:checked&quot;).filter(function () {
                return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassM&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
            }).map(function () {
                return this.id;
            }).get().join(&quot;,&quot;);
        }
        function resetMdata() {
            searchMdata = &quot;&quot;;
            $(&quot; , &quot;'&quot; , &quot;#filterM&quot; , &quot;'&quot; , &quot;).val(&quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);
            $(&quot; , &quot;'&quot; , &quot;.filterclassM&quot; , &quot;'&quot; , &quot;).each(function () {
                $(this).show();
            });
        }
        function loadRegion() {
            event.preventDefault();
            $(&quot;#chkRegionlist&quot;).empty();
            var data = {}
            var url = WebAPIURL + &quot; , &quot;'&quot; , &quot;loadRegion&quot; , &quot;'&quot; , &quot;;
            if (ReadOnlyDB == &quot;true&quot;) {
                url = WebAPIURLReadOnly + &quot; , &quot;'&quot; , &quot;loadRegion&quot; , &quot;'&quot; , &quot;;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: url,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    var divEdit = $(&quot;#chkRegionlist&quot;);
                    $(&quot;#Ralllist&quot;).show();
                    $.each(data, function (index, value) {
                        if (RegionIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = RegionIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Regionchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Regionchk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Regionchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    if (RegionIds == &quot;0&quot;) {
                        RegionIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                        $.each(data, function (index, value) {
                            RegionIds += (RegionIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + value.RegionID;
                        });
                    }
                    $(&quot;.Regionchk&quot;).change(function () {
                        RegionIds = $(&quot;.Regionchk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.Regionchk&quot;).length === $(&quot;.Regionchk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllRegion&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.Regionchk&quot;).length === $(&quot;.Regionchk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllRegion&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function Tradingchange() {
            var trading = $(&quot;#drptradingpartner&quot;).val();
            //CloseTab();
            //if (LineTPwise != &quot;Line&quot;) {
            //    Loadlinecode();
            //}
            //if ($(&quot;#drptradingpartner&quot;).val() != &quot;-SELECT-&quot;) {
            //    $(&quot;#drpinterchange&quot;).empty();
            //    $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
            //    $(&quot;#accordion&quot;).show();
            //    $(&quot;#Bottomdata&quot;).show();
            //    LineTPwise = &quot;TP&quot;;
            //}
            //else {
            //    $(&quot;#drpinterchange&quot;).empty();
            //    $(&quot;#accordion&quot;).hide();
            //    $(&quot;#Bottomdata&quot;).hide();
            //}
            if ($(&quot;#drptradingpartner&quot;).val() != &quot;0&quot;) {
                if (LineTPwise != &quot;Line&quot;) {
                    LineTPwise = &quot;TP&quot;;
                }
            }
            else {
                if (LineTPwise != &quot;Line&quot;) {
                    LineTPwise = &quot;&quot;;
                    Loadlinecode();
                }

            }
            if (LineTPwise == &quot;TP&quot;) {
                Loadlinecode();
            }
            if (trading != &quot;0&quot;) {
                $(&quot;#PartExport&quot;).hide();
                $(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, false).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
            }
            else {
                $(&quot;#PartExport&quot;).show();
                $(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, true).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
            }
            if (Process == &quot;Amazon&quot; || Process == &quot;Walmart&quot;) {
                $(&quot;#ExcelExport&quot;).hide();
                $(&quot;#CSVExport&quot;).hide();
            }
            Getoverlapdate();
            EnptyChkboxs();
            CloseTab();
        }
        function Getoverlapdate() {
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;Addpopupdetailscount&quot; , &quot;'&quot; , &quot;,
                data: &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;,
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    var count = data[0].OverlapCount;
                    $(&quot; , &quot;'&quot; , &quot;#getupdatecountvalue&quot; , &quot;'&quot; , &quot;).text(data[0][&quot; , &quot;'&quot; , &quot;LastRunDate&quot; , &quot;'&quot; , &quot;]);
                    $(&quot; , &quot;'&quot; , &quot;#getupdatecount&quot; , &quot;'&quot; , &quot;).text(data[0][&quot; , &quot;'&quot; , &quot;OverlapCount&quot; , &quot;'&quot; , &quot;]);
                    if (count == 0) {
                        $(&quot; , &quot;'&quot; , &quot;#Overlapcheckbox&quot; , &quot;'&quot; , &quot;).hide();
                        $(&quot; , &quot;'&quot; , &quot;#getupdatecountvalue&quot; , &quot;'&quot; , &quot;).text(&quot;Not Run&quot;);
                    }
                },
            });
        }
        function loadSubHeader() {
            $(&quot;#SubmissionType&quot;).empty();
            $(&quot;#PIESSubmissionType&quot;).empty();
            if (Submissiontype == &quot;true&quot;) {
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;2&quot;).text(&quot;Update&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;2&quot;).text(&quot;Update&quot;));
            }
            else {
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
            }
            if (P2P == &quot;1&quot;) {
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;4&quot;).text(&quot;NET CHANGES&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;4&quot;).text(&quot;NET CHANGES&quot;));
            }
            $(&quot;#SubmissionType&quot;).val(&quot;1&quot;);
            $(&quot;#PIESSubmissionType&quot;).val(&quot;1&quot;);

        }
        function loadHeaderdetails() {
            event.preventDefault();
            var data = {
                &quot;AdminId&quot;: AdminId
            }
            var apiurl = WebAPIURL + &quot; , &quot;'&quot; , &quot;loadHeaderdetails&quot; , &quot;'&quot; , &quot;;
            if (ReadOnlyDB == &quot;true&quot;) {
                apiurl = WebAPIURLReadOnly + &quot; , &quot;'&quot; , &quot;loadHeaderdetails&quot; , &quot;'&quot; , &quot;;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: apiurl,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    var Table = data.Table;
                    var Table1 = data.Table1;

                    ACompanyName = Table[0][&quot;CompanyName&quot;] ?? &quot;&quot;;
                    ACompanyContact = Table1[0][&quot;ContactName&quot;] ?? &quot;&quot;;
                    AEffectiveDate = Table[0][&quot;EffectiveDate&quot;] ? Table[0][&quot;EffectiveDate&quot;].split(&quot;T&quot;)[0] : &quot;&quot;;
                    Adoctitle = Table[0][&quot;doctitle&quot;] ?? &quot;&quot;;
                    ADocformnumber = Table[0][&quot;Docformnumber&quot;] ?? &quot;&quot;;
                    ASenderCompany = Table[0][&quot;SenderCompany&quot;] ?? &quot;&quot;;
                    ASenderContact = Table1[0][&quot;ContactName&quot;] ?? &quot;&quot;;
                    ASenderPhone = Table1[0][&quot;Phonenumber&quot;] ?? &quot;&quot;;
                    Asenderphoneext = Table[0][&quot;senderphoneext&quot;] ?? &quot;&quot;;
                    Asenderemail = Table1[0][&quot;Email&quot;] ?? &quot;&quot;;
                    AMapperCompany = Table[0][&quot;MapperCompany&quot;] ?? &quot;&quot;;
                    AMapperContact = Table[0][&quot;MapperContact&quot;] ?? &quot;&quot;;
                    AMapperPhone = Table[0][&quot;MapperPhone&quot;] ?? &quot;&quot;;
                    AMapperPhoneext = Table[0][&quot;MapperPhoneext&quot;] ?? &quot;&quot;;
                    AMapperEmail = Table[0][&quot;MapperEmail&quot;] ?? &quot;&quot;;
                    AApprovedfor = Table[0][&quot;Approvedfor&quot;] ?? &quot;&quot;;

                    $(&quot;#CompanyName&quot;).val(ACompanyName);
                    $(&quot;#CompanyContact&quot;).val(ACompanyContact);
                    $(&quot;#EffectiveDate&quot;).val(AEffectiveDate);
                    $(&quot; , &quot;'&quot; , &quot;#DocumentTitle&quot; , &quot;'&quot; , &quot;).val(Adoctitle);
                    $(&quot; , &quot;'&quot; , &quot;#DocumentForm&quot; , &quot;'&quot; , &quot;).val(ADocformnumber);
                    $(&quot; , &quot;'&quot; , &quot;#SenderCompany&quot; , &quot;'&quot; , &quot;).val(ASenderCompany);
                    $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val(ASenderContact);
                    $(&quot; , &quot;'&quot; , &quot;#SenderPhone&quot; , &quot;'&quot; , &quot;).val(ASenderPhone);
                    $(&quot; , &quot;'&quot; , &quot;#SenderPhoneExt&quot; , &quot;'&quot; , &quot;).val(Asenderphoneext);
                    $(&quot; , &quot;'&quot; , &quot;#SenderEmail&quot; , &quot;'&quot; , &quot;).val(Asenderemail);
                    $(&quot; , &quot;'&quot; , &quot;#MapperCompany&quot; , &quot;'&quot; , &quot;).val(AMapperCompany);
                    $(&quot; , &quot;'&quot; , &quot;#MapperContact&quot; , &quot;'&quot; , &quot;).val(AMapperContact);
                    $(&quot; , &quot;'&quot; , &quot;#MapperPhone&quot; , &quot;'&quot; , &quot;).val(AMapperPhone);
                    $(&quot; , &quot;'&quot; , &quot;#MapperPhoneExt&quot; , &quot;'&quot; , &quot;).val(AMapperPhoneext);
                    $(&quot; , &quot;'&quot; , &quot;#MapperEmail&quot; , &quot;'&quot; , &quot;).val(AMapperEmail);
                    $(&quot; , &quot;'&quot; , &quot;#txtapprove&quot; , &quot;'&quot; , &quot;).val(AApprovedfor);
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function loadPIESHeaderdetails() {
            event.preventDefault();
            var data = {
                &quot;state&quot;: Services,
                &quot;AdminId&quot;: AdminId
            }
            var apiurl = WebAPIURL + &quot; , &quot;'&quot; , &quot;loadPIESHeaderdetails&quot; , &quot;'&quot; , &quot;;
            if (ReadOnlyDB == &quot;true&quot;) {
                apiurl = WebAPIURLReadOnly + &quot; , &quot;'&quot; , &quot;loadPIESHeaderdetails&quot; , &quot;'&quot; , &quot;;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: apiurl,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    var Table = data.Table;
                    var Table1 = data.Table1;

                    PContactName = Table1[0][&quot;ContactName&quot;] ?? &quot;&quot;;
                    PContactEmail = Table1[0][&quot;Email&quot;] ?? &quot;&quot;;
                    $(&quot;#ContactName&quot;).val(PContactName);
                    $(&quot;#ContactEmail&quot;).val(PContactEmail);

                    PCompany = Table[0][&quot;CompanyName&quot;] ?? &quot;&quot;;
                    PPLA = Table[0][&quot;PLA&quot;] ?? &quot;&quot;;
                    PVendorNumber = Table[0][&quot;VendorNumber&quot;] ?? &quot;&quot;;
                    PPIESSubmissionType = Table[0][&quot;PIESSubmissionType&quot;] ?? &quot;&quot;;
                    PPriceSheetNum = Table[0][&quot;PriceSheetNum&quot;] ?? &quot;&quot;;
                    PBlanketEffectiveDate = Table[0][&quot;BlanketEffectiveDate&quot;]? Table[0][&quot;BlanketEffectiveDate&quot;].split(&quot;T&quot;)[0]: &quot;&quot;;

                    $(&quot;#CompanyNamePIES&quot;).val(PCompany);
                    $(&quot;#ProdLineAbbr&quot;).val(PPLA);
                    $(&quot;#Vendor&quot;).val(PVendorNumber);

                    // Select the matching option for submission type, safely
                    $(&quot;#PIESSubmissionType option&quot;).each(function () {
                        if ($(this).text() === PPIESSubmissionType) {
                            $(this).prop(&quot;selected&quot;, true);
                        }
                    });

                    $(&quot;#PriceSheet&quot;).val(PPriceSheetNum);
                    $(&quot;#PIESEffectiveDate&quot;).val(PBlanketEffectiveDate);

                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function getExcel() {
            if (Process == &quot;PIES&quot;) {
                if (LineTPwise == &quot;Line&quot;) {
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        if (FMP != &quot;true&quot;) {
                            var isOpen = $(&quot;#accordion h3&quot;).eq(3).next().is(&quot;:visible&quot;);
                            if (!isOpen) {
                                $(&quot;#accordion h3&quot;).eq(3).click();
                            }
                            if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                                Swal.fire({
                                    icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                                    title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                                    allowOutsideClick: false,
                                    allowEscapeKey: false,
                                });
                                $(&quot;.loader_main_spin&quot;).hide();
                                return;
                            }
                            
                        }
                    }
                }
                Generate_PiesExportExcel();
            }
            if (Process == &quot;AllApplication&quot;) {
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    if (FMP != &quot;true&quot;) {
                        var isOpen = $(&quot;#accordion h3&quot;).eq(3).next().is(&quot;:visible&quot;);
                        if (!isOpen) {
                            $(&quot;#accordion h3&quot;).eq(3).click();
                        }
                        if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                            Swal.fire({
                                icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                                title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                                allowOutsideClick: false,
                                allowEscapeKey: false,
                            });
                            $(&quot;.loader_main_spin&quot;).hide();
                            return;
                        }
                        
                    }
                }
                Generate_All_ApplicationExcel();
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                GenerateQDBRawExportExcel();
            }
            if (Process == &quot;ACESwithRawNote&quot;) {
                GenerateQDBRawExportExcel();
            }
            if (Process == &quot;Ebay&quot;) {
                GenerateEbayExcel();
            }
        }
        function getcsv() {
            if (Process == &quot;AllApplication&quot;) {
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    if (FMP != &quot;true&quot;) {
                        var isOpen = $(&quot;#accordion h3&quot;).eq(3).next().is(&quot;:visible&quot;);
                        if (!isOpen) {
                            $(&quot;#accordion h3&quot;).eq(3).click();
                        }
                        if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                            Swal.fire({
                                icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                                title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                                allowOutsideClick: false,
                                allowEscapeKey: false,
                            });
                            $(&quot;.loader_main_spin&quot;).hide();
                            return;
                        }
                        
                    }
                }
                Generate_All_ApplicationCSV();
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                GenerateQDBRawExportCSV();
            }
            if (Process == &quot;ACESwithRawNote&quot;) {
                GenerateQDBRawExportCSV();
            }
        }
        function getxml() {
            if (Process == &quot;PIES&quot; || Process == &quot;WalmartPIES&quot;) {
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        });
                        $(&quot;.loader_main_spin&quot;).hide();
                        return;
                    }
                }
                Generate_PiesXML();
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                ExportFTP = &quot;&quot;;
                if (customizedflag == &quot;1&quot;) {
                    GenerateACESXML();
                } else {
                    openPopup();
                }
                
            }
            if (Process == &quot;ACESwithRawNote&quot;) {
                ExportFTP = &quot;&quot;;
                if (customizedflag == &quot;1&quot;) {
                    GenerateACESXML();
                } else {
                    openPopup();
                }
            }
            if (Process == &quot;Amazon&quot;) {
                ExportFTP = &quot;&quot;;
                GenerateACESXML();
            }
            if (Process == &quot;Walmart&quot;) {
                ExportFTP = &quot;&quot;;
                GenerateACESXML();
            }

        }
        function getxmltoftp() {
            ExportFTP = &quot;Yes&quot;;
            GenerateACESXML();
        }
        function Generate_PiesExportExcel() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var companyname = $(&quot;#CompanyNamePIES&quot;).val();
            companyname = companyname.replace(/[^A-Z0-9-_ ]/ig, &quot;&quot;);
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var SelectAllPartPiessxl = &quot;0&quot;;
            var Partdes = PartTypeIds;
            var MfrName = $(&quot;#DrpLine option:selected&quot;).text();
            MfrName = MfrName.split(&quot;|&quot;);
            MfrName = MfrName[0].trim();
            var ProductLine = SubPLine;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();

            if (Line != &quot;0&quot;) {

                if (Line == &quot;-SELECT-&quot;) {
                    alert(&quot;Please Select Line !!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
                if (Brand == &quot;&quot;) {
                    alert(&quot;Please Select BrandName!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
                if (ChkSubProdLineAlert == &quot;true&quot;) {
                    if (ProductLine == &quot;&quot;) {
                        alert(&quot;Please Select Sub Product Line!&quot;);
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        return false;
                    }
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }

            if (ProductLine == &quot;&quot;) {
                ProductLine = &quot;0&quot;;
            }

            if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                SelectAllPartPiessxl = &quot;1&quot;;
            }
            var unit = &quot;Unit&quot;;
            if (hdUnitComp == &quot;1&quot;) {
                unit = $(&quot;#Unitcomp option:selected&quot;).text();
            }
            var Filename = &quot;&quot;;

            var _data = {
                &quot;CompanyName&quot;: &quot;companyname&quot;,
                &quot;Piess&quot;: &quot;EPI&quot;,
                &quot;MfrBrandId&quot;: Line,
                &quot;MfrName&quot;: MfrName,
                &quot;PartDescriptionId&quot;: Partdes,
                &quot;BrandAAIAID&quot;: Brand,
                &quot;Productline&quot;: ProductLine,
                &quot;SelectAllParts&quot;: SelectAllPartPiessxl,
                &quot;AdminId&quot;: AdminId,
                &quot;Competitor&quot;: Competitor,
                &quot;Tradingpartner&quot;: Tradingpartner,
                &quot;UnitComponent&quot;: unit,
                &quot;Filename&quot;: Filename,
                &quot;BrandSubbrand&quot;: BrandSubbrand

            }
            if (ACESPIESQueue == &quot;false&quot;) {

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GeneratePIESExcelExportNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

            }
            else if (ACESPIESQueue == &quot;true&quot;) {

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SavePiesExportexceldataNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Fail&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                return false;
            }

        }
        function Generate_PiesXML() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var companyname = $(&quot;#CompanyNamePIES&quot;).val().trim();
            companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
            if (typeof companyname === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companyname === null || companyname === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                companyname = PCompany;  
            }
            var Pla = $(&quot;#PLA&quot;).val().trim();
            if (typeof Pla === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || Pla === null || Pla === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                Pla = PPLA || &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
            }
            var VendorNumber = $(&quot;#Vendor&quot;).val();
            if (typeof VendorNumber === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || VendorNumber === null || VendorNumber === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                VendorNumber = PVendorNumber;
            }
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            if (typeof drpSubmissionType === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || drpSubmissionType === null || drpSubmissionType === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                drpSubmissionType = &quot;Full&quot;;
            }
            var ContactPies = $(&quot;#ContactName&quot;).val();
            ContactPies = ContactPies.replace(/[&lt;>]/ig, &quot;&quot;);
            if (typeof ContactPies === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || ContactPies === null || ContactPies === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                ContactPies = PContactName;
            }
            var Email = $(&quot;#ContactEmail&quot;).val();
            if (typeof Email === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || Email === null || Email === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                Email = PContactEmail;
            }
            var EDate = $(&quot;#PIESEffectiveDate&quot;).val();
            if (typeof EDate === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || EDate === null || EDate === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                EDate = PBlanketEffectiveDate;
            }
            var PriceSheetNum = $(&quot;#PriceSheet&quot;).val();
            if (typeof PriceSheetNum === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || PriceSheetNum === null || PriceSheetNum === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                PriceSheetNum = PPriceSheetNum;
            }

            var ProductLine = SubPLine;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Partdes = PartTypeIds;

            var SelectAllPartPiessxml = &quot;1&quot;;
            if (ProductLine == &quot;&quot;) {
                ProductLine = &quot;0&quot;;
            }
            if (Process != &quot;WalmartPIES&quot;) {
                if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                    SelectAllPartPiessxml = &quot;1&quot;;
                }
                else {
                    SelectAllPartPiessxml = &quot;0&quot;;
                }
            }
            var piesname = &quot;&quot;;
            var Tradingpartner = &quot;0&quot;;
            if (Process == &quot;WalmartPIES&quot;) {
                piesname = &quot;WAL&quot;;
                piesname = &quot;Walmart PIES&quot;;
            }
            else if (Process == &quot;PIES&quot;) {
                piesname = &quot;EPI&quot;;
                if (TradingPartnerwebconfig == &quot;true&quot;) {
                    var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
                }
                else {
                    var Tradingpartner = &quot;0&quot;;
                }
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;

            var txtUptodate = &quot;&quot;
            var txtFromDate = &quot;&quot;
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == &quot;&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (companyname == &quot;&quot; || companyname == undefined) {
                alert(&quot;Please enter the company name!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ContactPies == &quot;&quot; || ContactPies == undefined) {
                alert(&quot;Please enter the Contact Name!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Email == &quot;&quot; || Email == undefined) {
                alert(&quot;Please enter the Contact Email!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (EDate == &quot;&quot; || EDate == undefined) {
                alert(&quot;Please enter the Effective Date!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (PriceSheetNum == &quot;&quot; || PriceSheetNum == undefined) {
                alert(&quot;Please enter the Price Sheet #&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (drpSubmissionType == &quot;0&quot; || drpSubmissionType == undefined) {
                alert(&quot;Please select the Submission Type!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            var _data = {
                &quot;Line&quot;: Line,
                &quot;Brand&quot;: Brand,
                &quot;BrandSubbrand&quot;: BrandSubbrand,
                &quot;SubProductLine&quot;: ProductLine,
                &quot;Partdescription&quot;: Partdes,
                &quot;SelectAllPartPiessxml&quot;: SelectAllPartPiessxml,
                &quot;companyname&quot;: companyname,
                &quot;Pla&quot;: Pla,
                &quot;VendorNumber&quot;: VendorNumber,
                &quot;drpSubmissionType&quot;: drpSubmissionType,
                &quot;ContactPies&quot;: ContactPies,
                &quot;Email&quot;: Email,
                &quot;EDate&quot;: EDate,
                &quot;PriceSheetNum&quot;: PriceSheetNum,
                &quot;AdminId&quot;: AdminId,
                &quot;piesname&quot;: piesname,
                &quot;TradingPartner&quot;: Tradingpartner,
                &quot;Competitor&quot;: Competitor,
                &quot;Units&quot;: Units,
                &quot;Comp&quot;: Comp
            }

            if (ACESPIESQueue == &quot;false&quot;) {
                var dataxml = {
                    &quot;acespies&quot;: &quot;Pies&quot;,
                }
                $.ajax({
                    type: &quot;POST&quot;, 
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;queuecheckxmlPermission&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(dataxml),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        if (response == &quot; , &quot;'&quot; , &quot;&quot;Yes&quot;&quot; , &quot;'&quot; , &quot;) {
                            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                            alert(&quot;An XML file creation is in progress for another user. Please try after some time.&quot;);
                        } else {
                            $.ajax({
                                type: &quot;POST&quot;,
                                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GeneratePIESXMLExportNew&quot; , &quot;'&quot; , &quot;,
                                data: JSON.stringify(_data),
                                contentType: &quot;application/json; charset=utf-8&quot;,
                                success: function (response) {
                                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                    var data = JSON.parse(response);
                                    var count = data.Count;
                                    var name = data.Name;
                                    var result = data.Result;
                                    let services = piesname;

                                    if (piesname === &quot;Walmart PIES&quot;) {
                                        services = &quot;WAL&quot;;
                                    }
                                    const sanitizedName = name.replace(/[^a-zA-Z0-9-_ ]+/g, &quot;&quot;);
                                    const fullURL = `downloadPiesXml.aspx?Services=${services}&amp;company=${sanitizedName}`;
                                    if (count != &quot;0&quot;) {
                                        if (result == &quot;Success&quot;) {
                                            window.open(fullURL, &quot; , &quot;'&quot; , &quot;_blank&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px&quot; , &quot;'&quot; , &quot;);
                                        }
                                        else {
                                            alert(&quot;Run Api mode contact administator&quot;);
                                        }
                                    }
                                    else {
                                        alert(&quot;There is no data for this criteria&quot;);
                                    }


                                },
                                error: function () {

                                    alert(&quot;Failed!&quot;)
                                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                }
                            })
                        }
                    },
                    error: function () {
                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                });
            }
            else if (ACESPIESQueue == &quot;true&quot;) {               
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SavePiesExportxmldataNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {

                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function (err) {
                        console.log(err);
                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                return false;
            }

        }
        function Generate_All_ApplicationExcel() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;-SELECT-&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            } 

            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Vehicle == &quot;&quot;) {
                alert(&quot;Select atleast one Vehicle!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Make == &quot;&quot;) {
                alert(&quot;Select atleast one Make!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;AllApplicaionExcelExportQueueNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
                //------------------  Queue end --------------------//
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;AllApplicaionExcelExport&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }

        }
        function Generate_All_ApplicationCSV() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;-SELECT-&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }

            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Vehicle == &quot;&quot;) {
                alert(&quot;Select atleast one Vehicle!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Make == &quot;&quot;) {
                alert(&quot;Select atleast one Make!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;AllApplicaionExcelExportQueueNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
                //------------------  Queue end --------------------//
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;AllApplicaionExcelExport&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }

        }
        function GenerateQDBRawExportExcel() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;

            var companyname = $(&quot;#CompanyNamePIES&quot;).val();
            companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var Tradingpartner = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;True&quot; : &quot;False&quot;;
                
            }
            var ACES = &quot;ACES&quot;;
            var Customer = 0;
            var ChkAlloverlap = 0;
            var SelectAllPartsxl = &quot;0&quot;;
            if ($(&quot;#overlapchk&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
            var ChkACESNotes = &quot;&quot;;
            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;exportFormat&quot;]:checked&quot; , &quot;'&quot; , &quot;).val() || &quot;4.2&quot;;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                ChkACESNotes = &quot;ACES with QDB Codes&quot;
            }
            else {
                Qualifierid = &quot;False&quot;;
                ChkACESNotes = &quot;ACES with Raw Notes&quot;
            }
            

            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;0&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var capitalcust = hdCapital;
            var IncludeCustomevalue = IncludeCustomValue;
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;ACESQDBRawNotesExcelExportQueueNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }
                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

                // -----------------End Queue Process ------------
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetACESQDBRawNotesExportNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

            }
        }
        function GenerateQDBRawExportCSV() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;

            var companyname = $(&quot;#CompanyNamePIES&quot;).val();
            companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var Tradingpartner = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;True&quot; : &quot;False&quot;;

            }
            var ACES = &quot;ACES&quot;;
            var Customer = 0;
            var ChkAlloverlap = 0;
            var SelectAllPartsxl = 0;
            if ($(&quot;#overlapchk&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
            var ChkACESNotes = &quot;&quot;;
            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;exportFormat&quot;]:checked&quot; , &quot;'&quot; , &quot;).val()||&quot;4.2&quot;;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                ChkACESNotes = &quot;ACES with QDB Codes&quot;
            }
            else {
                Qualifierid = &quot;False&quot;;
                ChkACESNotes = &quot;ACES with Raw Notes&quot;
            }


            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;0&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var capitalcust = hdCapital;
            var IncludeCustomevalue = IncludeCustomValue;
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;ACESQDBRawNotesExcelExportQueueNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }
                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

                // -----------------End Queue Process ------------
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetACESQDBRawNotesExportNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

            }
        }
        function openPopup() {
            event.preventDefault();
            $(&quot; , &quot;'&quot; , &quot;#modal_pop1&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#modal_pop1&quot;).dialog({
                width: 800,
                iframeFix: true,
                close: function () {
                    $(&quot; , &quot;'&quot; , &quot;.backgroud_fixed&quot; , &quot;'&quot; , &quot;).hide();
                },
                buttons: {
                    YES: function btnsave_Click() {
                        Checkoutputcustom();
                        $(this).dialog(&quot;close&quot;);
                    },
                    NO: function Direct_Click() {
                        GenerateACESXML();
                        $(this).dialog(&quot;close&quot;);
                    }
                }
            });

            return true;
        }
        function Checkoutputcustom() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var ExportType = hdExportType;
            var companyname = $(&quot;#CompanyName&quot;).val();
            if (typeof companyname === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companyname === null || companyname === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                companyname = ACompanyName;
            }
            var companycontact = $(&quot;#CompanyContact&quot;).val();
            if (typeof companycontact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companycontact === null || companycontact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                companycontact = ACompanyContact;
            }
            var txtEffectiveDate1 = $(&quot;#EffectiveDate&quot;).val();
            if (typeof txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtEffectiveDate1 === null || txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtEffectiveDate1 = AEffectiveDate;
            }
            var txtDocTitle = $(&quot; , &quot;'&quot; , &quot;#DocumentTitle&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtDocTitle === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocTitle === null || txtDocTitle === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtDocTitle = Adoctitle;
            }
            var cblapprovedfor = $(&quot; , &quot;'&quot; , &quot;#txtapprove&quot; , &quot;'&quot; , &quot;).val();
            if (typeof cblapprovedfor === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || cblapprovedfor === null || cblapprovedfor === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                cblapprovedfor = AApprovedfordata;
            }
            var txtSenderCompany = $(&quot; , &quot;'&quot; , &quot;#SenderCompany&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderCompany === null || txtSenderCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderCompany = ASenderCompany;
            }
            var txtSenderPhone = $(&quot; , &quot;'&quot; , &quot;#SenderPhone&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhone === null || txtSenderPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderPhone = ASenderPhone;
            }
            var txtSenderEmail = $(&quot; , &quot;'&quot; , &quot;#SenderEmail&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderEmail === null || txtSenderEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderEmail = Asenderemail;
            }
            var txtMapperCompany = $(&quot; , &quot;'&quot; , &quot;#MapperCompany&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperCompany === null || txtMapperCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperCompany = AMapperCompany;
            }
            var txtMapperPhone = $(&quot; , &quot;'&quot; , &quot;#MapperPhone&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhone === null || txtMapperPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperPhone = AMapperPhone;
            }
            var txtMapperEmail = $(&quot; , &quot;'&quot; , &quot;#MapperEmail&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperEmail === null || txtMapperEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperEmail = AMapperEmail;
            }
            var txtContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtContact === null || txtContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtContact = ASenderContact;
            }
            var drpSubmissionType = $(&quot;#SubmissionType option:selected&quot;).text();
            if (typeof drpSubmissionType === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || drpSubmissionType === null || drpSubmissionType === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                drpSubmissionType = &quot;FULL&quot;;
            }
            var txtDocFormNo = $(&quot; , &quot;'&quot; , &quot;#DocumentForm&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtDocFormNo === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocFormNo === null || txtDocFormNo === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtDocFormNo = ADocformnumber;
            }
            var txtSenderContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderContact === null || txtSenderContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderContact = ASenderContact;
            }
            var txtSenderPhoneExt = $(&quot; , &quot;'&quot; , &quot;#SenderPhoneExt&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhoneExt === null || txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderPhoneExt = Asenderphoneext;
            }
            var txtMapperContact = $(&quot; , &quot;'&quot; , &quot;#MapperContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperContact === null || txtMapperContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperContact = AMapperContact;
            }
            var txtMapperPhoneExt = $(&quot; , &quot;'&quot; , &quot;#MapperPhoneExt&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhoneExt === null || txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperPhoneExt = AMapperPhoneext;
            }
            if (hdbrand == &quot;false&quot;) {
                var BrandAAIAIDHeader = &quot;&quot;;
            }
            else {
                var BrandAAIAIDHeader = $(&quot;#txtbrandid&quot;).val();
                if (BrandAAIAIDHeader != &quot;&quot; &amp;&amp; BrandAAIAIDHeader.length &lt; 4) {
                    alert(&quot;Brand AAIAID must have 4 characters&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
                var regex = /^[a-zA-Z]+$/;
                if (!regex.test(BrandAAIAIDHeader)) {
                    alert(&quot;Invalid BrandID&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }

            var date = txtEffectiveDate1;
            //var txtEffectiveDate = &quot;&quot;;
            //txtEffectiveDate = (date.substr(6, 4) + &quot;-&quot; + date.substr(0, 2) + &quot;-&quot; + date.substr(3, 2));
            txtEffectiveDate = txtEffectiveDate1;


            var Qualifier = &quot;&quot;;
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifier = true;
            }
            else {
                Qualifier = false;
            }
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                alert(&quot;Please select Line&quot;);
                return false;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;True&quot; : &quot;False&quot;;
            }
            var ChkAlloverlap = 0;
            if ($(&quot;#overlapchk&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;group_header&quot;]:checked&quot; , &quot;'&quot; , &quot;).val() || &quot; , &quot;'&quot; , &quot;Both&quot; , &quot;'&quot; , &quot;;
            }
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var SelectAllPartsxl = &quot;0&quot;;
            if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var CustomerId = 0;
            var PartDescriptionId = PartTypeIds;
            var BrandIDs = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var makename = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;
            if (BrandIDs == &quot;&quot;) {
                alert(&quot;Please select Brand&quot;);
                return false;
            }
            if (companyname == &quot;&quot;) {
                alert(&quot;Please select  Company Name&quot;);
                return false;
            }
            if (companycontact == &quot;&quot;) {
                alert(&quot;Please select  Company Contact&quot;);
                return false;
            }
            if (date == &quot;&quot;) {
                alert(&quot;Please select Effective Date&quot;);
                return false;
            }
            if (txtDocTitle == &quot;&quot;) {
                alert(&quot;Please select Document Title&quot;);
                return false;
            }
            if (txtSenderPhone == &quot;&quot;) {
                alert(&quot;Please select Sender Phone&quot;);
                return false;
            }
            if (txtSenderContact == &quot;&quot;) {
                alert(&quot;Please select Sender Contact&quot;);
                return false;
            }
            if (txtContact == &quot;&quot;) {
                alert(&quot;Please select Company Contact &quot;);
                return false;
            }
            if (drpSubmissionType == &quot;0&quot;) {
                alert(&quot;Please select Submission Type &quot;);
                return false;
            }
            if (PartDescriptionId == &quot;&quot;) {
                alert(&quot;Please select atleast 1 Part Description(s)&quot;);
                return false;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                var Acesname = &quot;ACES with QDB Codes&quot;
            }
            else if (Process == &quot;ACESwithRawNote&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;ACES with Raw Notes&quot;
            }
            var ExporttoFTP = &quot;&quot;;
            var path = window.location.href.replace(window.location.hostname + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(window.location.protocol + &quot; , &quot;'&quot; , &quot;//&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(window.location.search, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(&quot; , &quot;'&quot; , &quot;:&quot; , &quot;'&quot; , &quot; + window.location.port, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;)
            var sitename = path.substring(0, path.indexOf(&quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;));
            if (sitename == &quot; , &quot;'&quot; , &quot;localhost&quot; , &quot;'&quot; , &quot;) {
                sitename = &quot;&quot;;
            }
            else if (sitename == &quot; , &quot;'&quot; , &quot;APAPMTTEST&quot; , &quot;'&quot; , &quot;) {
                sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
            }
            else if (sitename == &quot; , &quot;'&quot; , &quot;Youtechpmt&quot; , &quot;'&quot; , &quot;) {
                sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
            }
            else {
                //sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
                sitename = &quot;&quot;;
            }

            debugger
            var AcesExportVersion = &quot;&quot;;
            var ObjData = {
                &quot;Line&quot;: Line,
                &quot;Equipment&quot;: Equipment.toString(),
                &quot;Competitorid&quot;: Competitor,
                &quot;Unit&quot;: Units.toString(),
                &quot;comp&quot;: Comp.toString(),
                &quot;Tradingpartner&quot;: Tradingpartner,
                &quot;Brandname&quot;: BrandIDs,
                &quot;SubBrandName&quot;: BrandSubbrand,
                &quot;Productline&quot;: ProductLine,
                &quot;PartDescription&quot;: PartDescriptionId,
                &quot;SelectAllParts&quot;: SelectAllPartsxl,
                &quot;VehicleType&quot;: Vehicle,
                &quot;MakeId&quot;: makename,
                &quot;region&quot;: region,
                &quot;CompanyName&quot;: companyname,
                &quot;AdminId&quot;: AdminId,
                &quot;Contact&quot;: txtContact,
                &quot;EffectiveDate&quot;: txtEffectiveDate,
                &quot;drpSubmissionType&quot;: drpSubmissionType,
                &quot;DocTitle&quot;: txtDocTitle,
                &quot;DocFormNo&quot;: txtDocFormNo,
                &quot;Approvedfor&quot;: cblapprovedfor,
                &quot;SenderCompany&quot;: txtSenderCompany,
                &quot;SenderContact&quot;: txtSenderContact,
                &quot;SenderPhone&quot;: txtSenderPhone,
                &quot;SenderPhoneExt&quot;: txtSenderPhoneExt,
                &quot;SenderEmail&quot;: txtSenderEmail,
                &quot;MapperCompany&quot;: txtMapperCompany,
                &quot;MapperContact&quot;: txtMapperContact,
                &quot;MapperPhone&quot;: txtMapperPhone,
                &quot;MapperPhoneExt&quot;: txtMapperPhoneExt,
                &quot;MapperEmail&quot;: txtMapperEmail,
                &quot;BrandID&quot;: BrandAAIAIDHeader,
                &quot;Acesname&quot;: Acesname,
                &quot;strACES&quot;: &quot;Aces&quot;,
                &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                &quot;AcesOverpopulate&quot;: Overpopulate,
                &quot;ExporttoFTP&quot;: ExporttoFTP
            }
            //var ObjData = &quot; , &quot;'&quot; , &quot;{&quot;PartDescriptionId&quot;: &quot;&quot; , &quot;'&quot; , &quot; + PartDescription + &quot; , &quot;'&quot; , &quot;&quot;, &quot;ACES&quot;: &quot;ACES&quot;,&quot;SP&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Sp + &quot; , &quot;'&quot; , &quot;&quot;, &quot;CustomerId&quot;: &quot;&quot; , &quot;'&quot; , &quot; + CustomerId + &quot; , &quot;'&quot; , &quot;&quot;, &quot;LineNo&quot;: &quot;&quot; , &quot;'&quot; , &quot; + Line + &quot; , &quot;'&quot; , &quot;&quot;, &quot;Brandss&quot;: &quot;&quot; , &quot;'&quot; , &quot; + Brandssss + &quot; , &quot;'&quot; , &quot;&quot;,&quot;productliness&quot;: &quot;&quot; , &quot;'&quot; , &quot; + productliness + &quot; , &quot;'&quot; , &quot;&quot;, &quot;Vehicless&quot;: &quot;&quot; , &quot;'&quot; , &quot; + Vehicles + &quot; , &quot;'&quot; , &quot;&quot;, &quot;makenamess&quot;: &quot;&quot; , &quot;'&quot; , &quot; + makenames + &quot; , &quot;'&quot; , &quot;&quot;, &quot;companyname&quot;: &quot;&quot; , &quot;'&quot; , &quot; + companyname + &quot; , &quot;'&quot; , &quot;&quot;, &quot;txtEffectiveDate&quot;: &quot;&quot; , &quot;'&quot; , &quot; + txtEffectiveDate + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtDocTitle&quot;: &quot;&quot; , &quot;'&quot; , &quot; + txtDocTitle + &quot; , &quot;'&quot; , &quot;&quot;, &quot;cblapprovedfor&quot;: &quot;&quot; , &quot;'&quot; , &quot; + cblapprovedfor + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtSenderCompany&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtSenderCompany + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtSenderPhone&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtSenderPhone + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtSenderEmail&quot;: &quot;&quot; , &quot;'&quot; , &quot; + txtSenderEmail + &quot; , &quot;'&quot; , &quot;&quot;, &quot;txtMapperCompany&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtMapperCompany + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtMapperPhone&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtMapperPhone + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtMapperEmail&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtMapperEmail + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtContact&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtContact + &quot; , &quot;'&quot; , &quot;&quot;,&quot;drpSubmissionType&quot;:&quot;&quot; , &quot;'&quot; , &quot; + drpSubmissionType + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtDocFormNo&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtDocFormNo + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtSenderContact&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtSenderContact + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtMapperContact&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtMapperContact + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtMapperPhoneExt&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtMapperPhoneExt + &quot; , &quot;'&quot; , &quot;&quot;,&quot;Qualifier&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Qualifier + &quot; , &quot;'&quot; , &quot;&quot;,&quot;Competitor&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Competitor + &quot; , &quot;'&quot; , &quot;&quot;,&quot;TradingPartner&quot;:&quot;&quot; , &quot;'&quot; , &quot; + TradingPartner + &quot; , &quot;'&quot; , &quot;&quot;,&quot;Equipment&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Equipment + &quot; , &quot;'&quot; , &quot;&quot;,&quot;Class&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Classs + &quot; , &quot;'&quot; , &quot;&quot;,&quot;Acesname&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Acesname + &quot; , &quot;'&quot; , &quot;&quot;,&quot;ACESExportVersion&quot;:&quot;&quot; , &quot;'&quot; , &quot; + AcesExportVersion + &quot; , &quot;'&quot; , &quot;&quot;,&quot;BrandAAIAIDHeader&quot;:&quot;&quot; , &quot;'&quot; , &quot; + BrandAAIAIDHeader + &quot; , &quot;'&quot; , &quot;&quot;}&quot; , &quot;'&quot; , &quot;;
            var obj = 0;
            $.ajax({
                type: &quot;POST&quot;,
                async: false,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetsaveCustomexport&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(ObjData),
                dataType: &quot;JSON&quot;,
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    obj = response;
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return;
                },
                error: function () {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    alert(&quot;Failed!&quot;);
                    //$(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            });

            if (obj > 0) {
                //window.showModalDialog(&quot;/&quot; + sitename + &quot;/Reports/output.aspx&quot; + &quot;?Exportid=&quot; + obj, &quot;_blank&quot;, &quot;dialogWidth:700px; dialogHeight:550px; dialogLeft:450; dialogTop:200; center:1; status:0; help:0&quot;);
                window.open(&quot;../Reports/output.aspx&quot; + &quot;?Exportid=&quot; + obj, &quot;_blank&quot;, &quot;width=700,height=550,left=450,top=200,status=no,menubar=no,toolbar=no&quot;);
                //OpenPartNoPopupExportcustom(sitename + &quot; , &quot;'&quot; , &quot;Reports&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;output.aspx&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot; + PartDescription + &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, ExportType, Ecommerece, Sp, CustomerId, Line, Brandssss, productliness, Vehicles, makenames, companyname, txtEffectiveDate, txtDocTitle, cblapprovedfor, txtSenderCompany, txtSenderPhone, txtSenderEmail, txtMapperCompany, txtMapperPhone, txtMapperEmail, txtContact, drpSubmissionType, txtDocFormNo, txtSenderContact, txtMapperContact, txtMapperPhoneExt, Qualifier, &quot; , &quot;'&quot; , &quot;700&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;550&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;450&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;200&quot; , &quot;'&quot; , &quot;, Competitor, TradingPartner, Equipment, Classs, Acesname, AcesExportVersion, BrandAAIAIDHeader);
            }
            return true;
            ClosePopUp();

        }
        function GenerateACESXML() {
            var companyname = $(&quot;#CompanyName&quot;).val();
            if (typeof companyname === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companyname === null || companyname === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                companyname = ACompanyName;
            }
            var txtEffectiveDate1 = $(&quot;#EffectiveDate&quot;).val();
            if (typeof txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtEffectiveDate1 === null || txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtEffectiveDate1 = AEffectiveDate;
            }
            var txtDocTitle = $(&quot; , &quot;'&quot; , &quot;#DocumentTitle&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtDocTitle === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocTitle === null || txtDocTitle === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtDocTitle = Adoctitle;
            }
            var cblapprovedfor = $(&quot; , &quot;'&quot; , &quot;#txtapprove&quot; , &quot;'&quot; , &quot;).val();
            if (typeof cblapprovedfor === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || cblapprovedfor === null || cblapprovedfor === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                cblapprovedfor = AApprovedfordata;
            }
            var txtSenderCompany = $(&quot; , &quot;'&quot; , &quot;#SenderCompany&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderCompany === null || txtSenderCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderCompany = ASenderCompany;
            }
            var txtSenderPhone = $(&quot; , &quot;'&quot; , &quot;#SenderPhone&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhone === null || txtSenderPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderPhone = ASenderPhone;
            }
            var txtSenderEmail = $(&quot; , &quot;'&quot; , &quot;#SenderEmail&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderEmail === null || txtSenderEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderEmail = Asenderemail;
            }
            var txtMapperCompany = $(&quot; , &quot;'&quot; , &quot;#MapperCompany&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperCompany === null || txtMapperCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperCompany = AMapperCompany;
            }
            var txtMapperPhone = $(&quot; , &quot;'&quot; , &quot;#MapperPhone&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhone === null || txtMapperPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperPhone = AMapperPhone;
            }
            var txtMapperEmail = $(&quot; , &quot;'&quot; , &quot;#MapperEmail&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperEmail === null || txtMapperEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperEmail = AMapperEmail;
            }
            var txtContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtContact === null || txtContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtContact = ASenderContact;
            }
            var drpSubmissionType = $(&quot;#SubmissionType option:selected&quot;).text();
            if (typeof drpSubmissionType === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || drpSubmissionType === null || drpSubmissionType === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                drpSubmissionType = &quot;FULL&quot;;
            }
            var txtDocFormNo = $(&quot; , &quot;'&quot; , &quot;#DocumentForm&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtDocFormNo === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocFormNo === null || txtDocFormNo === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtDocFormNo = ADocformnumber;
            }
            var txtSenderContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderContact === null || txtSenderContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderContact = ASenderContact;
            }
            var txtSenderPhoneExt = $(&quot; , &quot;'&quot; , &quot;#SenderPhoneExt&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhoneExt === null || txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderPhoneExt = Asenderphoneext;
            }
            var txtMapperContact = $(&quot; , &quot;'&quot; , &quot;#MapperContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperContact === null || txtMapperContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperContact = AMapperContact;
            }
            var txtMapperPhoneExt = $(&quot; , &quot;'&quot; , &quot;#MapperPhoneExt&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhoneExt === null || txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperPhoneExt = AMapperPhoneext;
            }
            if (hdbrand == &quot;false&quot;) {
                var BrandAAIAIDHeader = &quot;&quot;;
            }
            else {
                var BrandAAIAIDHeader = $(&quot;#txtbrandid&quot;).val();
                if (BrandAAIAIDHeader != &quot;&quot; &amp;&amp; BrandAAIAIDHeader.length &lt; 4) {
                    alert(&quot;Brand AAIAID must have 4 characters&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
                var regex = /^[a-zA-Z]+$/;
                if (!regex.test(BrandAAIAIDHeader)) {
                    alert(&quot;Invalid BrandID&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }

            var date = txtEffectiveDate1;
            //var txtEffectiveDate = &quot;&quot;;
            //txtEffectiveDate = (date.substr(6, 4) + &quot;-&quot; + date.substr(0, 2) + &quot;-&quot; + date.substr(3, 2));
            txtEffectiveDate = txtEffectiveDate1;

            var Qualifier = &quot;&quot;;
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifier = &quot;true&quot;;
            }
            else {
                Qualifier = &quot;false&quot;;
            }
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                alert(&quot;Please select Line&quot;);
                return false;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;True&quot; : &quot;False&quot;;
            }
            var ChkAlloverlap = 0;
            if ($(&quot;#overlapchk&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
            var exportFormat = &quot;&quot;
            exportFormat = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;exportFormat&quot;]:checked&quot; , &quot;'&quot; , &quot;).val() || &quot;4.2&quot;;

            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;group_header&quot;]:checked&quot; , &quot;'&quot; , &quot;).val() || &quot; , &quot;'&quot; , &quot;Both&quot; , &quot;'&quot; , &quot;;
            }
            var Tradingpartner = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            if (Tradingpartner == undefined) {
                Tradingpartner = &quot;0&quot;;
            }
            if (Overpopulate == undefined) {
                Overpopulate = &quot;&quot;;
            }
            var SelectAllPartsxl = &quot;0&quot;;
            if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var CustomerId = 0;
            var PartDescriptionId = PartTypeIds;
            var BrandIDs = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var makename = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;
            if (BrandIDs == &quot;&quot;) {
                alert(&quot;Please select Brand&quot;);
                return false;
            }
            if (companyname == &quot;&quot;) {
                alert(&quot;Please select  Company Name&quot;);
                return false;
            }
            if (date == &quot;&quot;) {
                alert(&quot;Please select Effective Date&quot;);
                return false;
            }
            if (txtDocTitle == &quot;&quot;) {
                alert(&quot;Please select Document Title&quot;);
                return false;
            }
            if (txtSenderPhone == &quot;&quot;) {
                alert(&quot;Please select Sender Phone&quot;);
                return false;
            }
            if (txtSenderContact == &quot;&quot;) {
                alert(&quot;Please select Sender Contact&quot;);
                return false;
            }
            if (txtContact == &quot;&quot;) {
                alert(&quot;Please select Company Contact &quot;);
                return false;
            }
            if (drpSubmissionType == &quot;0&quot;) {
                alert(&quot;Please select Submission Type &quot;);
                return false;
            }
            if (PartDescriptionId == &quot;&quot;) {
                alert(&quot;Please select atleast 1 Part Description(s)&quot;);
                return false;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                var Acesname = &quot;ACES with QDB Codes&quot;
            }
            else if (Process == &quot;ACESwithRawNote&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;ACES with Raw Notes&quot;
            }
            else if (Process == &quot;Amazon&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;Amazon&quot;
            }
            else if (Process == &quot;Walmart&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;Walmart&quot;
            }

            if (ExportFTP == &quot;Yes&quot;) {
                var ExporttoFTP = &quot;Yes&quot;;
            }
            else {
                var ExporttoFTP = &quot;&quot;;
            }

            var _data = {
                &quot;Line&quot;: Line,
                &quot;Equipment&quot;: Equipment.toString(),
                &quot;Competitorid&quot;: Competitor,
                &quot;Unit&quot;: Units.toString(),
                &quot;comp&quot;: Comp.toString(),
                &quot;Tradingpartner&quot;: Tradingpartner,
                &quot;Brandname&quot;: BrandIDs,
                &quot;SubBrandName&quot;: BrandSubbrand,
                &quot;Productline&quot;: ProductLine,
                &quot;PartDescription&quot;: PartDescriptionId,
                &quot;SelectAllParts&quot;: SelectAllPartsxl,
                &quot;VehicleType&quot;: Vehicle,
                &quot;MakeId&quot;: makename,
                &quot;region&quot;: region,
                &quot;CompanyName&quot;: companyname,
                &quot;AdminId&quot;: AdminId,
                &quot;Contact&quot;: txtContact,
                &quot;EffectiveDate&quot;: txtEffectiveDate,
                &quot;drpSubmissionType&quot;: drpSubmissionType,
                &quot;DocTitle&quot;: txtDocTitle,
                &quot;DocFormNo&quot;: txtDocFormNo,
                &quot;Approvedfor&quot;: cblapprovedfor,
                &quot;SenderCompany&quot;: txtSenderCompany,
                &quot;SenderContact&quot;: txtSenderContact,
                &quot;SenderPhone&quot;: txtSenderPhone,
                &quot;SenderPhoneExt&quot;: txtSenderPhoneExt,
                &quot;SenderEmail&quot;: txtSenderEmail,
                &quot;MapperCompany&quot;: txtMapperCompany,
                &quot;MapperContact&quot;: txtMapperContact,
                &quot;MapperPhone&quot;: txtMapperPhone,
                &quot;MapperPhoneExt&quot;: txtMapperPhoneExt,
                &quot;MapperEmail&quot;: txtMapperEmail,
                &quot;BrandID&quot;: BrandAAIAIDHeader,
                &quot;Acesname&quot;: Acesname,
                &quot;strACES&quot;: &quot;Aces&quot;,
                &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                &quot;AcesOverpopulate&quot;: Overpopulate,
                &quot;ExporttoFTP&quot;: ExporttoFTP,
                &quot;exportFormat&quot;: exportFormat,
                &quot;Qualifier&quot;: Qualifier,
                &quot;customizedflag&quot;: customizedflag
            }
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            if (ACESPIESQueue == &quot;true&quot;) {
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveAcesExportxmldataNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {

                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function (err) {
                        console.log(err);
                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }
            else {
                var dataxml = {
                    &quot;acespies&quot;: &quot;Aces&quot;,
                }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;queuecheckxmlPermission&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(dataxml),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        if (response == &quot; , &quot;'&quot; , &quot;&quot;Yes&quot;&quot; , &quot;'&quot; , &quot;) {
                            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                            alert(&quot;An XML file creation is in progress for another user. Please try after some time.&quot;);
                        }
                        else {
                            $.ajax({
                                type: &quot;POST&quot;,
                                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetAcesExportxmldataNew&quot; , &quot;'&quot; , &quot;,
                                data: JSON.stringify(_data),
                                contentType: &quot;application/json; charset=utf-8&quot;,
                                success: function (response) {
                                    debugger
                                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                    var data = JSON.parse(response);
                                    var count = data.Count;
                                    var name = data.Name;
                                    var result = data.Result;
                                    var services = Acesname;
                                    var rbb = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;exportFormat&quot;]:checked&quot; , &quot;'&quot; , &quot;).val();
                                    if (rbb == &quot;&quot; &amp;&amp; rbb == undefined) {
                                        rbb = &quot;4.2&quot;;
                                    }
                                    const sanitizedName = name.replace(/[^a-zA-Z0-9-_ ]+/g, &quot;&quot;);
                                    const fullURL = `downloadAcesXml.aspx?Aces=${services}&amp;company=${sanitizedName}&amp;Qualifier=${Qualifier}&amp;Equipment=${Equipment}&amp;ExportFormat=${rbb}`;
                                    if (count != &quot;0&quot;) {
                                        if (result == &quot;Success&quot;) {
                                            window.open(fullURL, &quot; , &quot;'&quot; , &quot;_blank&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px&quot; , &quot;'&quot; , &quot;);
                                        }
                                        else {
                                            alert(&quot;Run Api mode contact administator&quot;);
                                        }
                                    }
                                    else {
                                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                        alert(&quot;There is no data for this criteria&quot;);
                                    }

                                },
                                error: function () {

                                    alert(&quot;Failed!&quot;)
                                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                }
                            })
                        }
                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                return false;
            }
        }
        function specificspecialchar(e) {
            var k = e.keyCode == 0 ? e.charCode : e.keyCode;
            if ((k > 64 &amp;&amp; k &lt; 91) || (k > 96 &amp;&amp; k &lt; 123) || k == 8 || k == 32 || (k >= 48 &amp;&amp; k &lt;= 57)) {
                return true;
            }
            else {
                return false;
            }
        }
        function handlePaste(e) {
            var clipboardData = event.clipboardData || window.clipboardData;
            var pastedData = clipboardData.getData(&quot; , &quot;'&quot; , &quot;Text&quot; , &quot;'&quot; , &quot;);

            var prohibitedChars = [&quot;;&quot;, &quot;[&quot;, &quot;]&quot;, &quot;{&quot;, &quot;}&quot;, &quot;~&quot;, &quot;|&quot;, &quot;,&quot;, &quot;\&quot;&quot;, &quot;%&quot;, &quot;!&quot;, &quot;@&quot;, &quot;#&quot;, &quot;^&quot;, &quot;&amp;&quot;, &quot;(&quot;, &quot;)&quot;, &quot;,&quot;, &quot;.&quot;, &quot;/&quot;, &quot;:&quot;, &quot;+&quot;, &quot;-&quot;, &quot;_&quot;, &quot;=&quot;, &quot;$&quot;, &quot;*&quot;, &quot;?&quot;, &quot;&quot; , &quot;'&quot; , &quot;&quot;];
            for (var i = 0; i &lt; prohibitedChars.length; i++) {
                if (pastedData.includes(prohibitedChars[i])) {
                    event.preventDefault();
                    Swal.fire({
                        icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                        text: &quot;Pasted Value has Restricted Special Characters&quot;,
                        allowOutsideClick: false,
                        allowEscapeKey: false,
                    });
                    return false;
                }
            }
            return true;
        }
        function Checknewexport() {
            debugger
            var PartDescriptionId = PartTypeIds;
            var BrandIDs = BrandIds;
            var productlines = SubPLine;
            var ExportType = hdExportType;
            var Ecommerece = Services;
            
            var Trading = &quot;0&quot;;
            if (Services == &quot; , &quot;'&quot; , &quot;ACES&quot; , &quot;'&quot; , &quot;) {
                if (TradingPartnerwebconfig == &quot;true&quot;) {
                    var Trading = $(&quot;#drptradingpartner option:selected&quot;).val();
                }
                else {
                    var Trading = &quot;0&quot;;
                }
            }

            if (ExportType != &quot; , &quot;'&quot; , &quot;Ebay&quot; , &quot;'&quot; , &quot;) {
                var Line = $(&quot;#DrpLine option:selected&quot;).val();
                if (Line == &quot;&quot;) {
                    alert(&quot;Please Select Line !!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (ExportType == &quot; , &quot;'&quot; , &quot;Services&quot; , &quot;'&quot; , &quot;) {
                ExportType = &quot;ACES&quot;
                if (TradingPartnerwebconfig == &quot;true&quot;) {
                    var Trading = $(&quot;#drptradingpartner option:selected&quot;).val();
                }
                else {
                    var Trading = &quot;0&quot;;
                }
            }
            if (ExportType == &quot; , &quot;'&quot; , &quot;Network&quot; , &quot;'&quot; , &quot;) {
                ExportType = &quot;ACES&quot;
            }
            if (ExportType == &quot; , &quot;'&quot; , &quot;Walmart&quot; , &quot;'&quot; , &quot;) {
                ExportType = &quot;ACES&quot;
            }  

            var Sp = &quot;&quot;;
            var Competitor = &quot;0&quot;;
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;True&quot; : &quot;False&quot;;
            }
            var CustomerId = 0;
            var counter = 0;
            var PartDescription = PartDescriptionId.replace(/(^[,\s]+)|([,\s]+$)/g, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);
            var productliness = productlines.replace(/(^[,\s]+)|([,\s]+$)/g, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);
            
            PartDescription = &quot;&quot;;
            var Brandssss = BrandIDs.replace(/(^[,\s]+)|([,\s]+$)/g, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);

            var path = window.location.href.replace(window.location.hostname + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(window.location.protocol + &quot; , &quot;'&quot; , &quot;//&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(window.location.search, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(&quot; , &quot;'&quot; , &quot;:&quot; , &quot;'&quot; , &quot; + window.location.port, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;)
            var sitename = path.substring(0, path.indexOf(&quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;));
            if (sitename == &quot; , &quot;'&quot; , &quot;localhost&quot; , &quot;'&quot; , &quot;) {
                sitename = &quot;&quot;;
            }
            else if (sitename == &quot; , &quot;'&quot; , &quot;APAPMTTEST&quot; , &quot;'&quot; , &quot;) {
                sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
            }
            else if (sitename == &quot; , &quot;'&quot; , &quot;Youtechpmt&quot; , &quot;'&quot; , &quot;) {
                sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
            }
            else {
                //sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
                sitename = &quot;&quot;;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var AdminGroupID = &quot; , &quot;'&quot; , &quot;6&quot; , &quot;'&quot; , &quot;;
            debugger
            OpenPartNoPopupExportcustom(sitename + &quot; , &quot;'&quot; , &quot;Parts&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;ViewPartsExport.aspx&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot; + PartDescription + &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, ExportType, Ecommerece, Sp, Competitor, Line, Brandssss, productliness, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;700&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;550&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;450&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;200&quot; , &quot;'&quot; , &quot;, Competitor, Trading, Equipment, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, AdminGroupID);

            return true;
        }
        function generateopticat() {
            debugger
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == &quot;&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            $(&quot;#MainContent_hdlinecode&quot;).val(Line);
            if (Process == &quot;PIES&quot;) {
                var companyname = $(&quot;#CompanyNamePIES&quot;).val().trim();
                companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
                if (typeof companyname === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companyname === null || companyname === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    companyname = PCompany;
                }
                var Pla = $(&quot;#PLA&quot;).val().trim();
                if (typeof Pla === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || Pla === null || Pla === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    Pla = PPLA || &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                }
                var VendorNumber = $(&quot;#Vendor&quot;).val();
                if (typeof VendorNumber === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || VendorNumber === null || VendorNumber === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    VendorNumber = PVendorNumber;
                }
                var ContactPies = $(&quot;#ContactName&quot;).val();
                ContactPies = ContactPies.replace(/[&lt;>]/ig, &quot;&quot;);
                if (typeof ContactPies === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || ContactPies === null || ContactPies === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    ContactPies = PContactName;
                }
                var Email = $(&quot;#ContactEmail&quot;).val();
                if (typeof Email === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || Email === null || Email === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    Email = PContactEmail;
                }
                var EDate = $(&quot;#PIESEffectiveDate&quot;).val();
                if (typeof EDate === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || EDate === null || EDate === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    EDate = PBlanketEffectiveDate;
                }
                var PriceSheetNum = $(&quot;#PriceSheet&quot;).val();
                if (typeof PriceSheetNum === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || PriceSheetNum === null || PriceSheetNum === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    PriceSheetNum = PPriceSheetNum;
                }
                $(&quot;#MainContent_hdtxtCompanyName&quot;).val(companyname);
                $(&quot;#MainContent_hdtxtParent&quot;).val(&quot;&quot;);
                $(&quot;#MainContent_hdtxtBrand&quot;).val(&quot;&quot;);
                $(&quot;#MainContent_hdtxtContactPies&quot;).val(ContactPies);
                $(&quot;#MainContent_hdtxtEmail&quot;).val(Email);
                $(&quot;#MainContent_hdtxtPla&quot;).val(Pla);
                $(&quot;#MainContent_hdtxtVendorNumber&quot;).val(VendorNumber);
                $(&quot;#MainContent_hdtxtPriceSheetNum&quot;).val(PriceSheetNum);
                $(&quot;#MainContent_hdtxtEDate&quot;).val(EDate);
                var Competitor = $(&quot;#drpinterchange1&quot;).val();
                if (Competitor == &quot;&quot; || Competitor == undefined) {
                    Competitor = &quot;0&quot;;
                }
                $(&quot;#MainContent_hddrpCustomer&quot;).val(Competitor);
                $(&quot;#MainContent_Opticatpies1&quot;).click();
            }
            else {
                var companyname = $(&quot;#CompanyName&quot;).val();
                if (typeof companyname === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companyname === null || companyname === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    companyname = ACompanyName;
                }
                var txtEffectiveDate1 = $(&quot;#EffectiveDate&quot;).val();
                if (typeof txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtEffectiveDate1 === null || txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtEffectiveDate1 = AEffectiveDate;
                }
                var txtDocTitle = $(&quot; , &quot;'&quot; , &quot;#DocumentTitle&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtDocTitle === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocTitle === null || txtDocTitle === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtDocTitle = Adoctitle;
                }
                var cblapprovedfor = $(&quot; , &quot;'&quot; , &quot;#txtapprove&quot; , &quot;'&quot; , &quot;).val();
                if (typeof cblapprovedfor === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || cblapprovedfor === null || cblapprovedfor === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    cblapprovedfor = AApprovedfordata;
                }
                var txtSenderCompany = $(&quot; , &quot;'&quot; , &quot;#SenderCompany&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtSenderCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderCompany === null || txtSenderCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtSenderCompany = ASenderCompany;
                }
                var txtSenderPhone = $(&quot; , &quot;'&quot; , &quot;#SenderPhone&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtSenderPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhone === null || txtSenderPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtSenderPhone = ASenderPhone;
                }
                var txtSenderEmail = $(&quot; , &quot;'&quot; , &quot;#SenderEmail&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtSenderEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderEmail === null || txtSenderEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtSenderEmail = Asenderemail;
                }
                var txtMapperCompany = $(&quot; , &quot;'&quot; , &quot;#MapperCompany&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtMapperCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperCompany === null || txtMapperCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtMapperCompany = AMapperCompany;
                }
                var txtMapperPhone = $(&quot; , &quot;'&quot; , &quot;#MapperPhone&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtMapperPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhone === null || txtMapperPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtMapperPhone = AMapperPhone;
                }
                var txtMapperEmail = $(&quot; , &quot;'&quot; , &quot;#MapperEmail&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtMapperEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperEmail === null || txtMapperEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtMapperEmail = AMapperEmail;
                }
                var txtContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtContact === null || txtContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtContact = ASenderContact;
                }
                var drpSubmissionType = $(&quot;#SubmissionType option:selected&quot;).text();
                if (typeof drpSubmissionType === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || drpSubmissionType === null || drpSubmissionType === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    drpSubmissionType = &quot;FULL&quot;;
                }
                var txtDocFormNo = $(&quot; , &quot;'&quot; , &quot;#DocumentForm&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtDocFormNo === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocFormNo === null || txtDocFormNo === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtDocFormNo = ADocformnumber;
                }
                var txtSenderContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtSenderContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderContact === null || txtSenderContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtSenderContact = ASenderContact;
                }
                var txtSenderPhoneExt = $(&quot; , &quot;'&quot; , &quot;#SenderPhoneExt&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhoneExt === null || txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtSenderPhoneExt = Asenderphoneext;
                }
                var txtMapperContact = $(&quot; , &quot;'&quot; , &quot;#MapperContact&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtMapperContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperContact === null || txtMapperContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtMapperContact = AMapperContact;
                }
                var txtMapperPhoneExt = $(&quot; , &quot;'&quot; , &quot;#MapperPhoneExt&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhoneExt === null || txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtMapperPhoneExt = AMapperPhoneext;
                }
                if (hdbrand == &quot;false&quot;) {
                    var BrandAAIAIDHeader = &quot;&quot;;
                }
                else {
                    var BrandAAIAIDHeader = $(&quot;#txtbrandid&quot;).val();
                    if (BrandAAIAIDHeader != &quot;&quot; &amp;&amp; BrandAAIAIDHeader.length &lt; 4) {
                        alert(&quot;Brand AAIAID must have 4 characters&quot;);
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        return false;
                    }
                    var regex = /^[a-zA-Z]+$/;
                    if (!regex.test(BrandAAIAIDHeader)) {
                        alert(&quot;Invalid BrandID&quot;);
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        return false;
                    }
                }

                var date = txtEffectiveDate1;
                //var txtEffectiveDate = &quot;&quot;;
                //txtEffectiveDate = (date.substr(6, 4) + &quot;-&quot; + date.substr(0, 2) + &quot;-&quot; + date.substr(3, 2));
                txtEffectiveDate = txtEffectiveDate1;

                $(&quot;#MainContent_hdtxtCompany&quot;).val(companyname);
                $(&quot;#MainContent_hdtxtContact&quot;).val(txtContact);
                $(&quot;#MainContent_hdtxtEffectiveDate&quot;).val(txtEffectiveDate);
                $(&quot;#MainContent_hdtxtDocTitle&quot;).val(txtDocTitle);
                $(&quot;#MainContent_hdtxtDocFormNo&quot;).val(txtDocFormNo);
                $(&quot;#MainContent_hdtxtApprovedfor&quot;).val(cblapprovedfor);
                $(&quot;#MainContent_hdtxtSenderCompany&quot;).val(txtSenderCompany);
                $(&quot;#MainContent_hdtxtSenderContact&quot;).val(txtSenderContact);
                $(&quot;#MainContent_hdtxtSenderPhone&quot;).val(txtSenderPhone);
                $(&quot;#MainContent_hdtxtSenderEmail&quot;).val(txtSenderEmail);
                $(&quot;#MainContent_hdtxtMapperCompany&quot;).val(txtMapperCompany);
                $(&quot;#MainContent_hdtxtMapperContact&quot;).val(txtMapperContact);
                $(&quot;#MainContent_hdtxtMapperPhone&quot;).val(txtMapperPhone);
                $(&quot;#MainContent_hdtxtMapperPhoneExt&quot;).val(txtMapperPhoneExt);
                $(&quot;#MainContent_hdtxtMapperEmail&quot;).val(txtMapperEmail);
                $(&quot;#MainContent_hdtxtBrandID&quot;).val(BrandAAIAIDHeader);
                var Competitor = $(&quot;#drpinterchange1&quot;).val();
                if (Competitor == &quot;&quot; || Competitor == undefined) {
                    Competitor = &quot;0&quot;;
                }
                $(&quot;#MainContent_hddrpCustomer&quot;).val(Competitor);
                $(&quot;#MainContent_Opticataces1&quot;).click();
            }
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
        }
        function Generate_All_ApplicationExportBasedMfrBrandId_csv() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var _data = {
                &quot;AdminId&quot;: AdminId,
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveAcesAllApplicationExportCSVdata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            })
        }
        function Generate_PiesExcelExportBasedMfrBrand() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: &quot; , &quot;'&quot; , &quot;PIES&quot; , &quot;'&quot; , &quot;
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SavePiesExcelExportdata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            })
        }
        function Generate_PiesXMLExportBasedMfrBrand() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: &quot; , &quot;'&quot; , &quot;PIES&quot; , &quot;'&quot; , &quot;
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SavePiesXMLExportdata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            })
        }
        function Generate_AllProdLineAcesQdbCodeXML() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();

            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: &quot; , &quot;'&quot; , &quot;ACES with QDB Codes&quot; , &quot;'&quot; , &quot;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveAcesQdbCodeXMLdata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            })
        }
        function Generate_AllProdLineAcesRawNotesXML() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();

            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: &quot; , &quot;'&quot; , &quot;ACES with Raw Notes&quot; , &quot;'&quot; , &quot;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveAcesQdbCodeXMLdata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            })
        }
        function GenerateEbayExcel() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var Partdes = PartTypeIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var region = RegionIds;
            var partdescription = Partdes.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;);
            var Name = &quot;&quot;;
            var storeid = $(&quot;#DrpEbay&quot;).val();
            if (partdescription.length > 1) {
                Name = PMTName + &quot;_&quot; + &quot;Products_&quot;;
            }
            else {
                Name = PMTName + &quot;_&quot; + partdescription;
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (storeid == &quot;&quot;) {
                alert(&quot;Please select storeid&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            var _data = {
                &quot;MakeId&quot;: Make,
                &quot;PartDescription&quot;: Partdes,
                &quot;VehicleType&quot;: Vehicle,
                &quot;region&quot;: region,
                &quot;Storeid&quot;: storeid,
                &quot;AdminId&quot;: AdminId
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveEbayExportExcel&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {

                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function (err) {
                        console.log(err);
                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }
            else {
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GenerateEbayExportExcel&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var data = JSON.parse(response);
                        var count = data.Count;
                        var result = data.Result;
                        const fullURL = `downloadebayExcel.aspx?Services= Download`;
                        if (count != &quot;0&quot;) {
                            if (result == &quot;Success&quot;) {
                                window.open(fullURL, &quot; , &quot;'&quot; , &quot;_blank&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px&quot; , &quot;'&quot; , &quot;);
                            }
                            else {
                                alert(&quot;Run Api mode contact administator&quot;);
                            }
                        }
                        else {
                            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                            alert(&quot;There is no data for this criteria&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

            }


        }
    
    
        
            
                Export Data : Select the format you like to export
            
        
        
            
                * Excel/XML will contain information of Parts selected in the respective Parts Export Page. By default when a Part is created in PMT is selected for Export
            
        
    
    
        
            
                
                All Applications
            
            
                
                ACES with QDB Codes
            
            
                
                ACES with Raw Notes
            
            
                
                ACES Invalid
            
            
                
                ACES with Raw Notes and Attribute Invalids
            
            
                
                PIES
            
            
                
                Compatibility
            
            
                
                ACES
            
            
                
            
            
                
            
            
            
        
    
    
        
            
                Line *
                -SELECT-ALL1234 | mani testAmazonBasics |  KTM Sportmotorcycle GmbHAuto | AutomateBBBB | 3MBBHN |  KTM Sportmotorcycle GmbHBDBC |  KTM Sportmotorcycle GmbHBDFL | Air Pro/Maritta RadiatorBDGB |  AGS CompanyBDGS | AP Emissions TechnologiesBDJK | Automann USA IncBDLK | Gates CorporationBDLV | Robert Bosch LLCBDMB | Brembo SpABDMR | Buyers Products CompanyBDNL | Cambro Products IncBDPV | Charter V-BeltsBDPZ | Chicago RawhideBDRB | Cooper Tire &amp; Rubber CompanyBDRQ | CRC Industries IncBDTG | Donaldson Company IncBDVG | East Penn Manufacturing Company IncBDWL | Stryten EnergyBFCN | Grote IndustriesBFCZ |  KTM Sportmotorcycle GmbHBFFD | SAF-HOLLAND GroupBFFX | Interstate BatteriesBFHC | KD Lamp CompanyBFLP | Meritor IncBFNQ | Muncie Power ProductsBFRX | PermatexBFSB | Peterson Manufacturing CompanyBFTR | BendixBGBN | Sealco Air ControlBGDK | Standard Motor Products IncBGDS | Stemco IncBGGK | The Timken CompanyBGKG | Velvac IncBGLB | DRiV IncorporatedBGMG | Dana IncorporatedBHLZ | RatechBHWM | EBC Brakes USABKMG |  KTM Sportmotorcycle GmbHBKQD | WABCO Holdings IncBQWN | BagshawBXXS | Consolidated Metco IncCBXN | CumminsCDFX | Dexter Axle CompanyCJFL | FergusonCKTK | GSLCPCM | Marmon Holdings IncCPDN | Hutchens IndustriesCRBF | EZ Ziegler Carparts GmbH &amp; CoCRDW | HendricksonCRWK | Larson SystemsCTQN | RycoCTRD | SafewayCVKW | Thermo-KingCWFP | Horizon Brands LLCCWJD | ZF Friedrichshafen AGDMGT | TectranDMJM | Shur-Co CorporationDNVX | Illusions IncDPFJ | Milwaukee Electric Tool CorporationDTTX | NEAPCO LLCDWBR | Hoosier TankDWFB | Midwest Truck &amp; Auto Parts IncDWJB | Kinedyne LLCDXGH | Sirco IndustriesDXJK | TramecECA |  KTM Sportmotorcycle GmbHECAT | ECATFBBB |  KTM Sportmotorcycle GmbHFBHL | CTEK IncFFHT | Lippert ComponentsFJTW | Henkel CorporationFMBL | StyluzFMCT | CarParts.com IncFMGV |  KTM Sportmotorcycle GmbHFMWN | Scrubblade IncFNSL | Willpak Industries IncFSTX |  KTM Sportmotorcycle GmbHGCPV |  KTM Sportmotorcycle GmbHGFVN | Globetech ManufacturingGJFQ | Grand Rock Co IncGJKV | Car Sound Exhaust System IncGKQK | Terminal Supply CompanyGNTG | Phillips IndustriesGNXP | Ms Carita SafeTruck IncGPNH |  KTM Sportmotorcycle GmbHGTQB | KTM Sportmotorcycle GmbHHDA6 |  KTM Sportmotorcycle GmbHHGFJ | Myers Engineering IncHGYW | Dailey EngineeringHHDL | The Miner CorporationHHGG |  KTM Sportmotorcycle GmbHHHRS | Bezares SAHJMF | BettsHDHLBS |  KTM Sportmotorcycle GmbHHLNC |  KTM Sportmotorcycle GmbHHLYF | Sensata TechnologiesHNDT | Tramec Sloan LLCHQBF | Eiko North AmericaHSYH |  KTM Sportmotorcycle GmbHHTHF |  KTM Sportmotorcycle GmbHHVZQ |  KTM Sportmotorcycle GmbHHWGV |  KTM Sportmotorcycle GmbHHWGW | First Brands GroupHWHT |  KTM Sportmotorcycle GmbHHWJL |  KTM Sportmotorcycle GmbHHWKC | BorgWarner IncHWSL |  KTM Sportmotorcycle GmbHHWTQ |  KTM Sportmotorcycle GmbHHWWX | REV Group IncHYYW | Archived BrandsHZRJ | Webb Wheel Products IncHZSM |  KTM Sportmotorcycle GmbHJBRH |  KTM Sportmotorcycle GmbHJBXC | Weitron IncJBZM |  KTM Sportmotorcycle GmbHJDSR |  KTM Sportmotorcycle GmbHJFVK |  KTM Sportmotorcycle GmbHJGWM |  KTM Sportmotorcycle GmbHJHTD |  KTM Sportmotorcycle GmbHJHWD |  KTM Sportmotorcycle GmbHJJBY | JOST InternationalJJLJ |  KTM Sportmotorcycle GmbHJJQM |  KTM Sportmotorcycle GmbHJJVN |  KTM Sportmotorcycle GmbHJJWG |  KTM Sportmotorcycle GmbHJJXP |  KTM Sportmotorcycle GmbHJKJT |  KTM Sportmotorcycle GmbHJKLP |  KTM Sportmotorcycle GmbHJKSH | ATRO Engineered Systems IncJLNV |  KTM Sportmotorcycle GmbHJLRV |  KTM Sportmotorcycle GmbHJNE | JNEJNFJ |  KTM Sportmotorcycle GmbHJNGN |  KTM Sportmotorcycle GmbHJNTR |  KTM Sportmotorcycle GmbHJNVY |  KTM Sportmotorcycle GmbHJPCZ |  KTM Sportmotorcycle GmbHJPDC |  KTM Sportmotorcycle GmbHJPHL |  KTM Sportmotorcycle GmbHJPJZ | Maxiforce IncJPMK |  KTM Sportmotorcycle GmbHJRTR |  KTM Sportmotorcycle GmbHJRYR |  KTM Sportmotorcycle GmbHJSXZ |  KTM Sportmotorcycle GmbHJTBH |  KTM Sportmotorcycle GmbHJTFR |  KTM Sportmotorcycle GmbHJTVF |  KTM Sportmotorcycle GmbHJTZF |  KTM Sportmotorcycle GmbHJUNDA |  KTM Sportmotorcycle GmbHJVBL |  KTM Sportmotorcycle GmbHJVHV |  KTM Sportmotorcycle GmbHJVLY |  KTM Sportmotorcycle GmbHJVMB |  KTM Sportmotorcycle GmbHJVTB |  KTM Sportmotorcycle GmbHJWGV |  KTM Sportmotorcycle GmbHJWXJ |  KTM Sportmotorcycle GmbHJXRW | stymartJXYR |  KTM Sportmotorcycle GmbHJYBK | RR USA IncJYPP |  KTM Sportmotorcycle GmbHJZRD | Norcalway LLCJZRY |  KTM Sportmotorcycle GmbHKBVS |  KTM Sportmotorcycle GmbHKBWY | Trux AccessoriesKFHH | Intellitec Products LLCKRCQ | vmDSTechLCZM | TNAIYHSKP |  KTM Sportmotorcycle GmbHTEA | TealpartsTES | TESTEST | TESTTOW |  KTM Sportmotorcycle GmbHZAER |  KTM Sportmotorcycle GmbHZAPG |  KTM Sportmotorcycle GmbHZASE |  KTM Sportmotorcycle GmbHZAUT |  KTM Sportmotorcycle GmbHZCMS |  KTM Sportmotorcycle GmbHZCVL |  KTM Sportmotorcycle GmbHZETT |  KTM Sportmotorcycle GmbHZFRY |  KTM Sportmotorcycle GmbHZKAT |  KTM Sportmotorcycle GmbHZKEL |  KTM Sportmotorcycle GmbHZLKI |  KTM Sportmotorcycle GmbHZLUB |  KTM Sportmotorcycle GmbHZMAT |  KTM Sportmotorcycle GmbHZMEP |  KTM Sportmotorcycle GmbHZMIV |  KTM Sportmotorcycle GmbHZMOW |  KTM Sportmotorcycle GmbHZNOR |  KTM Sportmotorcycle GmbHZPRO |  KTM Sportmotorcycle GmbHZRIH |  KTM Sportmotorcycle GmbHZSKI |  KTM Sportmotorcycle GmbHZSTA |  KTM Sportmotorcycle GmbHZTLT |  KTM Sportmotorcycle GmbHZTOD |  KTM Sportmotorcycle GmbHZTOM |  KTM Sportmotorcycle GmbHZTRA |  KTM Sportmotorcycle GmbHZVAN |  KTM Sportmotorcycle GmbHZVEE |  KTM Sportmotorcycle GmbHZVUL |  KTM Sportmotorcycle GmbHZWTC |  KTM Sportmotorcycle GmbH
            
            
                Ebay :
                
            
            
                Interchange :
                AAATest Rite InternationalSelect multiple items
                
            
            
                Unit/Comp :
                
                    Unit
                    Comp
                
            
            
                Trading Partner :
                
                    
                        Trading Partner
                        The changes to the parts export settings for the Trading Partner can be done through the Trading Partner Master
                
                -SELECT-
            
             
                 
                  Include Equipment
            
        
    
    
        
            Brand*
            
                
                    
                    Select All
                    The Brand filter will be disabled when All lines are selected. The exported file will list all the Brands available in the PMT
                
                
                
            
            Sub Brand
            
                
                    
                    Select All
                    If there are no sub-brand(s) associated with the selected brand(s), only the brand information will be displayed here.
                
                
                
            
            Sub Product line*
            
                
                    
                    Select All
                
                Base#skp
            
            Part Description* 
            
                
                    
                        
                        Select All
                        
                            PARTS EXPORT SETTINGS
                            
                            Select All. Overwrite Export settings
                        
                        You can select only one Part Description when All Lines are selected
                    
                    
                        
                        
                        
                    
                
                
                
            
            VehicleType
            
                
                    
                    Select All
                    
                
                
                
            
            Make
            
                
                    
                    Select All
                    
                        
                        
                        
                    
                
                
                
            
            Region
            
                
                    
                    Select All
                
                
                
            
            ACES Header Info
            
                
                    
                        Export in ACES Version:
                        
                            
                            3.2

                            
                            4.0

                            
                            4.2
                        
                        
                            Overpopulate :
                            
                                
                                Both
                                
                                Submodel
                                
                                EngineBase
                            
                        
                    
                    
                        
                            Company Name*
                            
                        
                        
                            Company Contact*
                            
                        
                        
                            Effective Date*
                            
                        
                        
                            Submission Type*
                            -SELECT-FullUpdate
                        
                        
                            Document Title*
                            
                        
                        
                            Document Form #
                            
                        
                        
                            Approved for  
                            
                                
                                 CN 
                                
                                 MX 
                                
                                 US 
                            
                            ( CA-Canada , MX-Mexico , US-United States )
                            
                        
                    
                    
                        
                            Sender Company*
                            
                        
                        
                            Sender Contact*
                            
                        
                        
                            Sender Phone*
                            
                        
                        
                            Sender Phone Ext
                            
                        
                        
                            Sender Email
                            
                        
                        
                            Mapper Company
                            
                        
                        
                            Mapper Contact
                            
                        
                        
                            Mapper Phone
                            
                        
                        
                            Mapper Phone Ext
                            
                        
                        
                            Mapper Email
                            
                        
                        
                            Brand AAIAID
                            
                            Please provide the Brand AAIAID with 4 characters.
                            
                        
                    
                
            
            PIES Header Info
            
                
                    
                        
                            Company Name*
                            
                        
                        
                            PLA
                            
                        
                        
                            Vendor #
                            
                        
                        
                            Submission Type*
                            -SELECT-FullUpdate
                        
                        
                            Contact Name*
                            
                        
                        
                            Contact Email*
                            
                        
                        
                            Effective Date*
                            
                        
                        
                            Price Sheet #*
                            
                        
                    
                
            
        
       
    
        
        
            
            Enable this field to exclude the overlapping records in the export you want to generate
        
        
            If you have more than 1,048,576 rows, use CSV to export.
        
        
            Generate Excel
            Generate CSV
            Generate CSV Files
            Generate PIES Excel Files
            Generate PIES XML Files
            Generate QDB XML Files
            Generate Raw Notes XML Files
            Generate XML
            Import to Opticat
            Generate Customized Xml
            Generate XML to FTP
        
    
    
        
            
                Would you like to save the settings selected for this export for future use?
                If Yes, please click the &quot; , &quot;'&quot; , &quot;Yes&quot; , &quot;'&quot; , &quot; button. If not, click the &quot; , &quot;'&quot; , &quot;No&quot; , &quot;'&quot; , &quot; button.
                If &quot; , &quot;'&quot; , &quot;Yes&quot; , &quot;'&quot; , &quot; is clicked, you will be redirected to another pop-up where you can specify a name for this export and upload an associated icon. Upon saving, this will be added to the Export Data page of the PMT.
                (You can download the records with overlaps from the Downloads page.)
            
        
    
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    

                           
                            &quot;) or . = concat(&quot;
                      
                   
                        
    
    
    
        .select2-container {
            width: 250px !important;
        }

        .ui-accordion .ui-accordion-header {
            background: #d3d3d3 !important;
            border-radius: 3px;
        }

        .ui-icon-triangle-1-e {
            background-position: -32px -16px !important;
        }

        .ui-accordion .ui-accordion-header {
            color: #004a86 !important;
            font-weight: 600 !important;
            font-size: 15px !important;
        }

        .filterlbl {
            font-size: 13px !important;
            padding-left: 5px;
        }

        .background_lte label {
            font-size: 15px;
        }

        #divExportFormat {
            padding: 15px;
        }

        .span_head_bold {
            margin: 0px !important;
            color: #004a9af7;
        }

        .status-text.overlap #overlapchk {
            margin: 0px;
            width: 26px;
            height: 15px;
        }

        #Acesversion {
            padding-left: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #004a86;
        }

        .field_20 {
            margin-top: 10px !important;
        }

        #Acesversion span {
            font-weight: 600;
            font-size: 14px;
        }

        #overpopulate {
            padding-left: 10px;
        }

            #overpopulate span {
                font-size: 14px;
                font-weight: 600;
            }

        .field_label {
            font-weight: 600;
        }

        .tab button {
            color: #004a86 !important;
            font-weight: 700 !important;
        }

            

        #loaddatabox {
            padding-top: 15px;
        }

        .dropdown-container {
            padding-left: 8px;
        }

        .ui-state-active .ui-icon, .ui-button:active .ui-icon {
            filter: invert(1);
        }

        #divExportFormat label {
            font-weight: 500 !important;
        }

        .p_lr_5 {
            padding-left: 20px !important;
        }

        .Fmpexportbutton {
            background: #d11920;
            color: #fff;
            font-size: 12px;
            padding: 0px 10px 0px;
            border-radius: 5px;
        }

        .exportbottom {
            padding-bottom: 50px;
        }

        .Exportbutton {
            cursor: pointer;
            background: #058c40;
            color: #fff;
            margin: 0 0 0 10px;
            padding: 5px 10px;
            border: none;
            border-radius: 5px;
        }

        .status-text {
            font-family: Arial, sans-serif;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .red-text {
            color: red;
            font-weight: bold;
        }

        .underline-link {
            color: red;
            text-decoration: underline;
            cursor: pointer;
        }

        .tab {
            overflow: hidden;
            border-bottom: 1px solid #ccc;
        }

            .tab button {
                background-color: #f1f1f1;
                float: left;
                border: none;
                outline: none;
                cursor: pointer;
                padding: 10px 16px;
                transition: 0.3s;
                align-items: center;
            }

                .tab button:hover {
                    background-color: #ddd;
                }

                .tab button.active {
                    background-color: #ccc;
                }

        .tab-icon {
            width: 24px;
            height: 24px;
            margin-right: 8px;
        }

        .tab-icon1 {
            width: auto;
            height: 30px;
            margin-right: 8px;
        }

        .tabcontent {
            display: none;
            padding: 6px 12px;
            border: 1px solid #ccc;
            border-top: none;
            margin-top: 20px;
        }

        .content {
            margin-top: 20px;
        }

        .select2-results__option .wrap:before {
            font-family: fontAwesome;
            color: #004a86;
            content: &quot;\f096&quot;;
            width: 25px;
            height: 25px;
            padding-right: 10px;
        }

        .select2-results__option[aria-selected=true] .wrap:before {
            content: &quot;\f14a&quot;;
        }

        /* not required css */

        .select2-multiple, .select2-multiple2 {
            width: 50%
        }

        .ui-accordion .ui-accordion-header {
            color: #2b43c3;
            border: 1px solid #ffffff;
            background: #ddd;
            padding: 20px; /* Adjust this as needed */
            height: 50px; /* Set a fixed height */
            display: flex; /* Use Flexbox to center content */
            align-items: center; /* Vertically center content */
            text-align: center; /* Ensure text is centered if it&quot; , &quot;'&quot; , &quot;s multiline */
        }

        #accordion {
            margin: 5px 0;
        }

        .filterclass {
            display: inline-block;
            vertical-align: top;
            width: 24%;
            padding: 3px 5px;
            margin: 3px;
        }

        .filterlbl {
            width: 85%;
            float: left;
        }

        .filterinp {
            float: left;
        }

        .panel_box {
            width: 100%;
            overflow-y: auto;
            max-height: 300px;
            border: 1px solid #ccc;
            padding: 10px;
            box-shadow: 0 0 5px rgba(0, 0, 0, .28);
        }
    
    
        var AdminId = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var AdminGroupID = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var WebAPIURL = &quot; , &quot;'&quot; , &quot;https://ecat.apapmt.com:8186/ecat/pmtapi/&quot; , &quot;'&quot; , &quot;;
        var ReadOnlyDB = &quot; , &quot;'&quot; , &quot;false&quot; , &quot;'&quot; , &quot;;
        var ACESPIESQueue = &quot; , &quot;'&quot; , &quot;true&quot; , &quot;'&quot; , &quot;;
        var ChkSubProdLineAlert = &quot; , &quot;'&quot; , &quot;false&quot; , &quot;'&quot; , &quot;;
        var TradingPartnerwebconfig = &quot; , &quot;'&quot; , &quot;true&quot; , &quot;'&quot; , &quot;;
        var Export_Overpopulate = &quot; , &quot;'&quot; , &quot;true&quot; , &quot;'&quot; , &quot;;
        var FMP = &quot; , &quot;'&quot; , &quot;true&quot; , &quot;'&quot; , &quot;;
        var AllExcelExportOption = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var Submissiontype = &quot; , &quot;'&quot; , &quot;true&quot; , &quot;'&quot; , &quot;;
        var CustomizedXmlExp = &quot; , &quot;'&quot; , &quot;1&quot; , &quot;'&quot; , &quot;;
        var syncwithopticat = &quot; , &quot;'&quot; , &quot;false&quot; , &quot;'&quot; , &quot;;
        var CustomAllApplication = &quot; , &quot;'&quot; , &quot;Yes&quot; , &quot;'&quot; , &quot;;
        var AllApplicationTitle = &quot; , &quot;'&quot; , &quot;Yes&quot; , &quot;'&quot; , &quot;;
        var IncludeCustomValue = &quot; , &quot;'&quot; , &quot;NO&quot; , &quot;'&quot; , &quot;;
        var PMTName = &quot; , &quot;'&quot; , &quot;EcatPMT&quot; , &quot;'&quot; , &quot;;
        AdminId = &quot; , &quot;'&quot; , &quot;3127&quot; , &quot;'&quot; , &quot;;
        AdminGroupID = &quot; , &quot;'&quot; , &quot;6&quot; , &quot;'&quot; , &quot;;
        var BrandIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var SubBrandIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var SubPLine = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var PartTypeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var VehicleTypeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var MakeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var RegionIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var Equipment = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
        var searchdata = &quot;&quot;;
        var searchMdata = &quot;&quot;;
        var Process = &quot;&quot;;
        var hdUnitComp = &quot;&quot;;
        var hdCapital = &quot;&quot;;
        var hdIncludeCustomValue = &quot;&quot;;
        var P2P = &quot;&quot;;
        var XMLTOFTP = &quot;&quot;;
        var hdExportType = &quot;&quot;;
        var LineTPwise = &quot;&quot;;
        var hdAmazon = &quot;&quot;;
        var Services = &quot;&quot;;
        var hdbrand = &quot;false&quot;;
        var PCompany = &quot;&quot;;
        var PContactName = &quot;&quot;;
        var PContactEmail = &quot;&quot;;
        var PPLA = &quot;&quot;;
        var PVendorNumber = &quot;&quot;;
        var PPIESSubmissionType = &quot;&quot;;
        var PPriceSheetNum = &quot;&quot;;
        var PBlanketEffectiveDate = &quot;&quot;;
        var ACompanyName = &quot;&quot;;
        var ACompanyContact = &quot;&quot;;
        var AEffectiveDate = &quot;&quot;;
        var Adoctitle = &quot;&quot;;
        var ADocformnumber = &quot;&quot;;
        var ASenderCompany = &quot;&quot;;
        var ASenderContact = &quot;&quot;;
        var ASenderPhone = &quot;&quot;;
        var Asenderphoneext = &quot;&quot;;
        var Asenderemail = &quot;&quot;;
        var AMapperCompany = &quot;&quot;;
        var AMapperContact = &quot;&quot;;
        var AMapperPhone = &quot;&quot;;
        var AMapperPhoneext = &quot;&quot;;
        var AMapperEmail = &quot;&quot;;
        var AApprovedfordata = &quot;&quot;;
        var ExportFTP = &quot;&quot;;
        var customizedflag = &quot;0&quot;;
        $(document).ready(function () {
            GetexportMenu();
            GetCustomExportImage();
            loadhdvalues();
            BrandIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            SubBrandIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            SubPLine = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            PartTypeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            VehicleTypeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            MakeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            Equipment = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            RegionIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            $(&quot;#loaddatabox&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;.tablinks&quot;).click(function () {
                event.preventDefault();
                $(&quot;.tablinks&quot;).css(&quot;background-color&quot;, &quot;&quot;);
                $(this).css(&quot;background-color&quot;, &quot;#ddd&quot;);
            });
            $(&quot;.Cusimgexport&quot;).click(function () {
                event.preventDefault();
                let imgSrc = $(this).find(&quot; , &quot;'&quot; , &quot;img&quot; , &quot;'&quot; , &quot;).attr(&quot; , &quot;'&quot; , &quot;src&quot; , &quot;'&quot; , &quot;);
                let fileName = imgSrc.split(&quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;).pop();
                //console.log(fileName);
                 var data = {
                   &quot;adminid&quot;: AdminId,
                   &quot;FileName&quot;: fileName
                            }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetCustomExportid&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(data),
                    //async: false,
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    timeout: 120000,
                    success: function (result) {
                        debugger
                        var Exportid = &quot;&quot;;
                        var ExportType = &quot;&quot;;
                        var CompanyName = &quot;&quot;;
                        var companycontact = &quot;&quot;;
                        var effectivedate = &quot;&quot;;
                        var submissiontype = &quot;&quot;;
                        var doctitle = &quot;&quot;;
                        var docformnumber = &quot;&quot;;
                        var approvedfor = &quot;&quot;;
                        var sendercompany = &quot;&quot;;
                        var sendercontact = &quot;&quot;;
                        var senderphone = &quot;&quot;;
                        var senderphoneext = &quot;&quot;;
                        var senderemail = &quot;&quot;;
                        var mappercompany = &quot;&quot;;
                        var mappercontact = &quot;&quot;;
                        var mapperphone = &quot;&quot;;
                        var mapperphoneext = &quot;&quot;;
                        var mapperemail = &quot;&quot;;
                        var BrandID = &quot;&quot;;
                        var Acesname = &quot;&quot;;
                        var Line = &quot;&quot;;
                        var AdminID = AdminId;
                        if (result.length > 0) {
                            var data = JSON.parse(result);
                            $.each(data, function () {
                                Exportid = this[&quot; , &quot;'&quot; , &quot;Exportid&quot; , &quot;'&quot; , &quot;];
                                ExportType = this[&quot; , &quot;'&quot; , &quot;ExportType&quot; , &quot;'&quot; , &quot;];
                                CompanyName = this[&quot; , &quot;'&quot; , &quot;CompanyName&quot; , &quot;'&quot; , &quot;];
                                companycontact = this[&quot; , &quot;'&quot; , &quot;companycontact&quot; , &quot;'&quot; , &quot;];
                                effectivedate = this[&quot; , &quot;'&quot; , &quot;effectivedate&quot; , &quot;'&quot; , &quot;];
                                submissiontype = this[&quot; , &quot;'&quot; , &quot;submissiontype&quot; , &quot;'&quot; , &quot;];
                                doctitle = this[&quot; , &quot;'&quot; , &quot;doctitle&quot; , &quot;'&quot; , &quot;];
                                docformnumber = this[&quot; , &quot;'&quot; , &quot;docformnumber&quot; , &quot;'&quot; , &quot;];
                                approvedfor = this[&quot; , &quot;'&quot; , &quot;approvedfor&quot; , &quot;'&quot; , &quot;];
                                sendercompany = this[&quot; , &quot;'&quot; , &quot;sendercompany&quot; , &quot;'&quot; , &quot;];
                                sendercontact = this[&quot; , &quot;'&quot; , &quot;sendercontact&quot; , &quot;'&quot; , &quot;];
                                senderphone = this[&quot; , &quot;'&quot; , &quot;senderphone&quot; , &quot;'&quot; , &quot;];
                                senderphoneext = this[&quot; , &quot;'&quot; , &quot;senderphoneext&quot; , &quot;'&quot; , &quot;];
                                senderemail = this[&quot; , &quot;'&quot; , &quot;senderemail&quot; , &quot;'&quot; , &quot;];
                                mappercompany = this[&quot; , &quot;'&quot; , &quot;mappercompany&quot; , &quot;'&quot; , &quot;];
                                mappercontact = this[&quot; , &quot;'&quot; , &quot;mappercontact&quot; , &quot;'&quot; , &quot;];
                                mapperphone = this[&quot; , &quot;'&quot; , &quot;mapperphone&quot; , &quot;'&quot; , &quot;];
                                mapperphoneext = this[&quot; , &quot;'&quot; , &quot;mapperphoneext&quot; , &quot;'&quot; , &quot;];
                                mapperemail = this[&quot; , &quot;'&quot; , &quot;mapperemail&quot; , &quot;'&quot; , &quot;];
                                BrandID = this[&quot; , &quot;'&quot; , &quot;BrandID&quot; , &quot;'&quot; , &quot;];
                                Acesname = this[&quot; , &quot;'&quot; , &quot;PIES&quot; , &quot;'&quot; , &quot;];
                                Equipment = this[&quot; , &quot;'&quot; , &quot;Equipment&quot; , &quot;'&quot; , &quot;];
                                Line = this[&quot; , &quot;'&quot; , &quot;Line&quot; , &quot;'&quot; , &quot;];

                                if (Acesname == &quot;ACES with QDB Codes&quot;) {
                                    Qualifier = true;
                                }
                                else {
                                    Qualifier = false;
                                }
                            })
                            var _data = {
                                &quot;CompanyName&quot;: CompanyName,
                                &quot;Acesname&quot;: Acesname,
                                &quot;drpSubmissionType&quot;: submissiontype,
                                &quot;Contact&quot;: companycontact,
                                &quot;EffectiveDate&quot;: effectivedate,
                                &quot;DocTitle&quot;: doctitle,
                                &quot;DocFormNo&quot;: docformnumber,
                                &quot;Approvedfor&quot;: approvedfor,
                                &quot;SenderCompany&quot;: sendercompany,
                                &quot;SenderContact&quot;: sendercontact,
                                &quot;SenderPhone&quot;: senderphone,
                                &quot;SenderPhoneExt&quot;: senderphoneext,
                                &quot;SenderEmail&quot;: senderemail,
                                &quot;MapperCompany&quot;: mappercompany,
                                &quot;MapperContact&quot;: mappercontact,
                                &quot;MapperPhone&quot;: mapperphone,
                                &quot;MapperPhoneExt&quot;: mapperphoneext,
                                &quot;MapperEmail&quot;: mapperemail,
                                &quot;BrandID&quot;: BrandID,
                                &quot;ExportType&quot;: ExportType,
                                &quot;Exportid&quot;: Exportid,
                                &quot;Line&quot;: Line,
                                &quot;AdminId&quot;: AdminId
                            }
                            if (ACESPIESQueue == &quot;false&quot;) {
                                $.ajax({
                                    type: &quot;POST&quot;,
                                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetAcesCustomimgExportxmldataNew&quot; , &quot;'&quot; , &quot;,
                                    data: JSON.stringify(_data),
                                    contentType: &quot;application/json; charset=utf-8&quot;,
                                    success: function (response) {
                                        debugger
                                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                        var data = JSON.parse(response);
                                        var count = data.Count;
                                        var name = data.Name;
                                        var result = data.Result;
                                        var services = Acesname;
                                        var rbb = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;exportFormat&quot;]:checked&quot; , &quot;'&quot; , &quot;).val();
                                        if (rbb != &quot;&quot; &amp;&amp; rbb != undefined) {
                                            rbb = &quot;4.2&quot;;
                                        }
                                        const sanitizedName = name.replace(/[^a-zA-Z0-9-_ ]+/g, &quot;&quot;);
                                        const fullURL = `downloadAcesXml.aspx?Aces=${services}&amp;company=${sanitizedName}&amp;Qualifier=${Qualifier}&amp;Equipment=${Equipment}&amp;ExportFormat=${rbb}`;
                                        if (count != &quot;0&quot;) {
                                            if (result == &quot;Success&quot;) {
                                                window.open(fullURL, &quot; , &quot;'&quot; , &quot;_blank&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px&quot; , &quot;'&quot; , &quot;);
                                            }
                                            else {
                                                alert(&quot;Run Api mode contact administator&quot;);
                                            }
                                        }
                                        else {
                                            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                            alert(&quot;There is no data for this criteria&quot;);
                                        }

                                    },
                                    error: function () {

                                        alert(&quot;Failed!&quot;)
                                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                    }
                                })
                            }
                            else {
                                $.ajax({
                                    type: &quot;POST&quot;,
                                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveAcesCustomimgExportxmldataNew&quot; , &quot;'&quot; , &quot;,
                                    data: JSON.stringify(_data),
                                    contentType: &quot;application/json; charset=utf-8&quot;,
                                    success: function (response) {
                                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                        var msg = JSON.parse(response);
                                        //if (response > 0)
                                        if (msg == &quot;Success&quot;) {

                                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                                        }
                                        else {
                                            alert(&quot;Run Api mode contact administator&quot;);
                                        }

                                    },
                                    error: function (err) {
                                        console.log(err);
                                        alert(&quot;Failed!&quot;)
                                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                    }
                                })
                            }
                        }
                    }, error: function (x, t, m) {
                            if (t === &quot;timeout&quot;) {
                                Swal.fire({
                                    icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                                    //title: &quot; , &quot;'&quot; , &quot;Cancelled&quot; , &quot;'&quot; , &quot;,
                                    title: &quot;Request timed out. Please contact system administrator&quot;,
                                    allowOutsideClick: false,
                                    allowEscapeKey: false,
                                })
                                //alert(&quot;Request timed out. Please contact system administrator&quot;);
                            } else {
                                Swal.fire({
                                    icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                                    //title: &quot; , &quot;'&quot; , &quot;Cancelled&quot; , &quot;'&quot; , &quot;,
                                    title: &quot;Already Exists&quot;,
                                    allowOutsideClick: false,
                                    allowEscapeKey: false,
                                })
                                //alert(&quot;Error Occured. Please contact system adminstrator&quot;);
                            }
                            $(&quot;.loader_main_spin&quot;).hide();
                        }

                    
                });

            });
            $(&quot;#DrpLine&quot;).change(function () {
                CloseTab();
                $(&quot;#overpopulate&quot;).hide();
                if ($(&quot;#DrpLine&quot;).val() != &quot;-SELECT-&quot;) {
                    Loadinterchange();
                    $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
                    $(&quot;#accordion&quot;).show();
                    $(&quot;#Bottomdata&quot;).show();
                    if (LineTPwise != &quot;TP&quot;) {
                        LineTPwise = &quot;Line&quot;;
                    }
                }
                else {
                    $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
                    $(&quot;#drpinterchange&quot;).empty();
                    $(&quot;#accordion&quot;).hide();
                    $(&quot;#Bottomdata&quot;).hide();
                    if (LineTPwise != &quot;TP&quot;) {
                        LineTPwise = &quot;&quot;;
                        LoadTradingPartner();
                    }

                }
                if (LineTPwise == &quot;Line&quot;) {
                    if (($(&quot;#drptradingpartner&quot;).val()) == &quot;0&quot;) {
                        LoadTradingPartner();
                    }
                }
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    $(&quot;#alllinebrandnote&quot;).show();
                    if (LineTPwise != &quot;TP&quot;) {
                        $(&quot;#alllineptnote&quot;).show();
                    }
                    else {
                        $(&quot;#alllineptnote&quot;).hide();
                    }
                }
                else {
                    $(&quot;#alllinebrandnote&quot;).hide();
                    $(&quot;#alllineptnote&quot;).hide();
                }
                EnptyChkboxs();
                CheckSubPline();
                if (LineTPwise != &quot;TP&quot;) {
                    $(&quot;#drptradingpartner&quot;).val(&quot;0&quot;);
                }
                
                if (Process == &quot;PIES&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;.overlap&quot;).hide();
                    $(&quot;#overpopulate&quot;).hide();
                    $(&quot;#PIESHeader3&quot;).show();
                    $(&quot;#Header3&quot;).hide();
                    $(&quot;#Acesversion&quot;).hide();
                    if (syncwithopticat == &quot;true&quot;) {
                        if (FMP == &quot;true&quot;) {
                            $(&quot;#ImportOpticat&quot;).hide();
                        } else {
                            $(&quot;#ImportOpticat&quot;).show();
                        }
                        
                    }
                    else {
                        $(&quot;#ImportOpticat&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    $(&quot;#XMLExport&quot;).show();
                    $(&quot;#CSVExport&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#ExcelExport&quot;).show();
                    $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllSubPline&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;#checkAllSubPline&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        }
                        else {
                            $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                        $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                    }
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).show();
                            $(&quot;#PIESXMLExport&quot;).show();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#Interchangelbldep&quot;).hide();
                            $(&quot;#trading&quot;).hide();
                            $(&quot;#CSVExport&quot;).hide();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#XMLExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();
                            $(&quot;#FMPPIESXML&quot;).show();
                            $(&quot;#FMPPIESEXCEL&quot;).show();

                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;#PIESHeader3&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;#Interchangelbldep&quot;).show();
                            $(&quot;#trading&quot;).show();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#FMPPIESXML&quot;).hide();
                            $(&quot;#FMPPIESEXCEL&quot;).hide();
                            $(&quot;#CSVExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#XMLExport&quot;).show();
                        }
                    }
                    loadPIESHeaderdetails();
                }
                else if (Process == &quot;AllApplication&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllSubPline&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;#checkAllSubPline&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        }
                        else {
                            $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                        $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                    }
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#CSVExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();
                            $(&quot;#FMPCSVExport&quot;).show();

                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPCSVExport&quot;).hide();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#CSVExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).show();
                            $(&quot;#Makeh3&quot;).show();
                        }
                    }
                    //$(&quot;#Overlapdata&quot;).show();
                    $(&quot;.overlap&quot;).show();
                }
                else if (Process == &quot; , &quot;'&quot; , &quot;ACESwithQDB&quot; , &quot;'&quot; , &quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#Approvedfor&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (CustomizedXmlExp == &quot;1&quot;) {
                        $(&quot;#CustomXML&quot;).show();
                    }
                    if (Export_Overpopulate == &quot;true&quot;) {
                        $(&quot;#overpopulate&quot;).show();
                    }
                    else {
                        $(&quot;#overpopulate&quot;).hide();
                    }
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    $(&quot;#Approvedfor&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();
                            $(&quot;#QDBXMLExport&quot;).show();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPQDBXML&quot;).show();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#XMLExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();
                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).show();
                            $(&quot;#Makeh3&quot;).show();
                            $(&quot;#Regionh3&quot;).show();
                            $(&quot;#Header3&quot;).show();
                            //$(&quot;#Overlapdata&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;.overlap&quot;).show();
                            $(&quot;#QDBXMLExport&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPQDBXML&quot;).hide();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#XMLExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                        }
                    }
                    loadHeaderdetails();
                    if (XMLTOFTP == &quot;1&quot;) {
                        $(&quot;#xmltoftp&quot;).show();
                    }
                }
                else if (Process == &quot; , &quot;'&quot; , &quot;ACESwithRawNote&quot; , &quot;'&quot; , &quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (CustomizedXmlExp == &quot;1&quot;) {
                        $(&quot;#CustomXML&quot;).show();
                    }
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    if (Export_Overpopulate == &quot;true&quot;) {
                        $(&quot;#overpopulate&quot;).show();
                    }
                    else {
                        $(&quot;#overpopulate&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).show();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPRAWNotesXML&quot;).show();
                            $(&quot;#ExcelExport&quot;).hide();
                            $(&quot;#XMLExport&quot;).hide();
                            $(&quot;#csvinfo&quot;).hide();

                        }
                        else {
                            $(&quot;#Parttypeh3&quot;).show();
                            $(&quot;#vehicletypeh3&quot;).show();
                            $(&quot;#Makeh3&quot;).show();
                            $(&quot;#Regionh3&quot;).show();
                            $(&quot;#Header3&quot;).show();
                            //$(&quot;#Overlapdata&quot;).show();
                            $(&quot;.Exportdate&quot;).show();
                            $(&quot;.overlap&quot;).show();
                            $(&quot;#PIESExcelExport&quot;).hide();
                            $(&quot;#PIESXMLExport&quot;).hide();
                            $(&quot;#RawNotesXMLExport&quot;).hide();
                            $(&quot;#ApplicationCSV&quot;).hide();
                            $(&quot;#FMPRAWNotesXML&quot;).hide();
                            $(&quot;#ExcelExport&quot;).show();
                            $(&quot;#XMLExport&quot;).show();
                            $(&quot;#csvinfo&quot;).show();
                        }
                    }
                    loadHeaderdetails();
                    if (XMLTOFTP == &quot;1&quot;) {
                        $(&quot;#xmltoftp&quot;).show();
                    }
                }
                else if (Process == &quot;ACESwithRawNoteandInvalid&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;.overlap&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();

                        }
                    }
                }
                else if (Process == &quot;AcesInvalid&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    if (TradingPartnerwebconfig == &quot;true&quot;) {
                        $(&quot;#trading&quot;).show();
                    }
                    else {
                        $(&quot;#trading&quot;).hide();
                    }
                    $(&quot;#PTalllist&quot;).show();
                    if (FMP == &quot;true&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;#Parttypeh3&quot;).hide();
                            $(&quot;#vehicletypeh3&quot;).hide();
                            $(&quot;#Makeh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Regionh3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            $(&quot;#PIESHeader3&quot;).hide();
                            $(&quot;#Header3&quot;).hide();
                            //$(&quot;#Overlapdata&quot;).hide();
                            $(&quot;.Exportdate&quot;).hide();
                            $(&quot;.overlap&quot;).hide();

                        }
                    }
                }
                else if (Process == &quot;Amazon&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#Acesversion&quot;).show();
                    $(&quot;#XMLExport&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                    $(&quot;#trading&quot;).hide();
                }
                else if (Process == &quot;WalmartPIES&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;#ImportOpticat&quot;).hide();
                    $(&quot;.overlap&quot;).hide();
                    $(&quot;#PIESHeader3&quot;).show();
                    $(&quot;#Header3&quot;).hide();
                }
                else if (Process == &quot;Walmart&quot;) {
                    $(&quot;#Brandh3&quot;).show();
                    $(&quot;#Subbrandh3&quot;).show();
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;#CustomXML&quot;).hide();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).show();
                    $(&quot;#Header3&quot;).show();
                    $(&quot;#PIESHeader3&quot;).hide();
                }
                else {
                    $(&quot;#xmltoftp&quot;).hide();
                    $(&quot;.overlap&quot;).show();
                    Getoverlapdate();
                    $(&quot;#overpopulate&quot;).hide();
                    $(&quot;#PIESHeader3&quot;).hide();
                    $(&quot;#Header3&quot;).hide();
                    $(&quot;#Acesversion&quot;).hide();
                }
                //if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                //    $(&quot;#incequipment&quot;).hide();
                //    $(&quot;#trading&quot;).hide();
                //    $(&quot;#PTalllist&quot;).hide();
                //    $(&quot;#Acesversion&quot;).hide();
                //    $(&quot;#Ebaylbldrp&quot;).hide();
                //}
                $(&quot;.Exportdate&quot;).show();
                if (FMP == &quot;true&quot;) {
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        $(&quot;#csvinfo&quot;).hide();
                    } else {
                        $(&quot;#csvinfo&quot;).show();
                    }
                    
                } else {
                    $(&quot;#csvinfo&quot;).show();
                }
            })
            $(function () {
                $(&quot;#accordion&quot;).accordion({
                    header: &quot;h3&quot;, collapsible: true, heightStyle: &quot;content&quot;, active: false,

                    activate: function (event, ui) {
                        if (!$.isEmptyObject(ui.newHeader.offset())) {
                            $(&quot; , &quot;'&quot; , &quot;html:not(:animated), body:not(:animated)&quot; , &quot;'&quot; , &quot;).animate({ scrollTop: ui.newHeader.offset().top }, &quot; , &quot;'&quot; , &quot;fast&quot; , &quot;'&quot; , &quot;);
                        }
                    }
                });
                //$(&quot;#accordion h3&quot;).eq(0).off(&quot;click&quot;);
                //$(&quot;#accordion h3&quot;).eq(1).off(&quot;click&quot;);
            });
            //$(&quot;#accordion&quot;).on(&quot;click&quot;, &quot;.ui-accordion-header&quot;, function () {
            //    var header = $(this);
            //    var index = header.index();

            //    if (header.hasClass(&quot;ui-accordion-header-active&quot;)) {
            //        // Close the clicked panel
            //        header.removeClass(&quot;ui-accordion-header-active&quot;);
            //        header.next().slideUp();
            //    } else {
            //        // Open the clicked panel
            //        header.addClass(&quot;ui-accordion-header-active&quot;);
            //        header.next().slideDown();
            //    }
            //    if (index == &quot;0&quot;) {
            //        loadBrand();
            //    } else if (index == &quot;2&quot;) {
            //        loadSubBrand();
            //    }
            //});
            $(&quot;#accordion h3&quot;).eq(0).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadBrand();
                }
            });
            $(&quot;#accordion h3&quot;).eq(1).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadSubBrand();
                }
            });
            $(&quot;#accordion h3&quot;).eq(2).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    CheckSubPline();
                }
            });
            $(&quot;#accordion h3&quot;).eq(3).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadPartType();
                }
            });
            $(&quot;#accordion h3&quot;).eq(4).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadVehicleType();
                }
            });
            $(&quot;#accordion h3&quot;).eq(5).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadMake();
                }
            });
            $(&quot;#accordion h3&quot;).eq(6).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadRegion();
                }
            });
            $(&quot;#accordion h3&quot;).eq(7).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadSubHeader();
                    loadHeaderdetails();
                    $(&quot;#SubmissionType&quot;).val(&quot;1&quot;);
                }
            });
            $(&quot;#accordion h3&quot;).eq(8).on(&quot;click&quot;, function () {
                event.preventDefault();
                var isOpen = $(this).next().is(&quot;:visible&quot;);
                if (!isOpen) {
                    loadSubHeader();
                    loadPIESHeaderdetails();
                    $(&quot;#PIESSubmissionType&quot;).val(&quot;1&quot;);
                }
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllbrand&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.brandchk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                BrandIds = $(&quot;.brandchk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllSubbrand&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.Subbrandchk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                SubBrandIds = $(&quot;.Subbrandchk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllSubPline&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.SubPlinechk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                SubPLine = $(&quot;.SubPlinechk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllPartType&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.PartTypechk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                PartTypeIds = $(&quot;.PartTypechk:checked&quot;).filter(function () {
                    // Check if this checkbox is within a visible .filterclassPT element
                    return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassPT&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
                }).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllVehicleType&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.VehicleTypechk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                VehicleTypeIds = $(&quot;.VehicleTypechk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllMake&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.Makechk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                MakeIds = $(&quot;.Makechk:checked&quot;).filter(function () {
                    return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassM&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
                }).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#checkAllRegion&quot; , &quot;'&quot; , &quot;).click(function () {
                $(&quot; , &quot;'&quot; , &quot;input.Regionchk&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, this.checked);
                RegionIds = $(&quot;.Regionchk:checked&quot;).map(function () {
                    return this.id;
                }).get().join(&quot;,&quot;);
            });
            $(&quot; , &quot;'&quot; , &quot;#chkequ&quot; , &quot;'&quot; , &quot;).click(function () {
                EnptyChkboxs();
                CloseTab();
            });
            $(&quot;#DrpEbay&quot;).change(function () {
                $(&quot;#accordion&quot;).show();
                $(&quot;#Ebaylbldrp&quot;).show();
                $(&quot;#loaddatabox&quot;).show();
                $(&quot;#Regionh3&quot;).show();
                $(&quot;#vehicletypeh3&quot;).show();
                $(&quot;#Makeh3&quot;).show();
                $(&quot;#Bottomdata&quot;).show();
                $(&quot;.Exportdate&quot;).show();
                $(&quot;#ExcelExport&quot;).show();
            })
        });
        function GetexportMenu() {
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetexportMenu&quot; , &quot;'&quot; , &quot;,
                data: &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;,
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    data.forEach(function (item) {
                        if (item.Iconlist === &quot;All Applications&quot;) {
                            $(&quot;#AllApplication&quot;).show();
                        }
                        else if (item.Iconlist === &quot;ACES with QDB Codes&quot;) {
                            $(&quot;#ACESwithQDB&quot;).show();
                        }
                        else if (item.Iconlist === &quot;ACES with Raw Notes&quot;) {
                            $(&quot;#ACESwithRawNotes&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Pies&quot;) {
                            $(&quot;#PIES&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Amazon&quot;) {
                            $(&quot;#Amazon&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Walmart&quot;) {
                            $(&quot;#Walmart&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Walmart XML&quot;) {
                            $(&quot;#WalmartPIES&quot;).show();
                        }
                        else if (item.Iconlist === &quot;Ebay&quot;) {
                            $(&quot;#Ebay&quot;).show();
                        }
                        else if (item.Iconlist === &quot;AcesInvalid&quot;) {
                            $(&quot;#ACESInvalid&quot;).show();
                        }
                        else if (item.Iconlist === &quot;AcesRawNotes with Invalid&quot;) {
                            $(&quot;#ACESwithRawNotesandAttributeInvalid&quot;).show();
                        }
                    });
                },
            });
        }
        function GetCustomExportImage() {
            var data = {
                &quot;AdminID&quot;: AdminId
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetCustomExportImage&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    var url = window.location.origin;
                    $.each(data, function (index, item) {
                        var urlpath = url + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot; + item.Filepath.replace(&quot; , &quot;'&quot; , &quot;~&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);
                        var $button = $(&quot; , &quot;'&quot; , &quot;&lt;button>&quot; , &quot;'&quot; , &quot;, {
                            class: &quot; , &quot;'&quot; , &quot;tablinks Cusimgexport&quot; , &quot;'&quot; , &quot;,
                            title: item.Nameofoutput,
                            id: item.Nameofoutput
                        });
                        var $img = $(&quot; , &quot;'&quot; , &quot;&lt;img>&quot; , &quot;'&quot; , &quot;, {
                            src: urlpath,
                            alt: item.Nameofoutput,
                            class: &quot; , &quot;'&quot; , &quot;tab-icon1&quot; , &quot;'&quot; , &quot;
                        });
                        $button.append($img);
                        $(&quot; , &quot;'&quot; , &quot;#buttonContainer&quot; , &quot;'&quot; , &quot;).append($button);
                    });
                },
            });
        }
        $.fn.select2.amd.require([
            &quot; , &quot;'&quot; , &quot;select2/selection/single&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/selection/placeholder&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/selection/allowClear&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/dropdown&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/dropdown/search&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/dropdown/attachBody&quot; , &quot;'&quot; , &quot;,
            &quot; , &quot;'&quot; , &quot;select2/utils&quot; , &quot;'&quot; , &quot;
        ], function (SingleSelection, Placeholder, AllowClear, Dropdown, DropdownSearch, AttachBody, Utils) {

            var SelectionAdapter = Utils.Decorate(
                SingleSelection,
                Placeholder
            );

            SelectionAdapter = Utils.Decorate(
                SelectionAdapter,
                AllowClear
            );

            var DropdownAdapter = Utils.Decorate(
                Utils.Decorate(
                    Dropdown,
                    DropdownSearch
                ),
                AttachBody
            );

            var base_element = $(&quot; , &quot;'&quot; , &quot;#drpinterchange&quot; , &quot;'&quot; , &quot;);
            $(base_element).select2({
                placeholder: &quot; , &quot;'&quot; , &quot;Select multiple items&quot; , &quot;'&quot; , &quot;,
                selectionAdapter: SelectionAdapter,
                dropdownAdapter: DropdownAdapter,
                allowClear: true,
                selectOnClose: false,
                templateResult: function (data) {
                    if (!data.id) { return data.text; }

                    var $res = $(&quot; , &quot;'&quot; , &quot;&lt;div>&lt;/div>&quot; , &quot;'&quot; , &quot;);

                    $res.text(data.text);
                    $res.addClass(&quot; , &quot;'&quot; , &quot;wrap&quot; , &quot;'&quot; , &quot;);

                    return $res;
                },
                templateSelection: function (data) {

                    if (!data.id) {
                        return data.text;
                    }

                    var selected = ($(&quot; , &quot;'&quot; , &quot;#drpinterchange&quot; , &quot;'&quot; , &quot;).val() || []).length;
                    var total = $(&quot; , &quot;'&quot; , &quot;option&quot; , &quot;'&quot; , &quot;, $(&quot; , &quot;'&quot; , &quot;#drpinterchange&quot; , &quot;'&quot; , &quot;)).length;
                    return &quot;Selected &quot; + selected + &quot; of &quot; + total;
                }
            });
        });
        function select2onclose() {
            var Attribute = $(&quot;#drpinterchange&quot;).val().join();
            if (Attribute == &quot;&quot; || Attribute == undefined) {
                Attribute = &quot;0&quot;;
            }
            $(&quot;#drpinterchange1&quot;).val(Attribute);
            EnptyChkboxs();
            CloseTab();
        }
        function loadhdvalues() {
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;loadhdvalues&quot; , &quot;'&quot; , &quot;,
                data: &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;,
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    var UnitComp = data.Table;
                    var Capital = data.Table1;
                    var custonval = data.Table2;
                    var ptp = data.Table3;
                    var Brandidcnt = data.Table4;
                    var xmlftp = data.Table5;

                    if (UnitComp.length > 0) {
                        hdUnitComp = UnitComp[0].UnitCompcnt;
                    }
                    if (Capital.length > 0) {
                        hdCapital = Capital[0].Capitalcnt;
                    }
                    if (custonval.length > 0) {
                        hdIncludeCustomValue = custonval[0].Custonvalcnt;
                    }
                    if (ptp.length > 0) {
                        P2P = ptp[0].P2Pcnt;
                    }
                    if (Brandidcnt.length > 0) {
                        var brandhide = Brandidcnt[0].Brandidcnt;
                        if (brandhide == 1) {
                            hdbrand = &quot;true&quot;;
                            $(&quot;#Brandexport&quot;).show();
                        }
                    }
                    if (xmlftp.length > 0) {
                        XMLTOFTP = xmlftp[0].xmltoftp;
                    }
                },
            });
        }
        function OpenPIES() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;PIES&quot;;
            Services = &quot;EPI&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).hide();
            $(&quot;#Makeh3&quot;).hide();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;#ExcelExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Interchangelbldep&quot;).show();
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            hdExportType = &quot;Services&quot;;
			$(&quot;#exportst&quot;).show();
        }
        function OpenAllApplications() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;AllApplication&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#trading&quot;).hide();
            $(&quot;#accordion&quot;).hide();
            $(&quot;#incequipment&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).hide();
            $(&quot;#PIESHeader3&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;#exportst&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).hide();
            $(&quot;#ExcelExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#XMLExport&quot;).hide();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#ExcelExport&quot;).show();
            hdExportType = &quot;AllApplication&quot;;
            Services = &quot;ACES&quot;;
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            $(&quot;#unitcomplbldrp&quot;).hide();
			$(&quot;status-text overlap&quot;).hide();
        }
        function OpenACESwithQDBCodes() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;ACESwithQDB&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            $(&quot;#drpCompetitor1&quot;).val(&quot;&quot;);
            $(&quot;#chkequ&quot;).prop(&quot;checked&quot;, false);
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).show();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Approvedfor&quot;).show();
            $(&quot;#Interchangelbldep&quot;).show();
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#ExcelExport&quot;).show();
            hdExportType = &quot;ACESwithQDBCodes&quot;;
            hdAmazon = &quot;0&quot;;
            Services = &quot;ACES&quot;;
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
			$(&quot;#exportst&quot;).show();
        }
        function OpenACESwithRawNotes() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Services = &quot;ACES&quot;;
            Process = &quot;ACESwithRawNote&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            if (syncwithopticat == &quot;true&quot;) {
                $(&quot;#ImportOpticat&quot;).show();
            }
            else {
                $(&quot;#ImportOpticat&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).show();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Approvedfor&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            hdAmazon = &quot;0&quot;;
            $(&quot;#Interchangelbldep&quot;).show();
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).show();
            $(&quot;#ExcelExport&quot;).show();
            hdExportType = &quot;ACESwithRawNotes&quot;;
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
			$(&quot;#exportst&quot;).show();
        }
        function OpenACESwithRawNotesandInvalid() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Services = &quot;ACES&quot;;
            Process = &quot;ACESwithRawNoteandInvalid&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            hdAmazon = &quot;0&quot;;
            hdExportType = &quot;ACESwithRawNotesandInvalid&quot;;
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
        }
        function OpenACESInvalid() {
            event.preventDefault();
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            Process = &quot;ACESInvalid&quot;;
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#incequipment&quot;).show();
            $(&quot;#accordion&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange option&quot;).remove();
            $(&quot;#Unitcomp&quot;).val(&quot;1&quot;);
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                $(&quot;#trading&quot;).show();
                LoadTradingPartner();
            }
            else {
                $(&quot;#trading&quot;).hide();
            }
            $(&quot;#vehicletypeh3&quot;).show();
            $(&quot;#Makeh3&quot;).show();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#Header3&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            hdAmazon = &quot;0&quot;;
            hdExportType = &quot;ACESInvalid&quot;;
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
        }
        function OpenAmazon() {
            Process = &quot;Amazon&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            LineTPwise = &quot;&quot;;
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#accordion&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Interchangelbldep&quot;).show();
            Loadlinecode();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#trading&quot;).hide();
            if (FMP == &quot;true&quot;) {
                $(&quot;#QDBXMLExport&quot;).hide();
                $(&quot;#PIESExcelExport&quot;).hide();
                $(&quot;#PIESXMLExport&quot;).hide();
                $(&quot;#RawNotesXMLExport&quot;).hide();
                $(&quot;#ApplicationCSV&quot;).hide();
            }
            $(&quot;#XMLExport&quot;).show();
            hdExportType = &quot;Amazon&quot;;
            Services = &quot;Amazon&quot;;
            hdAmazon = &quot;1&quot;;
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
        }
        function OpenWalmart() {
            LineTPwise = &quot;&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            Process = &quot;Walmart&quot;;
            Services = &quot;Walmart&quot;;
            $(&quot;#accordion&quot;).hide();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).show();
            $(&quot;#XMLExport&quot;).show();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            $(&quot;#trading&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
        }
        function OpenWalmartPIES() {
            LineTPwise = &quot;&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            Process = &quot;WalmartPIES&quot;;
            Services = &quot;WalmartPIES&quot;;
            $(&quot;#accordion&quot;).hide();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).show();
            $(&quot;#Ebaylbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#incequipment&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).hide();
            if (hdUnitComp == &quot;1&quot;) {
                $(&quot;#unitcomplbldrp&quot;).show();
            }
            else {
                $(&quot;#unitcomplbldrp&quot;).hide();
            }
            $(&quot;#trading&quot;).hide();
            Loadlinecode();
            $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
            $(&quot;#vehicletypeh3&quot;).hide();
            $(&quot;#Makeh3&quot;).hide();
            $(&quot;#Regionh3&quot;).hide();
            Services = &quot;WAL&quot;;
            $(&quot;#Header3&quot;).hide();
            $(&quot;#XMLExport&quot;).show();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            $(&quot;#PIESHeader3&quot;).show();
            hdExportType = &quot;Services&quot;;
        }
        function OpenEbay() {
            LineTPwise = &quot;&quot;;
            $(&quot;#ImportOpticat&quot;).hide();
            $(&quot;#FMPCSVExport&quot;).hide();
            $(&quot;#FMPPIESXML&quot;).hide();
            $(&quot;#FMPPIESEXCEL&quot;).hide();
            $(&quot;#FMPQDBXML&quot;).hide();
            $(&quot;#FMPRAWNotesXML&quot;).hide();
            Services = &quot;Ebay&quot;;
            Process = &quot;Ebay&quot;;           
            $(&quot;#accordion&quot;).hide();
            $(&quot;#Ebaylbldrp&quot;).show();
            $(&quot;#loaddatabox&quot;).show();
            $(&quot;#Linelbldrp&quot;).hide();
            $(&quot;.overlap&quot;).hide();
            $(&quot;#unitcomplbldrp&quot;).hide();
            $(&quot;#Interchangelbldep&quot;).hide();
            $(&quot;#trading&quot;).hide();                  
            $(&quot;#subplineh3&quot;).hide();
            $(&quot;#Regionh3&quot;).hide();
            $(&quot;#vehicletypeh3&quot;).hide();
            $(&quot;#Makeh3&quot;).hide();
            $(&quot;#Header3&quot;).hide();
            $(&quot;#PIESHeader3&quot;).hide();           
            $(&quot;#Brandh3&quot;).hide();
            $(&quot;#Subbrandh3&quot;).hide();
            $(&quot;#Bottomdata&quot;).hide();
            $(&quot;.Exportdate&quot;).hide();
            $(&quot;#XMLExport&quot;).hide();
            $(&quot;#CSVExport&quot;).hide();
            $(&quot;#ExcelExport&quot;).hide();
            LoadEbayStore();
        }
        function Loadlinecode() {
            var Trading = &quot;0&quot;;
            if (LineTPwise == &quot;TP&quot;) {
                Trading = $(&quot;#drptradingpartner&quot;).val();
            }
            var data1 = {
                &quot;AdminId&quot;: AdminId,
                &quot;Trading&quot;: Trading
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;Exportdatalinedrp&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data1),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {

                    $(&quot;#DrpLine&quot;).empty();
                    if (data.length == 0) {
                        $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                    }
                    else if (data.length == 1) {
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                        }
                    }
                    else if (data.length > 1) {
                        if (LineTPwise != &quot;TP&quot;) {
                            $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                        }
                        if (Process == &quot;PIES&quot;) {
                            $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;ALL&quot;));
                        }
                        else if (Process == &quot;AllApplication&quot;) {
                            if (AllExcelExportOption == &quot;&quot;) {
                                $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;ALL&quot;));
                            }
                        }
                        else if (FMP == &quot;true&quot;) {
                            if (Process == &quot;ACESwithQDB&quot; || Process == &quot;ACESwithRawNote&quot;) {
                                if (AllExcelExportOption == &quot;&quot;) {
                                    $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;ALL&quot;));
                                }
                            }
                        }
                    }

                    $.each(data, function () {
                        $(&quot;#DrpLine&quot;).append($(&quot;&lt;option/>&quot;).val(this[&quot; , &quot;'&quot; , &quot;MfrBrandID&quot; , &quot;'&quot; , &quot;]).text(this[&quot; , &quot;'&quot; , &quot;MfrBrandName&quot; , &quot;'&quot; , &quot;]));
                    });
					if (LineTPwise == &quot;TP&quot;){
						$(&quot; , &quot;'&quot; , &quot;#DrpLine&quot; , &quot;'&quot; , &quot;).trigger(&quot; , &quot;'&quot; , &quot;change&quot; , &quot;'&quot; , &quot;);
					}
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }

                }
            });

        }
        function Loadinterchange() {
            var linecode = $(&quot;#DrpLine&quot;).val();
            var data = {
                &quot;Linecode&quot;: linecode
            }
            var url = WebAPIURL + &quot; , &quot;'&quot; , &quot;Exportinterchangedrp&quot; , &quot;'&quot; , &quot;;
            if (ReadOnlyDB == &quot;true&quot;) {
                url = WebAPIURLReadOnly + &quot; , &quot;'&quot; , &quot;Exportinterchangedrp&quot; , &quot;'&quot; , &quot;;
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: url,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    $(&quot;#drpinterchange&quot;).empty();
                    $.each(data, function () {
                        $(&quot;#drpinterchange&quot;).append($(&quot;&lt;option/>&quot;).val(this[&quot; , &quot;'&quot; , &quot;CompetitorID&quot; , &quot;'&quot; , &quot;]).text(this[&quot; , &quot;'&quot; , &quot;CompetitorName&quot; , &quot;'&quot; , &quot;]));
                    });
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }
                }
            });
        }
        function LoadTradingPartner() {
            var Linecode = &quot;0&quot;;
            if (LineTPwise == &quot;Line&quot;) {
                Linecode = $(&quot;#DrpLine&quot;).val();
            }
            var data1 = {
                &quot;AdminId&quot;: AdminId,
                &quot;Linecode&quot;: Linecode
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;LoadTradingPartner&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data1),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {

                    $(&quot;#drptradingpartner&quot;).empty();
                    if (data.length == 1 || data.length == 0) {
                        $(&quot;#drptradingpartner&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                    }
                    else if (data.length > 1) {
                        $(&quot;#drptradingpartner&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                    }

                    $.each(data, function () {
                        $(&quot;#drptradingpartner&quot;).append($(&quot;&lt;option/>&quot;).val(this[&quot; , &quot;'&quot; , &quot;ID&quot; , &quot;'&quot; , &quot;]).text(this[&quot; , &quot;'&quot; , &quot;TradingName&quot; , &quot;'&quot; , &quot;]));
                    });
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }

                }
            });

        }
        function LoadEbayStore() {
            var Marketid = &quot;1&quot;;
            var data1 = {
                &quot;MarketId&quot;: Marketid
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;LoadStoreNameMarketplace&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data1),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {

                    $(&quot;#DrpEbay&quot;).empty();
                    if (data.length == 1 || data.length == 0) {
                        $(&quot;#DrpEbay&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));
                    }
                    else if (data.length > 1) {
                        $(&quot;#DrpEbay&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;-SELECT-&quot;).text(&quot;-SELECT-&quot;));                        
                    }

                    $.each(data, function () {
                        $(&quot;#DrpEbay&quot;).append($(&quot;&lt;option/>&quot;).val(this[&quot; , &quot;'&quot; , &quot;Storeid&quot; , &quot;'&quot; , &quot;]).text(this[&quot; , &quot;'&quot; , &quot;Storename&quot; , &quot;'&quot; , &quot;]));
                    });
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Request timed out.Please contact system administrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    } else {
                        WriteToErrorFile(x);
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Error Occured. Please contact system adminstrator&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        })
                    }

                }
            });

        }
        function EnptyChkboxs() {
            $(&quot; , &quot;'&quot; , &quot;#checkAllbrand&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, true);
            BrandIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            SubBrandIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            SubPLine = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            PartTypeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            Equipment = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            searchdata = &quot;&quot;;
            searchMdata = &quot;&quot;;
            VehicleTypeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            MakeIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
            RegionIds = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
        }
        function CloseTab() {
            $(function () {
                $(&quot;#accordion&quot;).accordion({
                    header: &quot;h3&quot;, collapsible: true, heightStyle: &quot;content&quot;, active: false,

                    activate: function (event, ui) {
                        if (!$.isEmptyObject(ui.newHeader.offset())) {
                            $(&quot; , &quot;'&quot; , &quot;html:not(:animated), body:not(:animated)&quot; , &quot;'&quot; , &quot;).animate({ scrollTop: ui.newHeader.offset().top }, &quot; , &quot;'&quot; , &quot;fast&quot; , &quot;'&quot; , &quot;);
                        }
                    }
                });
            });
        }
        function loadBrand() {
            event.preventDefault();
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#chkbrandlist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            var trading = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                if ($(&quot;#drptradingpartner&quot;).val() != 0) {
                    trading = $(&quot;#drptradingpartner&quot;).val();
                }
            }
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;AdminGroupID&quot;: AdminGroupID,
                &quot;Trading&quot;: trading
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetMainBrandsBasedonLineNew&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
                    var divEdit = $(&quot;#chkbrandlist&quot;);
                    $(&quot;#Balllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (BrandIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = BrandIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp brandchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp brandchk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp brandchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (BrandIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (BrandIds == &quot;0&quot;) {
                    //            BrandIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                    //        }
                    //        BrandIds += (BrandIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;];
                    //    });
                    //}
                    $(&quot;.brandchk&quot;).change(function () {
                        if (LineTPwise != &quot;TP&quot;) {
                            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                                $(&quot;.brandchk&quot;).not(this).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, false);
                            }
                        }
                        BrandIds = $(&quot;.brandchk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.brandchk&quot;).length === $(&quot;.brandchk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllbrand&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.brandchk&quot;).length === $(&quot;.brandchk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllbrand&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    if (LineTPwise != &quot;TP&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, true);
                            $(&quot;.brandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        }
                        else {
                            $(&quot;#checkAllbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                    }
                    else {
                        $(&quot;.brandchk&quot;).prop(&quot;checked&quot;, true);
                    }
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            });
            //$(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
        }
        function loadSubBrand() {
            event.preventDefault();
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#chkSubbrandlist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            var trading = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                if ($(&quot;#drptradingpartner&quot;).val() != 0) {
                    trading = $(&quot;#drptradingpartner&quot;).val();
                }
            }
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;BrandIds&quot;: BrandIds,
                &quot;Trading&quot;: trading
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetBrandsBasedonLineNew&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
                    var divEdit = $(&quot;#chkSubbrandlist&quot;);
                    $(&quot;#SBalllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (SubBrandIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = SubBrandIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Subbrandchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Subbrandchk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Subbrandchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Brandname&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (SubBrandIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (SubBrandIds == &quot;0&quot;) {
                    //            SubBrandIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                    //        }
                    //        SubBrandIds += (SubBrandIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;BrandAAIAID&quot; , &quot;'&quot; , &quot;];
                    //    });
                    //}
                    $(&quot;.Subbrandchk&quot;).change(function () {
                        if (LineTPwise != &quot;TP&quot;) {
                            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                                $(&quot;.Subbrandchk&quot;).not(this).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, false);
                            }
                        }
                        SubBrandIds = $(&quot;.Subbrandchk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.Subbrandchk&quot;).length === $(&quot;.Subbrandchk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllSubbrand&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.Subbrandchk&quot;).length === $(&quot;.Subbrandchk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllSubbrand&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    if (LineTPwise != &quot;TP&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, true);
                            $(&quot;.Subbrandchk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
                        }
                        else {
                            $(&quot;#checkAllSubbrand&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                    }
                    else {
                        $(&quot;.Subbrandchk&quot;).prop(&quot;checked&quot;, true);
                    }
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            });
            //$(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
        }
        function CheckSubPline() {
            event.preventDefault();
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var linecode = $(&quot;#DrpLine&quot;).val();
            $(&quot;#chkSubplinelist&quot;).empty();
            var data = {
                &quot;linecode&quot;: linecode
            }
            var url = WebAPIURL + &quot; , &quot;'&quot; , &quot;CheckSubPline&quot; , &quot;'&quot; , &quot;;
            if (ReadOnlyDB == &quot;true&quot;) {
                url = WebAPIURLReadOnly + &quot; , &quot;'&quot; , &quot;CheckSubPline&quot; , &quot;'&quot; , &quot;;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: url,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
                    if (data.length > 0) {
                        $(&quot;#subplineh3&quot;).show();
                        var divEdit = $(&quot;#chkSubplinelist&quot;);
                        $(&quot;#Splalllist&quot;).show();
                        $.each(data, function (index, value) {
                            if (SubPLine != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                                var isChecked = SubPLine.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;]));
                                if (isChecked) {
                                    var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp SubPlinechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                                }
                                else {
                                    var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp SubPlinechk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                                }
                                divEdit.append(rdb);
                            } else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp SubPlinechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Productline&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                                divEdit.append(rdb);
                            }

                        });
                        //if (SubPLine == &quot;0&quot;) {
                        //    $.each(data, function (index, value) {
                        //        if (SubPLine == &quot;0&quot;) {
                        //            SubPLine = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                        //        }
                        //        SubPLine += (SubPLine ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;id&quot; , &quot;'&quot; , &quot;];
                        //    });
                        //}
                        $(&quot;.SubPlinechk&quot;).change(function () {
                            SubPLine = $(&quot;.SubPlinechk:checked&quot;).map(function () {
                                return this.id;
                            }).get().join(&quot;,&quot;);
                            var allChecked = $(&quot;.SubPlinechk&quot;).length === $(&quot;.SubPlinechk:checked&quot;).length;
                            $(&quot; , &quot;'&quot; , &quot;#checkAllSubPline&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                        });
                        var allChecked = $(&quot;.SubPlinechk&quot;).length === $(&quot;.SubPlinechk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllSubPline&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;,true);
                            $(&quot;.SubPlinechk&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;,true);
                        }
                        else {
                            $(&quot;#checkAllSubPline&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                    }
                    else {
                        $(&quot;#subplineh3&quot;).hide();
                        SubPLine = &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;;
                    }
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                },
                error: function (x, t, m) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function loadPartType() {
            event.preventDefault();
			$(&quot;#filter&quot;).val(&quot;&quot;);
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#chkPartTypelist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            var trading = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                if ($(&quot;#drptradingpartner&quot;).val() != 0) {
                    trading = $(&quot;#drptradingpartner&quot;).val();
                }
            }
            var storeid = $(&quot;#DrpEbay&quot;).val();
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;SubBrandIds&quot;: SubBrandIds,
                &quot;BrandIds&quot;: BrandIds,
                &quot;Adminid&quot;: AdminId,
                &quot;Trading&quot;: trading,
                &quot;storeid&quot;: storeid
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetPartTypedata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    debugger
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
                    var divEdit = $(&quot;#chkPartTypelist&quot;);
                    $(&quot;#PTalllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (PartTypeIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = PartTypeIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassPT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp PartTypechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassPT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp PartTypechk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassPT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp PartTypechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;PartDescription&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (PartTypeIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (PartTypeIds == &quot;0&quot;) {
                    //            PartTypeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                    //        }
                    //        PartTypeIds += (PartTypeIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;PartDescriptionId&quot; , &quot;'&quot; , &quot;];
                    //    });
                    //}
                    $(&quot;.PartTypechk&quot;).change(function () {
                        if (LineTPwise != &quot;TP&quot;) {
                            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                                $(&quot;.PartTypechk&quot;).not(this).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, false);
                            }
                        }
                        PartTypeIds = $(&quot;.PartTypechk:checked&quot;).filter(function () {
                            // Check if this checkbox is within a visible .filterclassPT element
                            return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassPT&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
                        }).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.PartTypechk&quot;).length === $(&quot;.PartTypechk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllPartType&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.PartTypechk&quot;).length === $(&quot;.PartTypechk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllPartType&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    if (LineTPwise != &quot;TP&quot;) {
                        if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                            if (PartTypeIds == &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                                $(&quot;.PartTypechk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, false);
                            }
                        }
                        else {
                            $(&quot;#checkAllPartType&quot;).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
                        }
                    }
                    else {
                        $(&quot;.PartTypechk&quot;).prop(&quot;checked&quot;, true);
                    }
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            });
            
        }
        function searchPTpart() {
            var result = false;
            if ($(&quot;#filter&quot;).val() == &quot;&quot;) {
                alert(&quot;please enter a value&quot;);
                searchdata = &quot;&quot;;
            }
            if (searchdata == &quot;&quot;) {
                searchdata = $(&quot;#filter&quot;).val();
            }
            else {
                searchdata = searchdata + &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; + $(&quot;#filter&quot;).val();
            }
            var searchArray = searchdata.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;);
            var re = new RegExp(&quot; , &quot;'&quot; , &quot;^(&quot; , &quot;'&quot; , &quot; + searchArray.join(&quot; , &quot;'&quot; , &quot;|&quot; , &quot;'&quot; , &quot;) + &quot; , &quot;'&quot; , &quot;)&quot; , &quot;'&quot; , &quot;, &quot;i&quot;);

            $(&quot; , &quot;'&quot; , &quot;.filterclassPT&quot; , &quot;'&quot; , &quot;).each(function () {
                var text = $(this).text(),
                    matches = !!text.match(re);
                $(this).toggle(matches);
                if (matches) {
                    result = true;
                }
            });
            PartTypeIds = $(&quot;.PartTypechk:checked&quot;).filter(function () {
                // Check if this checkbox is within a visible .filterclassPT element
                return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassPT&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
            }).map(function () {
                return this.id;
            }).get().join(&quot;,&quot;);
        }
        function resetPTdata() {
            searchdata = &quot;&quot;;
            $(&quot; , &quot;'&quot; , &quot;#filter&quot; , &quot;'&quot; , &quot;).val(&quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);
            $(&quot; , &quot;'&quot; , &quot;.filterclassPT&quot; , &quot;'&quot; , &quot;).each(function () {
                $(this).show();
            });
            //$(&quot; , &quot;'&quot; , &quot;#checkAllPartType&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, true);
        }
        function loadVehicleType() {
            event.preventDefault();
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#chkVehicleTypelist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            Equipment = &quot;0&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
			if (Process == &quot;AllApplication&quot;){
				Equipment = &quot;1&quot;;
			}
            var storeid = $(&quot;#DrpEbay&quot;).val();
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;SubBrandIds&quot;: SubBrandIds,
                &quot;BrandIds&quot;: BrandIds,
                &quot;AdminID&quot;: AdminId,
                &quot;Partdesc&quot;: PartTypeIds,
                &quot;Type&quot;: &quot;Vehicle&quot;,
                &quot;Equipment&quot;: Equipment,
                &quot;VehicleTypeIds&quot;: &quot;&quot;,
                &quot;storeid&quot;: storeid
            }
            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                if (FMP != &quot;true&quot;) {
                    if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        });
                        $(&quot;.loader_main_spin&quot;).hide();
                        return;
                    }

                }
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetVehicleTypeandMake&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    debugger
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
                    var divEdit = $(&quot;#chkVehicleTypelist&quot;);
                    $(&quot;#VTalllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (VehicleTypeIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = VehicleTypeIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassVT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp VehicleTypechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassVT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp VehicleTypechk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassVT&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp VehicleTypechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;VehicleTypeName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (VehicleTypeIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (VehicleTypeIds == &quot;0&quot;) {
                    //            VehicleTypeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                    //        }
                    //        VehicleTypeIds += (VehicleTypeIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;VehicleTypeId&quot; , &quot;'&quot; , &quot;];
                    //    });
                    //}
                    $(&quot;.VehicleTypechk&quot;).change(function () {
                        VehicleTypeIds = $(&quot;.VehicleTypechk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.VehicleTypechk&quot;).length === $(&quot;.VehicleTypechk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllVehicleType&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.VehicleTypechk&quot;).length === $(&quot;.VehicleTypechk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllVehicleType&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            });
            
        }
        function loadMake() {
            event.preventDefault();
			$(&quot;#filterM&quot;).val(&quot;&quot;);
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#chkMakelist&quot;).empty();
            var linecode = $(&quot;#DrpLine&quot;).val();
            var drpinterchange = $(&quot;#drpinterchange1&quot;).val();
            if (drpinterchange == &quot;&quot;) {
                drpinterchange = &quot;0&quot;;
            }
            Equipment = &quot;1&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
            var storeid = $(&quot;#DrpEbay&quot;).val();
            var data = {
                &quot;linecode&quot;: linecode,
                &quot;interchangeid&quot;: drpinterchange,
                &quot;SubBrandIds&quot;: SubBrandIds,
                &quot;BrandIds&quot;: BrandIds,
                &quot;AdminID&quot;: AdminId,
                &quot;Partdesc&quot;: PartTypeIds,
                &quot;Type&quot;: &quot;Make&quot;,
                &quot;Equipment&quot;: Equipment,
                &quot;VehicleTypeIds&quot;: VehicleTypeIds,
                &quot;storeid&quot;: storeid
            }
            if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                if (FMP != &quot;true&quot;) {
                    if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        });
                        $(&quot;.loader_main_spin&quot;).hide();
                        return;
                    }

                }
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetVehicleTypeandMake&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (r) {
                    debugger
                    var divEdit = $(&quot;#chkMakelist&quot;);
                    $(&quot;#Malllist&quot;).show();
                    $.each(r, function (index, value) {
                        if (MakeIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = MakeIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassM&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Makechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassM&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Makechk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass filterclassM&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Makechk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;Makename&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    //if (MakeIds == &quot;0&quot;) {
                    //    $.each(r, function (index, value) {
                    //        if (MakeIds == &quot;0&quot;) {
                    //            MakeIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                    //        }
                    //        MakeIds += (MakeIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + this[&quot; , &quot;'&quot; , &quot;MakeID&quot; , &quot;'&quot; , &quot;];
                    //    });
                    //}
                    $(&quot;.Makechk&quot;).change(function () {
                        MakeIds = $(&quot;.Makechk:checked&quot;).filter(function () {
                            return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassM&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
                        }).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.Makechk&quot;).length === $(&quot;.Makechk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllMake&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.Makechk&quot;).length === $(&quot;.Makechk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllMake&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    $(&quot;.loader_main_spin&quot;).hide();
                }
            });
            //$(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
        }
        function searchMpart() {
            var result = false;
            if ($(&quot;#filterM&quot;).val() == &quot;&quot;) {
                alert(&quot;please enter a value&quot;);
                searchMdata = &quot;&quot;;
            }
            if (searchMdata == &quot;&quot;) {
                searchMdata = $(&quot;#filterM&quot;).val();
            }
            else {
                searchMdata = searchMdata + &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; + $(&quot;#filterM&quot;).val();
            }
            var searchArray = searchMdata.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;);
            var re = new RegExp(&quot; , &quot;'&quot; , &quot;^(&quot; , &quot;'&quot; , &quot; + searchArray.join(&quot; , &quot;'&quot; , &quot;|&quot; , &quot;'&quot; , &quot;) + &quot; , &quot;'&quot; , &quot;)&quot; , &quot;'&quot; , &quot;, &quot;i&quot;);

            $(&quot; , &quot;'&quot; , &quot;.filterclassM&quot; , &quot;'&quot; , &quot;).each(function () {
                var text = $(this).text(),
                    matches = !!text.match(re);
                $(this).toggle(matches);
                if (matches) {
                    result = true;
                }
            });
            MakeIds = $(&quot;.Makechk:checked&quot;).filter(function () {
                return $(this).closest(&quot; , &quot;'&quot; , &quot;.filterclassM&quot; , &quot;'&quot; , &quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;);
            }).map(function () {
                return this.id;
            }).get().join(&quot;,&quot;);
        }
        function resetMdata() {
            searchMdata = &quot;&quot;;
            $(&quot; , &quot;'&quot; , &quot;#filterM&quot; , &quot;'&quot; , &quot;).val(&quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);
            $(&quot; , &quot;'&quot; , &quot;.filterclassM&quot; , &quot;'&quot; , &quot;).each(function () {
                $(this).show();
            });
        }
        function loadRegion() {
            event.preventDefault();
            $(&quot;#chkRegionlist&quot;).empty();
            var data = {}
            var url = WebAPIURL + &quot; , &quot;'&quot; , &quot;loadRegion&quot; , &quot;'&quot; , &quot;;
            if (ReadOnlyDB == &quot;true&quot;) {
                url = WebAPIURLReadOnly + &quot; , &quot;'&quot; , &quot;loadRegion&quot; , &quot;'&quot; , &quot;;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: url,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    var divEdit = $(&quot;#chkRegionlist&quot;);
                    $(&quot;#Ralllist&quot;).show();
                    $.each(data, function (index, value) {
                        if (RegionIds != &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                            var isChecked = RegionIds.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;).includes(String(this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;]));
                            if (isChecked) {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Regionchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            else {
                                var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Regionchk&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            }
                            divEdit.append(rdb);
                        } else {
                            var rdb = &quot;&lt;li class=&quot; , &quot;'&quot; , &quot;filterclass&quot; , &quot;'&quot; , &quot;>&lt;input class=&quot; , &quot;'&quot; , &quot;filterinp Regionchk&quot; , &quot;'&quot; , &quot; checked=&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot; id=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;  type=&quot; , &quot;'&quot; , &quot;checkbox&quot; , &quot;'&quot; , &quot; name=&quot; , &quot;'&quot; , &quot;rbCategories&quot; , &quot;'&quot; , &quot; value=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot; />&lt;label class=&quot; , &quot;'&quot; , &quot;filterlbl&quot; , &quot;'&quot; , &quot; for=&quot; + this[&quot; , &quot;'&quot; , &quot;RegionID&quot; , &quot;'&quot; , &quot;] + &quot;>&quot; + this[&quot; , &quot;'&quot; , &quot;RegionName&quot; , &quot;'&quot; , &quot;] + &quot;&lt;/label>&lt;/li>&quot;;
                            divEdit.append(rdb);
                        }

                    });
                    if (RegionIds == &quot;0&quot;) {
                        RegionIds = &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                        $.each(data, function (index, value) {
                            RegionIds += (RegionIds ? &quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot; : &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) + value.RegionID;
                        });
                    }
                    $(&quot;.Regionchk&quot;).change(function () {
                        RegionIds = $(&quot;.Regionchk:checked&quot;).map(function () {
                            return this.id;
                        }).get().join(&quot;,&quot;);
                        var allChecked = $(&quot;.Regionchk&quot;).length === $(&quot;.Regionchk:checked&quot;).length;
                        $(&quot; , &quot;'&quot; , &quot;#checkAllRegion&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                    });
                    var allChecked = $(&quot;.Regionchk&quot;).length === $(&quot;.Regionchk:checked&quot;).length;
                    $(&quot; , &quot;'&quot; , &quot;#checkAllRegion&quot; , &quot;'&quot; , &quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, allChecked);
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function Tradingchange() {
            var trading = $(&quot;#drptradingpartner&quot;).val();
            //CloseTab();
            //if (LineTPwise != &quot;Line&quot;) {
            //    Loadlinecode();
            //}
            //if ($(&quot;#drptradingpartner&quot;).val() != &quot;-SELECT-&quot;) {
            //    $(&quot;#drpinterchange&quot;).empty();
            //    $(&quot;#drpinterchange1&quot;).val(&quot;&quot;);
            //    $(&quot;#accordion&quot;).show();
            //    $(&quot;#Bottomdata&quot;).show();
            //    LineTPwise = &quot;TP&quot;;
            //}
            //else {
            //    $(&quot;#drpinterchange&quot;).empty();
            //    $(&quot;#accordion&quot;).hide();
            //    $(&quot;#Bottomdata&quot;).hide();
            //}
            if ($(&quot;#drptradingpartner&quot;).val() != &quot;0&quot;) {
                if (LineTPwise != &quot;Line&quot;) {
                    LineTPwise = &quot;TP&quot;;
                }
            }
            else {
                if (LineTPwise != &quot;Line&quot;) {
                    LineTPwise = &quot;&quot;;
                    Loadlinecode();
                }

            }
            if (LineTPwise == &quot;TP&quot;) {
                Loadlinecode();
            }
            if (trading != &quot;0&quot;) {
                $(&quot;#PartExport&quot;).hide();
                $(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, false).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, true);
            }
            else {
                $(&quot;#PartExport&quot;).show();
                $(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;, true).prop(&quot; , &quot;'&quot; , &quot;disabled&quot; , &quot;'&quot; , &quot;, false);
            }
            if (Process == &quot;Amazon&quot; || Process == &quot;Walmart&quot;) {
                $(&quot;#ExcelExport&quot;).hide();
                $(&quot;#CSVExport&quot;).hide();
            }
            Getoverlapdate();
            EnptyChkboxs();
            CloseTab();
        }
        function Getoverlapdate() {
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;Addpopupdetailscount&quot; , &quot;'&quot; , &quot;,
                data: &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;,
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                async: false,
                success: function (data) {
                    var count = data[0].OverlapCount;
                    $(&quot; , &quot;'&quot; , &quot;#getupdatecountvalue&quot; , &quot;'&quot; , &quot;).text(data[0][&quot; , &quot;'&quot; , &quot;LastRunDate&quot; , &quot;'&quot; , &quot;]);
                    $(&quot; , &quot;'&quot; , &quot;#getupdatecount&quot; , &quot;'&quot; , &quot;).text(data[0][&quot; , &quot;'&quot; , &quot;OverlapCount&quot; , &quot;'&quot; , &quot;]);
                    if (count == 0) {
                        $(&quot; , &quot;'&quot; , &quot;#Overlapcheckbox&quot; , &quot;'&quot; , &quot;).hide();
                        $(&quot; , &quot;'&quot; , &quot;#getupdatecountvalue&quot; , &quot;'&quot; , &quot;).text(&quot;Not Run&quot;);
                    }
                },
            });
        }
        function loadSubHeader() {
            $(&quot;#SubmissionType&quot;).empty();
            $(&quot;#PIESSubmissionType&quot;).empty();
            if (Submissiontype == &quot;true&quot;) {
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;2&quot;).text(&quot;Update&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;2&quot;).text(&quot;Update&quot;));
            }
            else {
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;0&quot;).text(&quot;-SELECT-&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;1&quot;).text(&quot;Full&quot;));
            }
            if (P2P == &quot;1&quot;) {
                $(&quot;#SubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;4&quot;).text(&quot;NET CHANGES&quot;));
                $(&quot;#PIESSubmissionType&quot;).append($(&quot;&lt;option/>&quot;).val(&quot;4&quot;).text(&quot;NET CHANGES&quot;));
            }
            $(&quot;#SubmissionType&quot;).val(&quot;1&quot;);
            $(&quot;#PIESSubmissionType&quot;).val(&quot;1&quot;);

        }
        function loadHeaderdetails() {
            event.preventDefault();
            var data = {
                &quot;AdminId&quot;: AdminId
            }
            var apiurl = WebAPIURL + &quot; , &quot;'&quot; , &quot;loadHeaderdetails&quot; , &quot;'&quot; , &quot;;
            if (ReadOnlyDB == &quot;true&quot;) {
                apiurl = WebAPIURLReadOnly + &quot; , &quot;'&quot; , &quot;loadHeaderdetails&quot; , &quot;'&quot; , &quot;;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: apiurl,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    var Table = data.Table;
                    var Table1 = data.Table1;

                    ACompanyName = Table[0][&quot;CompanyName&quot;] ?? &quot;&quot;;
                    ACompanyContact = Table1[0][&quot;ContactName&quot;] ?? &quot;&quot;;
                    AEffectiveDate = Table[0][&quot;EffectiveDate&quot;] ? Table[0][&quot;EffectiveDate&quot;].split(&quot;T&quot;)[0] : &quot;&quot;;
                    Adoctitle = Table[0][&quot;doctitle&quot;] ?? &quot;&quot;;
                    ADocformnumber = Table[0][&quot;Docformnumber&quot;] ?? &quot;&quot;;
                    ASenderCompany = Table[0][&quot;SenderCompany&quot;] ?? &quot;&quot;;
                    ASenderContact = Table1[0][&quot;ContactName&quot;] ?? &quot;&quot;;
                    ASenderPhone = Table1[0][&quot;Phonenumber&quot;] ?? &quot;&quot;;
                    Asenderphoneext = Table[0][&quot;senderphoneext&quot;] ?? &quot;&quot;;
                    Asenderemail = Table1[0][&quot;Email&quot;] ?? &quot;&quot;;
                    AMapperCompany = Table[0][&quot;MapperCompany&quot;] ?? &quot;&quot;;
                    AMapperContact = Table[0][&quot;MapperContact&quot;] ?? &quot;&quot;;
                    AMapperPhone = Table[0][&quot;MapperPhone&quot;] ?? &quot;&quot;;
                    AMapperPhoneext = Table[0][&quot;MapperPhoneext&quot;] ?? &quot;&quot;;
                    AMapperEmail = Table[0][&quot;MapperEmail&quot;] ?? &quot;&quot;;
                    AApprovedfor = Table[0][&quot;Approvedfor&quot;] ?? &quot;&quot;;

                    $(&quot;#CompanyName&quot;).val(ACompanyName);
                    $(&quot;#CompanyContact&quot;).val(ACompanyContact);
                    $(&quot;#EffectiveDate&quot;).val(AEffectiveDate);
                    $(&quot; , &quot;'&quot; , &quot;#DocumentTitle&quot; , &quot;'&quot; , &quot;).val(Adoctitle);
                    $(&quot; , &quot;'&quot; , &quot;#DocumentForm&quot; , &quot;'&quot; , &quot;).val(ADocformnumber);
                    $(&quot; , &quot;'&quot; , &quot;#SenderCompany&quot; , &quot;'&quot; , &quot;).val(ASenderCompany);
                    $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val(ASenderContact);
                    $(&quot; , &quot;'&quot; , &quot;#SenderPhone&quot; , &quot;'&quot; , &quot;).val(ASenderPhone);
                    $(&quot; , &quot;'&quot; , &quot;#SenderPhoneExt&quot; , &quot;'&quot; , &quot;).val(Asenderphoneext);
                    $(&quot; , &quot;'&quot; , &quot;#SenderEmail&quot; , &quot;'&quot; , &quot;).val(Asenderemail);
                    $(&quot; , &quot;'&quot; , &quot;#MapperCompany&quot; , &quot;'&quot; , &quot;).val(AMapperCompany);
                    $(&quot; , &quot;'&quot; , &quot;#MapperContact&quot; , &quot;'&quot; , &quot;).val(AMapperContact);
                    $(&quot; , &quot;'&quot; , &quot;#MapperPhone&quot; , &quot;'&quot; , &quot;).val(AMapperPhone);
                    $(&quot; , &quot;'&quot; , &quot;#MapperPhoneExt&quot; , &quot;'&quot; , &quot;).val(AMapperPhoneext);
                    $(&quot; , &quot;'&quot; , &quot;#MapperEmail&quot; , &quot;'&quot; , &quot;).val(AMapperEmail);
                    $(&quot; , &quot;'&quot; , &quot;#txtapprove&quot; , &quot;'&quot; , &quot;).val(AApprovedfor);
                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function loadPIESHeaderdetails() {
            event.preventDefault();
            var data = {
                &quot;state&quot;: Services,
                &quot;AdminId&quot;: AdminId
            }
            var apiurl = WebAPIURL + &quot; , &quot;'&quot; , &quot;loadPIESHeaderdetails&quot; , &quot;'&quot; , &quot;;
            if (ReadOnlyDB == &quot;true&quot;) {
                apiurl = WebAPIURLReadOnly + &quot; , &quot;'&quot; , &quot;loadPIESHeaderdetails&quot; , &quot;'&quot; , &quot;;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: apiurl,
                data: JSON.stringify(data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                dataType: &quot;json&quot;,
                success: function (data) {
                    var Table = data.Table;
                    var Table1 = data.Table1;

                    PContactName = Table1[0][&quot;ContactName&quot;] ?? &quot;&quot;;
                    PContactEmail = Table1[0][&quot;Email&quot;] ?? &quot;&quot;;
                    $(&quot;#ContactName&quot;).val(PContactName);
                    $(&quot;#ContactEmail&quot;).val(PContactEmail);

                    PCompany = Table[0][&quot;CompanyName&quot;] ?? &quot;&quot;;
                    PPLA = Table[0][&quot;PLA&quot;] ?? &quot;&quot;;
                    PVendorNumber = Table[0][&quot;VendorNumber&quot;] ?? &quot;&quot;;
                    PPIESSubmissionType = Table[0][&quot;PIESSubmissionType&quot;] ?? &quot;&quot;;
                    PPriceSheetNum = Table[0][&quot;PriceSheetNum&quot;] ?? &quot;&quot;;
                    PBlanketEffectiveDate = Table[0][&quot;BlanketEffectiveDate&quot;]? Table[0][&quot;BlanketEffectiveDate&quot;].split(&quot;T&quot;)[0]: &quot;&quot;;

                    $(&quot;#CompanyNamePIES&quot;).val(PCompany);
                    $(&quot;#ProdLineAbbr&quot;).val(PPLA);
                    $(&quot;#Vendor&quot;).val(PVendorNumber);

                    // Select the matching option for submission type, safely
                    $(&quot;#PIESSubmissionType option&quot;).each(function () {
                        if ($(this).text() === PPIESSubmissionType) {
                            $(this).prop(&quot;selected&quot;, true);
                        }
                    });

                    $(&quot;#PriceSheet&quot;).val(PPriceSheetNum);
                    $(&quot;#PIESEffectiveDate&quot;).val(PBlanketEffectiveDate);

                },
                error: function (x, t, m) {
                    if (t === &quot;timeout&quot;) {
                        alert(&quot;Request timed out. Please contact system administrator&quot;);
                    } else {
                        alert(t);
                    }
                }
            });
        }
        function getExcel() {
            if (Process == &quot;PIES&quot;) {
                if (LineTPwise == &quot;Line&quot;) {
                    if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                        if (FMP != &quot;true&quot;) {
                            var isOpen = $(&quot;#accordion h3&quot;).eq(3).next().is(&quot;:visible&quot;);
                            if (!isOpen) {
                                $(&quot;#accordion h3&quot;).eq(3).click();
                            }
                            if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                                Swal.fire({
                                    icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                                    title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                                    allowOutsideClick: false,
                                    allowEscapeKey: false,
                                });
                                $(&quot;.loader_main_spin&quot;).hide();
                                return;
                            }
                            
                        }
                    }
                }
                Generate_PiesExportExcel();
            }
            if (Process == &quot;AllApplication&quot;) {
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    if (FMP != &quot;true&quot;) {
                        var isOpen = $(&quot;#accordion h3&quot;).eq(3).next().is(&quot;:visible&quot;);
                        if (!isOpen) {
                            $(&quot;#accordion h3&quot;).eq(3).click();
                        }
                        if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                            Swal.fire({
                                icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                                title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                                allowOutsideClick: false,
                                allowEscapeKey: false,
                            });
                            $(&quot;.loader_main_spin&quot;).hide();
                            return;
                        }
                        
                    }
                }
                Generate_All_ApplicationExcel();
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                GenerateQDBRawExportExcel();
            }
            if (Process == &quot;ACESwithRawNote&quot;) {
                GenerateQDBRawExportExcel();
            }
            if (Process == &quot;Ebay&quot;) {
                GenerateEbayExcel();
            }
        }
        function getcsv() {
            if (Process == &quot;AllApplication&quot;) {
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    if (FMP != &quot;true&quot;) {
                        var isOpen = $(&quot;#accordion h3&quot;).eq(3).next().is(&quot;:visible&quot;);
                        if (!isOpen) {
                            $(&quot;#accordion h3&quot;).eq(3).click();
                        }
                        if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                            Swal.fire({
                                icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                                title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                                allowOutsideClick: false,
                                allowEscapeKey: false,
                            });
                            $(&quot;.loader_main_spin&quot;).hide();
                            return;
                        }
                        
                    }
                }
                Generate_All_ApplicationCSV();
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                GenerateQDBRawExportCSV();
            }
            if (Process == &quot;ACESwithRawNote&quot;) {
                GenerateQDBRawExportCSV();
            }
        }
        function getxml() {
            if (Process == &quot;PIES&quot; || Process == &quot;WalmartPIES&quot;) {
                if ($(&quot;#DrpLine&quot;).val() == &quot;0&quot;) {
                    if (PartTypeIds == &quot;&quot; || PartTypeIds == &quot;0&quot;) {
                        Swal.fire({
                            icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                            title: &quot;Please select only one Part Description when All Lines are selected&quot;,
                            allowOutsideClick: false,
                            allowEscapeKey: false,
                        });
                        $(&quot;.loader_main_spin&quot;).hide();
                        return;
                    }
                }
                Generate_PiesXML();
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                ExportFTP = &quot;&quot;;
                if (customizedflag == &quot;1&quot;) {
                    GenerateACESXML();
                } else {
                    openPopup();
                }
                
            }
            if (Process == &quot;ACESwithRawNote&quot;) {
                ExportFTP = &quot;&quot;;
                if (customizedflag == &quot;1&quot;) {
                    GenerateACESXML();
                } else {
                    openPopup();
                }
            }
            if (Process == &quot;Amazon&quot;) {
                ExportFTP = &quot;&quot;;
                GenerateACESXML();
            }
            if (Process == &quot;Walmart&quot;) {
                ExportFTP = &quot;&quot;;
                GenerateACESXML();
            }

        }
        function getxmltoftp() {
            ExportFTP = &quot;Yes&quot;;
            GenerateACESXML();
        }
        function Generate_PiesExportExcel() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var companyname = $(&quot;#CompanyNamePIES&quot;).val();
            companyname = companyname.replace(/[^A-Z0-9-_ ]/ig, &quot;&quot;);
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var SelectAllPartPiessxl = &quot;0&quot;;
            var Partdes = PartTypeIds;
            var MfrName = $(&quot;#DrpLine option:selected&quot;).text();
            MfrName = MfrName.split(&quot;|&quot;);
            MfrName = MfrName[0].trim();
            var ProductLine = SubPLine;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();

            if (Line != &quot;0&quot;) {

                if (Line == &quot;-SELECT-&quot;) {
                    alert(&quot;Please Select Line !!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
                if (Brand == &quot;&quot;) {
                    alert(&quot;Please Select BrandName!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
                if (ChkSubProdLineAlert == &quot;true&quot;) {
                    if (ProductLine == &quot;&quot;) {
                        alert(&quot;Please Select Sub Product Line!&quot;);
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        return false;
                    }
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }

            if (ProductLine == &quot;&quot;) {
                ProductLine = &quot;0&quot;;
            }

            if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                SelectAllPartPiessxl = &quot;1&quot;;
            }
            var unit = &quot;Unit&quot;;
            if (hdUnitComp == &quot;1&quot;) {
                unit = $(&quot;#Unitcomp option:selected&quot;).text();
            }
            var Filename = &quot;&quot;;

            var _data = {
                &quot;CompanyName&quot;: &quot;companyname&quot;,
                &quot;Piess&quot;: &quot;EPI&quot;,
                &quot;MfrBrandId&quot;: Line,
                &quot;MfrName&quot;: MfrName,
                &quot;PartDescriptionId&quot;: Partdes,
                &quot;BrandAAIAID&quot;: Brand,
                &quot;Productline&quot;: ProductLine,
                &quot;SelectAllParts&quot;: SelectAllPartPiessxl,
                &quot;AdminId&quot;: AdminId,
                &quot;Competitor&quot;: Competitor,
                &quot;Tradingpartner&quot;: Tradingpartner,
                &quot;UnitComponent&quot;: unit,
                &quot;Filename&quot;: Filename,
                &quot;BrandSubbrand&quot;: BrandSubbrand

            }
            if (ACESPIESQueue == &quot;false&quot;) {

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GeneratePIESExcelExportNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

            }
            else if (ACESPIESQueue == &quot;true&quot;) {

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SavePiesExportexceldataNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Fail&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                return false;
            }

        }
        function Generate_PiesXML() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var companyname = $(&quot;#CompanyNamePIES&quot;).val().trim();
            companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
            if (typeof companyname === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companyname === null || companyname === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                companyname = PCompany;  
            }
            var Pla = $(&quot;#PLA&quot;).val().trim();
            if (typeof Pla === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || Pla === null || Pla === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                Pla = PPLA || &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
            }
            var VendorNumber = $(&quot;#Vendor&quot;).val();
            if (typeof VendorNumber === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || VendorNumber === null || VendorNumber === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                VendorNumber = PVendorNumber;
            }
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            if (typeof drpSubmissionType === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || drpSubmissionType === null || drpSubmissionType === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                drpSubmissionType = &quot;Full&quot;;
            }
            var ContactPies = $(&quot;#ContactName&quot;).val();
            ContactPies = ContactPies.replace(/[&lt;>]/ig, &quot;&quot;);
            if (typeof ContactPies === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || ContactPies === null || ContactPies === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                ContactPies = PContactName;
            }
            var Email = $(&quot;#ContactEmail&quot;).val();
            if (typeof Email === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || Email === null || Email === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                Email = PContactEmail;
            }
            var EDate = $(&quot;#PIESEffectiveDate&quot;).val();
            if (typeof EDate === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || EDate === null || EDate === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                EDate = PBlanketEffectiveDate;
            }
            var PriceSheetNum = $(&quot;#PriceSheet&quot;).val();
            if (typeof PriceSheetNum === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || PriceSheetNum === null || PriceSheetNum === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                PriceSheetNum = PPriceSheetNum;
            }

            var ProductLine = SubPLine;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Partdes = PartTypeIds;

            var SelectAllPartPiessxml = &quot;1&quot;;
            if (ProductLine == &quot;&quot;) {
                ProductLine = &quot;0&quot;;
            }
            if (Process != &quot;WalmartPIES&quot;) {
                if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                    SelectAllPartPiessxml = &quot;1&quot;;
                }
                else {
                    SelectAllPartPiessxml = &quot;0&quot;;
                }
            }
            var piesname = &quot;&quot;;
            var Tradingpartner = &quot;0&quot;;
            if (Process == &quot;WalmartPIES&quot;) {
                piesname = &quot;WAL&quot;;
                piesname = &quot;Walmart PIES&quot;;
            }
            else if (Process == &quot;PIES&quot;) {
                piesname = &quot;EPI&quot;;
                if (TradingPartnerwebconfig == &quot;true&quot;) {
                    var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
                }
                else {
                    var Tradingpartner = &quot;0&quot;;
                }
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;

            var txtUptodate = &quot;&quot;
            var txtFromDate = &quot;&quot;
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == &quot;&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (companyname == &quot;&quot; || companyname == undefined) {
                alert(&quot;Please enter the company name!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ContactPies == &quot;&quot; || ContactPies == undefined) {
                alert(&quot;Please enter the Contact Name!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Email == &quot;&quot; || Email == undefined) {
                alert(&quot;Please enter the Contact Email!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (EDate == &quot;&quot; || EDate == undefined) {
                alert(&quot;Please enter the Effective Date!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (PriceSheetNum == &quot;&quot; || PriceSheetNum == undefined) {
                alert(&quot;Please enter the Price Sheet #&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (drpSubmissionType == &quot;0&quot; || drpSubmissionType == undefined) {
                alert(&quot;Please select the Submission Type!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            var _data = {
                &quot;Line&quot;: Line,
                &quot;Brand&quot;: Brand,
                &quot;BrandSubbrand&quot;: BrandSubbrand,
                &quot;SubProductLine&quot;: ProductLine,
                &quot;Partdescription&quot;: Partdes,
                &quot;SelectAllPartPiessxml&quot;: SelectAllPartPiessxml,
                &quot;companyname&quot;: companyname,
                &quot;Pla&quot;: Pla,
                &quot;VendorNumber&quot;: VendorNumber,
                &quot;drpSubmissionType&quot;: drpSubmissionType,
                &quot;ContactPies&quot;: ContactPies,
                &quot;Email&quot;: Email,
                &quot;EDate&quot;: EDate,
                &quot;PriceSheetNum&quot;: PriceSheetNum,
                &quot;AdminId&quot;: AdminId,
                &quot;piesname&quot;: piesname,
                &quot;TradingPartner&quot;: Tradingpartner,
                &quot;Competitor&quot;: Competitor,
                &quot;Units&quot;: Units,
                &quot;Comp&quot;: Comp
            }

            if (ACESPIESQueue == &quot;false&quot;) {
                var dataxml = {
                    &quot;acespies&quot;: &quot;Pies&quot;,
                }
                $.ajax({
                    type: &quot;POST&quot;, 
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;queuecheckxmlPermission&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(dataxml),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        if (response == &quot; , &quot;'&quot; , &quot;&quot;Yes&quot;&quot; , &quot;'&quot; , &quot;) {
                            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                            alert(&quot;An XML file creation is in progress for another user. Please try after some time.&quot;);
                        } else {
                            $.ajax({
                                type: &quot;POST&quot;,
                                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GeneratePIESXMLExportNew&quot; , &quot;'&quot; , &quot;,
                                data: JSON.stringify(_data),
                                contentType: &quot;application/json; charset=utf-8&quot;,
                                success: function (response) {
                                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                    var data = JSON.parse(response);
                                    var count = data.Count;
                                    var name = data.Name;
                                    var result = data.Result;
                                    let services = piesname;

                                    if (piesname === &quot;Walmart PIES&quot;) {
                                        services = &quot;WAL&quot;;
                                    }
                                    const sanitizedName = name.replace(/[^a-zA-Z0-9-_ ]+/g, &quot;&quot;);
                                    const fullURL = `downloadPiesXml.aspx?Services=${services}&amp;company=${sanitizedName}`;
                                    if (count != &quot;0&quot;) {
                                        if (result == &quot;Success&quot;) {
                                            window.open(fullURL, &quot; , &quot;'&quot; , &quot;_blank&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px&quot; , &quot;'&quot; , &quot;);
                                        }
                                        else {
                                            alert(&quot;Run Api mode contact administator&quot;);
                                        }
                                    }
                                    else {
                                        alert(&quot;There is no data for this criteria&quot;);
                                    }


                                },
                                error: function () {

                                    alert(&quot;Failed!&quot;)
                                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                }
                            })
                        }
                    },
                    error: function () {
                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                });
            }
            else if (ACESPIESQueue == &quot;true&quot;) {               
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SavePiesExportxmldataNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {

                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function (err) {
                        console.log(err);
                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                return false;
            }

        }
        function Generate_All_ApplicationExcel() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;-SELECT-&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            } 

            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Vehicle == &quot;&quot;) {
                alert(&quot;Select atleast one Vehicle!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Make == &quot;&quot;) {
                alert(&quot;Select atleast one Make!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;AllApplicaionExcelExportQueueNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
                //------------------  Queue end --------------------//
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;AllApplicaionExcelExport&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }

        }
        function Generate_All_ApplicationCSV() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;-SELECT-&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }

            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Vehicle == &quot;&quot;) {
                alert(&quot;Select atleast one Vehicle!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Make == &quot;&quot;) {
                alert(&quot;Select atleast one Make!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;AllApplicaionExcelExportQueueNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
                //------------------  Queue end --------------------//
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;Productline&quot;: ProductLine,
                    &quot;Line&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;BrandName&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;MakeId&quot;: Make,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;AdminId&quot;: AdminId,
                    &quot;CustomAllApplication&quot;: CustomAllApplication,
                    &quot;AllApplicationTitle&quot;: AllApplicationTitle,
                    &quot;IncludeCustomValue&quot;: IncludeCustomValue
                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;AllApplicaionExcelExport&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }

        }
        function GenerateQDBRawExportExcel() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;

            var companyname = $(&quot;#CompanyNamePIES&quot;).val();
            companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var Tradingpartner = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;True&quot; : &quot;False&quot;;
                
            }
            var ACES = &quot;ACES&quot;;
            var Customer = 0;
            var ChkAlloverlap = 0;
            var SelectAllPartsxl = &quot;0&quot;;
            if ($(&quot;#overlapchk&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
            var ChkACESNotes = &quot;&quot;;
            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;exportFormat&quot;]:checked&quot; , &quot;'&quot; , &quot;).val() || &quot;4.2&quot;;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                ChkACESNotes = &quot;ACES with QDB Codes&quot;
            }
            else {
                Qualifierid = &quot;False&quot;;
                ChkACESNotes = &quot;ACES with Raw Notes&quot;
            }
            

            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;0&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var capitalcust = hdCapital;
            var IncludeCustomevalue = IncludeCustomValue;
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;ACESQDBRawNotesExcelExportQueueNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }
                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

                // -----------------End Queue Process ------------
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Excel&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetACESQDBRawNotesExportNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

            }
        }
        function GenerateQDBRawExportCSV() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;

            var companyname = $(&quot;#CompanyNamePIES&quot;).val();
            companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
            var drpSubmissionType = $(&quot;#PIESSubmissionType option:selected&quot;).text();
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var Tradingpartner = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;True&quot; : &quot;False&quot;;

            }
            var ACES = &quot;ACES&quot;;
            var Customer = 0;
            var ChkAlloverlap = 0;
            var SelectAllPartsxl = 0;
            if ($(&quot;#overlapchk&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
            var ChkACESNotes = &quot;&quot;;
            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;exportFormat&quot;]:checked&quot; , &quot;'&quot; , &quot;).val()||&quot;4.2&quot;;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                ChkACESNotes = &quot;ACES with QDB Codes&quot;
            }
            else {
                Qualifierid = &quot;False&quot;;
                ChkACESNotes = &quot;ACES with Raw Notes&quot;
            }


            var Partdes = PartTypeIds;
            var Brand = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;

            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            var LineCode = $(&quot;#DrpLine option:selected&quot;).text();
            LineCode = LineCode.split(&quot;|&quot;);
            LineCode = LineCode[0].trim();
            if (Line == &quot;0&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (Brand == &quot;&quot;) {
                alert(&quot;Please Select BrandName!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (ChkSubProdLineAlert == &quot;true&quot;) {
                if (ProductLine == &quot;&quot;) {
                    alert(&quot;Please Select Sub Product Line!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var capitalcust = hdCapital;
            var IncludeCustomevalue = IncludeCustomValue;
            if (ACESPIESQueue == &quot;true&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;ACESQDBRawNotesExcelExportQueueNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        if (msg == &quot;Success&quot;) {
                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);
                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }
                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

                // -----------------End Queue Process ------------
            }
            else if (ACESPIESQueue == &quot;false&quot;) {
                var _data = {
                    &quot;CompanyName&quot;: companyname,
                    &quot;strACES&quot;: ACES,
                    &quot;strType&quot;: drpSubmissionType,
                    &quot;Customerid&quot;: Customer.toString(),
                    &quot;Brand&quot;: Line,
                    &quot;MfrName&quot;: LineCode,
                    &quot;Unit&quot;: Units.toString(),
                    &quot;MakeId&quot;: Make,
                    &quot;PartDescription&quot;: Partdes,
                    &quot;VehicleType&quot;: Vehicle,
                    &quot;region&quot;: region,
                    &quot;comp&quot;: Comp.toString(),
                    &quot;Brandname&quot;: Brand,
                    &quot;SubBrandName&quot;: BrandSubbrand,
                    &quot;Productline&quot;: ProductLine,
                    &quot;Qualifier&quot;: Qualifierid,
                    &quot;Competitorid&quot;: Competitor,
                    &quot;ExportType&quot;: &quot;Csv&quot;,
                    &quot;ChkQDBRaw&quot;: ChkACESNotes,
                    &quot;SelectAllParts&quot;: SelectAllPartsxl.toString(),
                    &quot;AdminId&quot;: AdminId,
                    &quot;Tradingpartner&quot;: Tradingpartner,
                    &quot;Equipment&quot;: Equipment,
                    &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                    &quot;AcesOverpopulate&quot;: Overpopulate.toString(),
                    &quot;CapitalCustomer&quot;: capitalcust.toString(),
                    &quot;IncludeCustomValue&quot;: IncludeCustomevalue

                }

                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetACESQDBRawNotesExportNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {
                            //alert(response.d);
                            window.location.href = &quot;Default.aspx&quot;;

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

            }
        }
        function openPopup() {
            event.preventDefault();
            $(&quot; , &quot;'&quot; , &quot;#modal_pop1&quot; , &quot;'&quot; , &quot;).show();
            $(&quot;#modal_pop1&quot;).dialog({
                width: 800,
                iframeFix: true,
                close: function () {
                    $(&quot; , &quot;'&quot; , &quot;.backgroud_fixed&quot; , &quot;'&quot; , &quot;).hide();
                },
                buttons: {
                    YES: function btnsave_Click() {
                        Checkoutputcustom();
                        $(this).dialog(&quot;close&quot;);
                    },
                    NO: function Direct_Click() {
                        GenerateACESXML();
                        $(this).dialog(&quot;close&quot;);
                    }
                }
            });

            return true;
        }
        function Checkoutputcustom() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var ExportType = hdExportType;
            var companyname = $(&quot;#CompanyName&quot;).val();
            if (typeof companyname === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companyname === null || companyname === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                companyname = ACompanyName;
            }
            var companycontact = $(&quot;#CompanyContact&quot;).val();
            if (typeof companycontact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companycontact === null || companycontact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                companycontact = ACompanyContact;
            }
            var txtEffectiveDate1 = $(&quot;#EffectiveDate&quot;).val();
            if (typeof txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtEffectiveDate1 === null || txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtEffectiveDate1 = AEffectiveDate;
            }
            var txtDocTitle = $(&quot; , &quot;'&quot; , &quot;#DocumentTitle&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtDocTitle === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocTitle === null || txtDocTitle === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtDocTitle = Adoctitle;
            }
            var cblapprovedfor = $(&quot; , &quot;'&quot; , &quot;#txtapprove&quot; , &quot;'&quot; , &quot;).val();
            if (typeof cblapprovedfor === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || cblapprovedfor === null || cblapprovedfor === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                cblapprovedfor = AApprovedfordata;
            }
            var txtSenderCompany = $(&quot; , &quot;'&quot; , &quot;#SenderCompany&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderCompany === null || txtSenderCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderCompany = ASenderCompany;
            }
            var txtSenderPhone = $(&quot; , &quot;'&quot; , &quot;#SenderPhone&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhone === null || txtSenderPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderPhone = ASenderPhone;
            }
            var txtSenderEmail = $(&quot; , &quot;'&quot; , &quot;#SenderEmail&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderEmail === null || txtSenderEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderEmail = Asenderemail;
            }
            var txtMapperCompany = $(&quot; , &quot;'&quot; , &quot;#MapperCompany&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperCompany === null || txtMapperCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperCompany = AMapperCompany;
            }
            var txtMapperPhone = $(&quot; , &quot;'&quot; , &quot;#MapperPhone&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhone === null || txtMapperPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperPhone = AMapperPhone;
            }
            var txtMapperEmail = $(&quot; , &quot;'&quot; , &quot;#MapperEmail&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperEmail === null || txtMapperEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperEmail = AMapperEmail;
            }
            var txtContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtContact === null || txtContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtContact = ASenderContact;
            }
            var drpSubmissionType = $(&quot;#SubmissionType option:selected&quot;).text();
            if (typeof drpSubmissionType === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || drpSubmissionType === null || drpSubmissionType === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                drpSubmissionType = &quot;FULL&quot;;
            }
            var txtDocFormNo = $(&quot; , &quot;'&quot; , &quot;#DocumentForm&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtDocFormNo === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocFormNo === null || txtDocFormNo === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtDocFormNo = ADocformnumber;
            }
            var txtSenderContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderContact === null || txtSenderContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderContact = ASenderContact;
            }
            var txtSenderPhoneExt = $(&quot; , &quot;'&quot; , &quot;#SenderPhoneExt&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhoneExt === null || txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderPhoneExt = Asenderphoneext;
            }
            var txtMapperContact = $(&quot; , &quot;'&quot; , &quot;#MapperContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperContact === null || txtMapperContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperContact = AMapperContact;
            }
            var txtMapperPhoneExt = $(&quot; , &quot;'&quot; , &quot;#MapperPhoneExt&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhoneExt === null || txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperPhoneExt = AMapperPhoneext;
            }
            if (hdbrand == &quot;false&quot;) {
                var BrandAAIAIDHeader = &quot;&quot;;
            }
            else {
                var BrandAAIAIDHeader = $(&quot;#txtbrandid&quot;).val();
                if (BrandAAIAIDHeader != &quot;&quot; &amp;&amp; BrandAAIAIDHeader.length &lt; 4) {
                    alert(&quot;Brand AAIAID must have 4 characters&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
                var regex = /^[a-zA-Z]+$/;
                if (!regex.test(BrandAAIAIDHeader)) {
                    alert(&quot;Invalid BrandID&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }

            var date = txtEffectiveDate1;
            //var txtEffectiveDate = &quot;&quot;;
            //txtEffectiveDate = (date.substr(6, 4) + &quot;-&quot; + date.substr(0, 2) + &quot;-&quot; + date.substr(3, 2));
            txtEffectiveDate = txtEffectiveDate1;


            var Qualifier = &quot;&quot;;
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifier = true;
            }
            else {
                Qualifier = false;
            }
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                alert(&quot;Please select Line&quot;);
                return false;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;True&quot; : &quot;False&quot;;
            }
            var ChkAlloverlap = 0;
            if ($(&quot;#overlapchk&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;group_header&quot;]:checked&quot; , &quot;'&quot; , &quot;).val() || &quot; , &quot;'&quot; , &quot;Both&quot; , &quot;'&quot; , &quot;;
            }
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                var Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            else {
                var Tradingpartner = &quot;0&quot;;
            }
            var SelectAllPartsxl = &quot;0&quot;;
            if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var CustomerId = 0;
            var PartDescriptionId = PartTypeIds;
            var BrandIDs = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var makename = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;
            if (BrandIDs == &quot;&quot;) {
                alert(&quot;Please select Brand&quot;);
                return false;
            }
            if (companyname == &quot;&quot;) {
                alert(&quot;Please select  Company Name&quot;);
                return false;
            }
            if (companycontact == &quot;&quot;) {
                alert(&quot;Please select  Company Contact&quot;);
                return false;
            }
            if (date == &quot;&quot;) {
                alert(&quot;Please select Effective Date&quot;);
                return false;
            }
            if (txtDocTitle == &quot;&quot;) {
                alert(&quot;Please select Document Title&quot;);
                return false;
            }
            if (txtSenderPhone == &quot;&quot;) {
                alert(&quot;Please select Sender Phone&quot;);
                return false;
            }
            if (txtSenderContact == &quot;&quot;) {
                alert(&quot;Please select Sender Contact&quot;);
                return false;
            }
            if (txtContact == &quot;&quot;) {
                alert(&quot;Please select Company Contact &quot;);
                return false;
            }
            if (drpSubmissionType == &quot;0&quot;) {
                alert(&quot;Please select Submission Type &quot;);
                return false;
            }
            if (PartDescriptionId == &quot;&quot;) {
                alert(&quot;Please select atleast 1 Part Description(s)&quot;);
                return false;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                var Acesname = &quot;ACES with QDB Codes&quot;
            }
            else if (Process == &quot;ACESwithRawNote&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;ACES with Raw Notes&quot;
            }
            var ExporttoFTP = &quot;&quot;;
            var path = window.location.href.replace(window.location.hostname + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(window.location.protocol + &quot; , &quot;'&quot; , &quot;//&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(window.location.search, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(&quot; , &quot;'&quot; , &quot;:&quot; , &quot;'&quot; , &quot; + window.location.port, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;)
            var sitename = path.substring(0, path.indexOf(&quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;));
            if (sitename == &quot; , &quot;'&quot; , &quot;localhost&quot; , &quot;'&quot; , &quot;) {
                sitename = &quot;&quot;;
            }
            else if (sitename == &quot; , &quot;'&quot; , &quot;APAPMTTEST&quot; , &quot;'&quot; , &quot;) {
                sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
            }
            else if (sitename == &quot; , &quot;'&quot; , &quot;Youtechpmt&quot; , &quot;'&quot; , &quot;) {
                sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
            }
            else {
                //sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
                sitename = &quot;&quot;;
            }

            debugger
            var AcesExportVersion = &quot;&quot;;
            var ObjData = {
                &quot;Line&quot;: Line,
                &quot;Equipment&quot;: Equipment.toString(),
                &quot;Competitorid&quot;: Competitor,
                &quot;Unit&quot;: Units.toString(),
                &quot;comp&quot;: Comp.toString(),
                &quot;Tradingpartner&quot;: Tradingpartner,
                &quot;Brandname&quot;: BrandIDs,
                &quot;SubBrandName&quot;: BrandSubbrand,
                &quot;Productline&quot;: ProductLine,
                &quot;PartDescription&quot;: PartDescriptionId,
                &quot;SelectAllParts&quot;: SelectAllPartsxl,
                &quot;VehicleType&quot;: Vehicle,
                &quot;MakeId&quot;: makename,
                &quot;region&quot;: region,
                &quot;CompanyName&quot;: companyname,
                &quot;AdminId&quot;: AdminId,
                &quot;Contact&quot;: txtContact,
                &quot;EffectiveDate&quot;: txtEffectiveDate,
                &quot;drpSubmissionType&quot;: drpSubmissionType,
                &quot;DocTitle&quot;: txtDocTitle,
                &quot;DocFormNo&quot;: txtDocFormNo,
                &quot;Approvedfor&quot;: cblapprovedfor,
                &quot;SenderCompany&quot;: txtSenderCompany,
                &quot;SenderContact&quot;: txtSenderContact,
                &quot;SenderPhone&quot;: txtSenderPhone,
                &quot;SenderPhoneExt&quot;: txtSenderPhoneExt,
                &quot;SenderEmail&quot;: txtSenderEmail,
                &quot;MapperCompany&quot;: txtMapperCompany,
                &quot;MapperContact&quot;: txtMapperContact,
                &quot;MapperPhone&quot;: txtMapperPhone,
                &quot;MapperPhoneExt&quot;: txtMapperPhoneExt,
                &quot;MapperEmail&quot;: txtMapperEmail,
                &quot;BrandID&quot;: BrandAAIAIDHeader,
                &quot;Acesname&quot;: Acesname,
                &quot;strACES&quot;: &quot;Aces&quot;,
                &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                &quot;AcesOverpopulate&quot;: Overpopulate,
                &quot;ExporttoFTP&quot;: ExporttoFTP
            }
            //var ObjData = &quot; , &quot;'&quot; , &quot;{&quot;PartDescriptionId&quot;: &quot;&quot; , &quot;'&quot; , &quot; + PartDescription + &quot; , &quot;'&quot; , &quot;&quot;, &quot;ACES&quot;: &quot;ACES&quot;,&quot;SP&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Sp + &quot; , &quot;'&quot; , &quot;&quot;, &quot;CustomerId&quot;: &quot;&quot; , &quot;'&quot; , &quot; + CustomerId + &quot; , &quot;'&quot; , &quot;&quot;, &quot;LineNo&quot;: &quot;&quot; , &quot;'&quot; , &quot; + Line + &quot; , &quot;'&quot; , &quot;&quot;, &quot;Brandss&quot;: &quot;&quot; , &quot;'&quot; , &quot; + Brandssss + &quot; , &quot;'&quot; , &quot;&quot;,&quot;productliness&quot;: &quot;&quot; , &quot;'&quot; , &quot; + productliness + &quot; , &quot;'&quot; , &quot;&quot;, &quot;Vehicless&quot;: &quot;&quot; , &quot;'&quot; , &quot; + Vehicles + &quot; , &quot;'&quot; , &quot;&quot;, &quot;makenamess&quot;: &quot;&quot; , &quot;'&quot; , &quot; + makenames + &quot; , &quot;'&quot; , &quot;&quot;, &quot;companyname&quot;: &quot;&quot; , &quot;'&quot; , &quot; + companyname + &quot; , &quot;'&quot; , &quot;&quot;, &quot;txtEffectiveDate&quot;: &quot;&quot; , &quot;'&quot; , &quot; + txtEffectiveDate + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtDocTitle&quot;: &quot;&quot; , &quot;'&quot; , &quot; + txtDocTitle + &quot; , &quot;'&quot; , &quot;&quot;, &quot;cblapprovedfor&quot;: &quot;&quot; , &quot;'&quot; , &quot; + cblapprovedfor + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtSenderCompany&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtSenderCompany + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtSenderPhone&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtSenderPhone + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtSenderEmail&quot;: &quot;&quot; , &quot;'&quot; , &quot; + txtSenderEmail + &quot; , &quot;'&quot; , &quot;&quot;, &quot;txtMapperCompany&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtMapperCompany + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtMapperPhone&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtMapperPhone + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtMapperEmail&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtMapperEmail + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtContact&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtContact + &quot; , &quot;'&quot; , &quot;&quot;,&quot;drpSubmissionType&quot;:&quot;&quot; , &quot;'&quot; , &quot; + drpSubmissionType + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtDocFormNo&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtDocFormNo + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtSenderContact&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtSenderContact + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtMapperContact&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtMapperContact + &quot; , &quot;'&quot; , &quot;&quot;,&quot;txtMapperPhoneExt&quot;:&quot;&quot; , &quot;'&quot; , &quot; + txtMapperPhoneExt + &quot; , &quot;'&quot; , &quot;&quot;,&quot;Qualifier&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Qualifier + &quot; , &quot;'&quot; , &quot;&quot;,&quot;Competitor&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Competitor + &quot; , &quot;'&quot; , &quot;&quot;,&quot;TradingPartner&quot;:&quot;&quot; , &quot;'&quot; , &quot; + TradingPartner + &quot; , &quot;'&quot; , &quot;&quot;,&quot;Equipment&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Equipment + &quot; , &quot;'&quot; , &quot;&quot;,&quot;Class&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Classs + &quot; , &quot;'&quot; , &quot;&quot;,&quot;Acesname&quot;:&quot;&quot; , &quot;'&quot; , &quot; + Acesname + &quot; , &quot;'&quot; , &quot;&quot;,&quot;ACESExportVersion&quot;:&quot;&quot; , &quot;'&quot; , &quot; + AcesExportVersion + &quot; , &quot;'&quot; , &quot;&quot;,&quot;BrandAAIAIDHeader&quot;:&quot;&quot; , &quot;'&quot; , &quot; + BrandAAIAIDHeader + &quot; , &quot;'&quot; , &quot;&quot;}&quot; , &quot;'&quot; , &quot;;
            var obj = 0;
            $.ajax({
                type: &quot;POST&quot;,
                async: false,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetsaveCustomexport&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(ObjData),
                dataType: &quot;JSON&quot;,
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    obj = response;
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return;
                },
                error: function () {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    alert(&quot;Failed!&quot;);
                    //$(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            });

            if (obj > 0) {
                //window.showModalDialog(&quot;/&quot; + sitename + &quot;/Reports/output.aspx&quot; + &quot;?Exportid=&quot; + obj, &quot;_blank&quot;, &quot;dialogWidth:700px; dialogHeight:550px; dialogLeft:450; dialogTop:200; center:1; status:0; help:0&quot;);
                window.open(&quot;../Reports/output.aspx&quot; + &quot;?Exportid=&quot; + obj, &quot;_blank&quot;, &quot;width=700,height=550,left=450,top=200,status=no,menubar=no,toolbar=no&quot;);
                //OpenPartNoPopupExportcustom(sitename + &quot; , &quot;'&quot; , &quot;Reports&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;output.aspx&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot; + PartDescription + &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, ExportType, Ecommerece, Sp, CustomerId, Line, Brandssss, productliness, Vehicles, makenames, companyname, txtEffectiveDate, txtDocTitle, cblapprovedfor, txtSenderCompany, txtSenderPhone, txtSenderEmail, txtMapperCompany, txtMapperPhone, txtMapperEmail, txtContact, drpSubmissionType, txtDocFormNo, txtSenderContact, txtMapperContact, txtMapperPhoneExt, Qualifier, &quot; , &quot;'&quot; , &quot;700&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;550&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;450&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;200&quot; , &quot;'&quot; , &quot;, Competitor, TradingPartner, Equipment, Classs, Acesname, AcesExportVersion, BrandAAIAIDHeader);
            }
            return true;
            ClosePopUp();

        }
        function GenerateACESXML() {
            var companyname = $(&quot;#CompanyName&quot;).val();
            if (typeof companyname === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companyname === null || companyname === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                companyname = ACompanyName;
            }
            var txtEffectiveDate1 = $(&quot;#EffectiveDate&quot;).val();
            if (typeof txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtEffectiveDate1 === null || txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtEffectiveDate1 = AEffectiveDate;
            }
            var txtDocTitle = $(&quot; , &quot;'&quot; , &quot;#DocumentTitle&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtDocTitle === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocTitle === null || txtDocTitle === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtDocTitle = Adoctitle;
            }
            var cblapprovedfor = $(&quot; , &quot;'&quot; , &quot;#txtapprove&quot; , &quot;'&quot; , &quot;).val();
            if (typeof cblapprovedfor === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || cblapprovedfor === null || cblapprovedfor === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                cblapprovedfor = AApprovedfordata;
            }
            var txtSenderCompany = $(&quot; , &quot;'&quot; , &quot;#SenderCompany&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderCompany === null || txtSenderCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderCompany = ASenderCompany;
            }
            var txtSenderPhone = $(&quot; , &quot;'&quot; , &quot;#SenderPhone&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhone === null || txtSenderPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderPhone = ASenderPhone;
            }
            var txtSenderEmail = $(&quot; , &quot;'&quot; , &quot;#SenderEmail&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderEmail === null || txtSenderEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderEmail = Asenderemail;
            }
            var txtMapperCompany = $(&quot; , &quot;'&quot; , &quot;#MapperCompany&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperCompany === null || txtMapperCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperCompany = AMapperCompany;
            }
            var txtMapperPhone = $(&quot; , &quot;'&quot; , &quot;#MapperPhone&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhone === null || txtMapperPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperPhone = AMapperPhone;
            }
            var txtMapperEmail = $(&quot; , &quot;'&quot; , &quot;#MapperEmail&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperEmail === null || txtMapperEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperEmail = AMapperEmail;
            }
            var txtContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtContact === null || txtContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtContact = ASenderContact;
            }
            var drpSubmissionType = $(&quot;#SubmissionType option:selected&quot;).text();
            if (typeof drpSubmissionType === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || drpSubmissionType === null || drpSubmissionType === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                drpSubmissionType = &quot;FULL&quot;;
            }
            var txtDocFormNo = $(&quot; , &quot;'&quot; , &quot;#DocumentForm&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtDocFormNo === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocFormNo === null || txtDocFormNo === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtDocFormNo = ADocformnumber;
            }
            var txtSenderContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderContact === null || txtSenderContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderContact = ASenderContact;
            }
            var txtSenderPhoneExt = $(&quot; , &quot;'&quot; , &quot;#SenderPhoneExt&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhoneExt === null || txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtSenderPhoneExt = Asenderphoneext;
            }
            var txtMapperContact = $(&quot; , &quot;'&quot; , &quot;#MapperContact&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperContact === null || txtMapperContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperContact = AMapperContact;
            }
            var txtMapperPhoneExt = $(&quot; , &quot;'&quot; , &quot;#MapperPhoneExt&quot; , &quot;'&quot; , &quot;).val();
            if (typeof txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhoneExt === null || txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                txtMapperPhoneExt = AMapperPhoneext;
            }
            if (hdbrand == &quot;false&quot;) {
                var BrandAAIAIDHeader = &quot;&quot;;
            }
            else {
                var BrandAAIAIDHeader = $(&quot;#txtbrandid&quot;).val();
                if (BrandAAIAIDHeader != &quot;&quot; &amp;&amp; BrandAAIAIDHeader.length &lt; 4) {
                    alert(&quot;Brand AAIAID must have 4 characters&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
                var regex = /^[a-zA-Z]+$/;
                if (!regex.test(BrandAAIAIDHeader)) {
                    alert(&quot;Invalid BrandID&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }

            var date = txtEffectiveDate1;
            //var txtEffectiveDate = &quot;&quot;;
            //txtEffectiveDate = (date.substr(6, 4) + &quot;-&quot; + date.substr(0, 2) + &quot;-&quot; + date.substr(3, 2));
            txtEffectiveDate = txtEffectiveDate1;

            var Qualifier = &quot;&quot;;
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifier = &quot;true&quot;;
            }
            else {
                Qualifier = &quot;false&quot;;
            }
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == &quot; , &quot;'&quot; , &quot;0&quot; , &quot;'&quot; , &quot;) {
                alert(&quot;Please select Line&quot;);
                return false;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var unit = (hdUnitComp == &quot;1&quot;) ? $(&quot;#Unitcomp option:selected&quot;).text() : &quot;Unit&quot;;
            var Units = (unit === &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Comp = (unit !== &quot;Unit&quot;) ? &quot;1&quot; : &quot;0&quot;;
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;True&quot; : &quot;False&quot;;
            }
            var ChkAlloverlap = 0;
            if ($(&quot;#overlapchk&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                ChkAlloverlap = $(&quot;#overlapchk&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;1&quot; : &quot;0&quot;;
            }
            var exportFormat = &quot;&quot;
            exportFormat = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;exportFormat&quot;]:checked&quot; , &quot;'&quot; , &quot;).val() || &quot;4.2&quot;;

            var Overpopulate = &quot;&quot;;
            if (Export_Overpopulate == &quot;true&quot;) {
                Overpopulate = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;group_header&quot;]:checked&quot; , &quot;'&quot; , &quot;).val() || &quot; , &quot;'&quot; , &quot;Both&quot; , &quot;'&quot; , &quot;;
            }
            var Tradingpartner = &quot;0&quot;;
            if (TradingPartnerwebconfig == &quot;true&quot;) {
                Tradingpartner = $(&quot;#drptradingpartner option:selected&quot;).val();
            }
            if (Tradingpartner == undefined) {
                Tradingpartner = &quot;0&quot;;
            }
            if (Overpopulate == undefined) {
                Overpopulate = &quot;&quot;;
            }
            var SelectAllPartsxl = &quot;0&quot;;
            if ($(&quot;#checkExportSt&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;)) {
                SelectAllPartsxl = &quot;1&quot;;
            }
            var CustomerId = 0;
            var PartDescriptionId = PartTypeIds;
            var BrandIDs = BrandIds;
            var BrandSubbrand = SubBrandIds;
            var Vehicle = VehicleTypeIds;
            var makename = MakeIds;
            var ProductLine = SubPLine;
            var region = RegionIds;
            if (BrandIDs == &quot;&quot;) {
                alert(&quot;Please select Brand&quot;);
                return false;
            }
            if (companyname == &quot;&quot;) {
                alert(&quot;Please select  Company Name&quot;);
                return false;
            }
            if (date == &quot;&quot;) {
                alert(&quot;Please select Effective Date&quot;);
                return false;
            }
            if (txtDocTitle == &quot;&quot;) {
                alert(&quot;Please select Document Title&quot;);
                return false;
            }
            if (txtSenderPhone == &quot;&quot;) {
                alert(&quot;Please select Sender Phone&quot;);
                return false;
            }
            if (txtSenderContact == &quot;&quot;) {
                alert(&quot;Please select Sender Contact&quot;);
                return false;
            }
            if (txtContact == &quot;&quot;) {
                alert(&quot;Please select Company Contact &quot;);
                return false;
            }
            if (drpSubmissionType == &quot;0&quot;) {
                alert(&quot;Please select Submission Type &quot;);
                return false;
            }
            if (PartDescriptionId == &quot;&quot;) {
                alert(&quot;Please select atleast 1 Part Description(s)&quot;);
                return false;
            }
            if (Process == &quot;ACESwithQDB&quot;) {
                Qualifierid = &quot;True&quot;;
                var Acesname = &quot;ACES with QDB Codes&quot;
            }
            else if (Process == &quot;ACESwithRawNote&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;ACES with Raw Notes&quot;
            }
            else if (Process == &quot;Amazon&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;Amazon&quot;
            }
            else if (Process == &quot;Walmart&quot;) {
                Qualifierid = &quot;False&quot;;
                var Acesname = &quot;Walmart&quot;
            }

            if (ExportFTP == &quot;Yes&quot;) {
                var ExporttoFTP = &quot;Yes&quot;;
            }
            else {
                var ExporttoFTP = &quot;&quot;;
            }

            var _data = {
                &quot;Line&quot;: Line,
                &quot;Equipment&quot;: Equipment.toString(),
                &quot;Competitorid&quot;: Competitor,
                &quot;Unit&quot;: Units.toString(),
                &quot;comp&quot;: Comp.toString(),
                &quot;Tradingpartner&quot;: Tradingpartner,
                &quot;Brandname&quot;: BrandIDs,
                &quot;SubBrandName&quot;: BrandSubbrand,
                &quot;Productline&quot;: ProductLine,
                &quot;PartDescription&quot;: PartDescriptionId,
                &quot;SelectAllParts&quot;: SelectAllPartsxl,
                &quot;VehicleType&quot;: Vehicle,
                &quot;MakeId&quot;: makename,
                &quot;region&quot;: region,
                &quot;CompanyName&quot;: companyname,
                &quot;AdminId&quot;: AdminId,
                &quot;Contact&quot;: txtContact,
                &quot;EffectiveDate&quot;: txtEffectiveDate,
                &quot;drpSubmissionType&quot;: drpSubmissionType,
                &quot;DocTitle&quot;: txtDocTitle,
                &quot;DocFormNo&quot;: txtDocFormNo,
                &quot;Approvedfor&quot;: cblapprovedfor,
                &quot;SenderCompany&quot;: txtSenderCompany,
                &quot;SenderContact&quot;: txtSenderContact,
                &quot;SenderPhone&quot;: txtSenderPhone,
                &quot;SenderPhoneExt&quot;: txtSenderPhoneExt,
                &quot;SenderEmail&quot;: txtSenderEmail,
                &quot;MapperCompany&quot;: txtMapperCompany,
                &quot;MapperContact&quot;: txtMapperContact,
                &quot;MapperPhone&quot;: txtMapperPhone,
                &quot;MapperPhoneExt&quot;: txtMapperPhoneExt,
                &quot;MapperEmail&quot;: txtMapperEmail,
                &quot;BrandID&quot;: BrandAAIAIDHeader,
                &quot;Acesname&quot;: Acesname,
                &quot;strACES&quot;: &quot;Aces&quot;,
                &quot;ChkAlloverlap&quot;: ChkAlloverlap.toString(),
                &quot;AcesOverpopulate&quot;: Overpopulate,
                &quot;ExporttoFTP&quot;: ExporttoFTP,
                &quot;exportFormat&quot;: exportFormat,
                &quot;Qualifier&quot;: Qualifier,
                &quot;customizedflag&quot;: customizedflag
            }
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            if (ACESPIESQueue == &quot;true&quot;) {
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveAcesExportxmldataNew&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {

                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function (err) {
                        console.log(err);
                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }
            else {
                var dataxml = {
                    &quot;acespies&quot;: &quot;Aces&quot;,
                }
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;queuecheckxmlPermission&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(dataxml),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        if (response == &quot; , &quot;'&quot; , &quot;&quot;Yes&quot;&quot; , &quot;'&quot; , &quot;) {
                            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                            alert(&quot;An XML file creation is in progress for another user. Please try after some time.&quot;);
                        }
                        else {
                            $.ajax({
                                type: &quot;POST&quot;,
                                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GetAcesExportxmldataNew&quot; , &quot;'&quot; , &quot;,
                                data: JSON.stringify(_data),
                                contentType: &quot;application/json; charset=utf-8&quot;,
                                success: function (response) {
                                    debugger
                                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                    var data = JSON.parse(response);
                                    var count = data.Count;
                                    var name = data.Name;
                                    var result = data.Result;
                                    var services = Acesname;
                                    var rbb = $(&quot; , &quot;'&quot; , &quot;input[name=&quot;exportFormat&quot;]:checked&quot; , &quot;'&quot; , &quot;).val();
                                    if (rbb == &quot;&quot; &amp;&amp; rbb == undefined) {
                                        rbb = &quot;4.2&quot;;
                                    }
                                    const sanitizedName = name.replace(/[^a-zA-Z0-9-_ ]+/g, &quot;&quot;);
                                    const fullURL = `downloadAcesXml.aspx?Aces=${services}&amp;company=${sanitizedName}&amp;Qualifier=${Qualifier}&amp;Equipment=${Equipment}&amp;ExportFormat=${rbb}`;
                                    if (count != &quot;0&quot;) {
                                        if (result == &quot;Success&quot;) {
                                            window.open(fullURL, &quot; , &quot;'&quot; , &quot;_blank&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px&quot; , &quot;'&quot; , &quot;);
                                        }
                                        else {
                                            alert(&quot;Run Api mode contact administator&quot;);
                                        }
                                    }
                                    else {
                                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                        alert(&quot;There is no data for this criteria&quot;);
                                    }

                                },
                                error: function () {

                                    alert(&quot;Failed!&quot;)
                                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                                }
                            })
                        }
                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                return false;
            }
        }
        function specificspecialchar(e) {
            var k = e.keyCode == 0 ? e.charCode : e.keyCode;
            if ((k > 64 &amp;&amp; k &lt; 91) || (k > 96 &amp;&amp; k &lt; 123) || k == 8 || k == 32 || (k >= 48 &amp;&amp; k &lt;= 57)) {
                return true;
            }
            else {
                return false;
            }
        }
        function handlePaste(e) {
            var clipboardData = event.clipboardData || window.clipboardData;
            var pastedData = clipboardData.getData(&quot; , &quot;'&quot; , &quot;Text&quot; , &quot;'&quot; , &quot;);

            var prohibitedChars = [&quot;;&quot;, &quot;[&quot;, &quot;]&quot;, &quot;{&quot;, &quot;}&quot;, &quot;~&quot;, &quot;|&quot;, &quot;,&quot;, &quot;\&quot;&quot;, &quot;%&quot;, &quot;!&quot;, &quot;@&quot;, &quot;#&quot;, &quot;^&quot;, &quot;&amp;&quot;, &quot;(&quot;, &quot;)&quot;, &quot;,&quot;, &quot;.&quot;, &quot;/&quot;, &quot;:&quot;, &quot;+&quot;, &quot;-&quot;, &quot;_&quot;, &quot;=&quot;, &quot;$&quot;, &quot;*&quot;, &quot;?&quot;, &quot;&quot; , &quot;'&quot; , &quot;&quot;];
            for (var i = 0; i &lt; prohibitedChars.length; i++) {
                if (pastedData.includes(prohibitedChars[i])) {
                    event.preventDefault();
                    Swal.fire({
                        icon: &quot; , &quot;'&quot; , &quot;warning&quot; , &quot;'&quot; , &quot;,
                        text: &quot;Pasted Value has Restricted Special Characters&quot;,
                        allowOutsideClick: false,
                        allowEscapeKey: false,
                    });
                    return false;
                }
            }
            return true;
        }
        function Checknewexport() {
            debugger
            var PartDescriptionId = PartTypeIds;
            var BrandIDs = BrandIds;
            var productlines = SubPLine;
            var ExportType = hdExportType;
            var Ecommerece = Services;
            
            var Trading = &quot;0&quot;;
            if (Services == &quot; , &quot;'&quot; , &quot;ACES&quot; , &quot;'&quot; , &quot;) {
                if (TradingPartnerwebconfig == &quot;true&quot;) {
                    var Trading = $(&quot;#drptradingpartner option:selected&quot;).val();
                }
                else {
                    var Trading = &quot;0&quot;;
                }
            }

            if (ExportType != &quot; , &quot;'&quot; , &quot;Ebay&quot; , &quot;'&quot; , &quot;) {
                var Line = $(&quot;#DrpLine option:selected&quot;).val();
                if (Line == &quot;&quot;) {
                    alert(&quot;Please Select Line !!&quot;);
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    return false;
                }
            }
            if (ExportType == &quot; , &quot;'&quot; , &quot;Services&quot; , &quot;'&quot; , &quot;) {
                ExportType = &quot;ACES&quot;
                if (TradingPartnerwebconfig == &quot;true&quot;) {
                    var Trading = $(&quot;#drptradingpartner option:selected&quot;).val();
                }
                else {
                    var Trading = &quot;0&quot;;
                }
            }
            if (ExportType == &quot; , &quot;'&quot; , &quot;Network&quot; , &quot;'&quot; , &quot;) {
                ExportType = &quot;ACES&quot;
            }
            if (ExportType == &quot; , &quot;'&quot; , &quot;Walmart&quot; , &quot;'&quot; , &quot;) {
                ExportType = &quot;ACES&quot;
            }  

            var Sp = &quot;&quot;;
            var Competitor = &quot;0&quot;;
            var Equipment = &quot;False&quot;;
            if ($(&quot;#chkequ&quot;).is(&quot; , &quot;'&quot; , &quot;:visible&quot; , &quot;'&quot; , &quot;)) {
                Equipment = $(&quot;#chkequ&quot;).prop(&quot; , &quot;'&quot; , &quot;checked&quot; , &quot;'&quot; , &quot;) ? &quot;True&quot; : &quot;False&quot;;
            }
            var CustomerId = 0;
            var counter = 0;
            var PartDescription = PartDescriptionId.replace(/(^[,\s]+)|([,\s]+$)/g, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);
            var productliness = productlines.replace(/(^[,\s]+)|([,\s]+$)/g, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);
            
            PartDescription = &quot;&quot;;
            var Brandssss = BrandIDs.replace(/(^[,\s]+)|([,\s]+$)/g, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;);

            var path = window.location.href.replace(window.location.hostname + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(window.location.protocol + &quot; , &quot;'&quot; , &quot;//&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(window.location.search, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;).replace(&quot; , &quot;'&quot; , &quot;:&quot; , &quot;'&quot; , &quot; + window.location.port, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;)
            var sitename = path.substring(0, path.indexOf(&quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;));
            if (sitename == &quot; , &quot;'&quot; , &quot;localhost&quot; , &quot;'&quot; , &quot;) {
                sitename = &quot;&quot;;
            }
            else if (sitename == &quot; , &quot;'&quot; , &quot;APAPMTTEST&quot; , &quot;'&quot; , &quot;) {
                sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
            }
            else if (sitename == &quot; , &quot;'&quot; , &quot;Youtechpmt&quot; , &quot;'&quot; , &quot;) {
                sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
            }
            else {
                //sitename = sitename + &quot; , &quot;'&quot; , &quot;/&quot; , &quot;'&quot; , &quot;
                sitename = &quot;&quot;;
            }
            var Competitor = $(&quot;#drpinterchange1&quot;).val();
            if (Competitor == &quot;&quot; || Competitor == undefined) {
                Competitor = &quot;0&quot;;
            }
            var AdminGroupID = &quot; , &quot;'&quot; , &quot;6&quot; , &quot;'&quot; , &quot;;
            debugger
            OpenPartNoPopupExportcustom(sitename + &quot; , &quot;'&quot; , &quot;Parts&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;ViewPartsExport.aspx&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot; + PartDescription + &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, ExportType, Ecommerece, Sp, Competitor, Line, Brandssss, productliness, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;700&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;550&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;450&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;200&quot; , &quot;'&quot; , &quot;, Competitor, Trading, Equipment, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;, AdminGroupID);

            return true;
        }
        function generateopticat() {
            debugger
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var Line = $(&quot;#DrpLine option:selected&quot;).val();
            if (Line == &quot;&quot;) {
                alert(&quot;Please Select Line !!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            $(&quot;#MainContent_hdlinecode&quot;).val(Line);
            if (Process == &quot;PIES&quot;) {
                var companyname = $(&quot;#CompanyNamePIES&quot;).val().trim();
                companyname = companyname.replace(/[&lt;>]/ig, &quot;&quot;);
                if (typeof companyname === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companyname === null || companyname === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    companyname = PCompany;
                }
                var Pla = $(&quot;#PLA&quot;).val().trim();
                if (typeof Pla === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || Pla === null || Pla === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    Pla = PPLA || &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;;
                }
                var VendorNumber = $(&quot;#Vendor&quot;).val();
                if (typeof VendorNumber === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || VendorNumber === null || VendorNumber === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    VendorNumber = PVendorNumber;
                }
                var ContactPies = $(&quot;#ContactName&quot;).val();
                ContactPies = ContactPies.replace(/[&lt;>]/ig, &quot;&quot;);
                if (typeof ContactPies === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || ContactPies === null || ContactPies === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    ContactPies = PContactName;
                }
                var Email = $(&quot;#ContactEmail&quot;).val();
                if (typeof Email === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || Email === null || Email === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    Email = PContactEmail;
                }
                var EDate = $(&quot;#PIESEffectiveDate&quot;).val();
                if (typeof EDate === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || EDate === null || EDate === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    EDate = PBlanketEffectiveDate;
                }
                var PriceSheetNum = $(&quot;#PriceSheet&quot;).val();
                if (typeof PriceSheetNum === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || PriceSheetNum === null || PriceSheetNum === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    PriceSheetNum = PPriceSheetNum;
                }
                $(&quot;#MainContent_hdtxtCompanyName&quot;).val(companyname);
                $(&quot;#MainContent_hdtxtParent&quot;).val(&quot;&quot;);
                $(&quot;#MainContent_hdtxtBrand&quot;).val(&quot;&quot;);
                $(&quot;#MainContent_hdtxtContactPies&quot;).val(ContactPies);
                $(&quot;#MainContent_hdtxtEmail&quot;).val(Email);
                $(&quot;#MainContent_hdtxtPla&quot;).val(Pla);
                $(&quot;#MainContent_hdtxtVendorNumber&quot;).val(VendorNumber);
                $(&quot;#MainContent_hdtxtPriceSheetNum&quot;).val(PriceSheetNum);
                $(&quot;#MainContent_hdtxtEDate&quot;).val(EDate);
                var Competitor = $(&quot;#drpinterchange1&quot;).val();
                if (Competitor == &quot;&quot; || Competitor == undefined) {
                    Competitor = &quot;0&quot;;
                }
                $(&quot;#MainContent_hddrpCustomer&quot;).val(Competitor);
                $(&quot;#MainContent_Opticatpies1&quot;).click();
            }
            else {
                var companyname = $(&quot;#CompanyName&quot;).val();
                if (typeof companyname === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || companyname === null || companyname === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    companyname = ACompanyName;
                }
                var txtEffectiveDate1 = $(&quot;#EffectiveDate&quot;).val();
                if (typeof txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtEffectiveDate1 === null || txtEffectiveDate1 === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtEffectiveDate1 = AEffectiveDate;
                }
                var txtDocTitle = $(&quot; , &quot;'&quot; , &quot;#DocumentTitle&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtDocTitle === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocTitle === null || txtDocTitle === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtDocTitle = Adoctitle;
                }
                var cblapprovedfor = $(&quot; , &quot;'&quot; , &quot;#txtapprove&quot; , &quot;'&quot; , &quot;).val();
                if (typeof cblapprovedfor === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || cblapprovedfor === null || cblapprovedfor === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    cblapprovedfor = AApprovedfordata;
                }
                var txtSenderCompany = $(&quot; , &quot;'&quot; , &quot;#SenderCompany&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtSenderCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderCompany === null || txtSenderCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtSenderCompany = ASenderCompany;
                }
                var txtSenderPhone = $(&quot; , &quot;'&quot; , &quot;#SenderPhone&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtSenderPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhone === null || txtSenderPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtSenderPhone = ASenderPhone;
                }
                var txtSenderEmail = $(&quot; , &quot;'&quot; , &quot;#SenderEmail&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtSenderEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderEmail === null || txtSenderEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtSenderEmail = Asenderemail;
                }
                var txtMapperCompany = $(&quot; , &quot;'&quot; , &quot;#MapperCompany&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtMapperCompany === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperCompany === null || txtMapperCompany === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtMapperCompany = AMapperCompany;
                }
                var txtMapperPhone = $(&quot; , &quot;'&quot; , &quot;#MapperPhone&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtMapperPhone === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhone === null || txtMapperPhone === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtMapperPhone = AMapperPhone;
                }
                var txtMapperEmail = $(&quot; , &quot;'&quot; , &quot;#MapperEmail&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtMapperEmail === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperEmail === null || txtMapperEmail === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtMapperEmail = AMapperEmail;
                }
                var txtContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtContact === null || txtContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtContact = ASenderContact;
                }
                var drpSubmissionType = $(&quot;#SubmissionType option:selected&quot;).text();
                if (typeof drpSubmissionType === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || drpSubmissionType === null || drpSubmissionType === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    drpSubmissionType = &quot;FULL&quot;;
                }
                var txtDocFormNo = $(&quot; , &quot;'&quot; , &quot;#DocumentForm&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtDocFormNo === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtDocFormNo === null || txtDocFormNo === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtDocFormNo = ADocformnumber;
                }
                var txtSenderContact = $(&quot; , &quot;'&quot; , &quot;#SenderContact&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtSenderContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderContact === null || txtSenderContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtSenderContact = ASenderContact;
                }
                var txtSenderPhoneExt = $(&quot; , &quot;'&quot; , &quot;#SenderPhoneExt&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtSenderPhoneExt === null || txtSenderPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtSenderPhoneExt = Asenderphoneext;
                }
                var txtMapperContact = $(&quot; , &quot;'&quot; , &quot;#MapperContact&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtMapperContact === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperContact === null || txtMapperContact === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtMapperContact = AMapperContact;
                }
                var txtMapperPhoneExt = $(&quot; , &quot;'&quot; , &quot;#MapperPhoneExt&quot; , &quot;'&quot; , &quot;).val();
                if (typeof txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;undefined&quot; , &quot;'&quot; , &quot; || txtMapperPhoneExt === null || txtMapperPhoneExt === &quot; , &quot;'&quot; , &quot;&quot; , &quot;'&quot; , &quot;) {
                    txtMapperPhoneExt = AMapperPhoneext;
                }
                if (hdbrand == &quot;false&quot;) {
                    var BrandAAIAIDHeader = &quot;&quot;;
                }
                else {
                    var BrandAAIAIDHeader = $(&quot;#txtbrandid&quot;).val();
                    if (BrandAAIAIDHeader != &quot;&quot; &amp;&amp; BrandAAIAIDHeader.length &lt; 4) {
                        alert(&quot;Brand AAIAID must have 4 characters&quot;);
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        return false;
                    }
                    var regex = /^[a-zA-Z]+$/;
                    if (!regex.test(BrandAAIAIDHeader)) {
                        alert(&quot;Invalid BrandID&quot;);
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        return false;
                    }
                }

                var date = txtEffectiveDate1;
                //var txtEffectiveDate = &quot;&quot;;
                //txtEffectiveDate = (date.substr(6, 4) + &quot;-&quot; + date.substr(0, 2) + &quot;-&quot; + date.substr(3, 2));
                txtEffectiveDate = txtEffectiveDate1;

                $(&quot;#MainContent_hdtxtCompany&quot;).val(companyname);
                $(&quot;#MainContent_hdtxtContact&quot;).val(txtContact);
                $(&quot;#MainContent_hdtxtEffectiveDate&quot;).val(txtEffectiveDate);
                $(&quot;#MainContent_hdtxtDocTitle&quot;).val(txtDocTitle);
                $(&quot;#MainContent_hdtxtDocFormNo&quot;).val(txtDocFormNo);
                $(&quot;#MainContent_hdtxtApprovedfor&quot;).val(cblapprovedfor);
                $(&quot;#MainContent_hdtxtSenderCompany&quot;).val(txtSenderCompany);
                $(&quot;#MainContent_hdtxtSenderContact&quot;).val(txtSenderContact);
                $(&quot;#MainContent_hdtxtSenderPhone&quot;).val(txtSenderPhone);
                $(&quot;#MainContent_hdtxtSenderEmail&quot;).val(txtSenderEmail);
                $(&quot;#MainContent_hdtxtMapperCompany&quot;).val(txtMapperCompany);
                $(&quot;#MainContent_hdtxtMapperContact&quot;).val(txtMapperContact);
                $(&quot;#MainContent_hdtxtMapperPhone&quot;).val(txtMapperPhone);
                $(&quot;#MainContent_hdtxtMapperPhoneExt&quot;).val(txtMapperPhoneExt);
                $(&quot;#MainContent_hdtxtMapperEmail&quot;).val(txtMapperEmail);
                $(&quot;#MainContent_hdtxtBrandID&quot;).val(BrandAAIAIDHeader);
                var Competitor = $(&quot;#drpinterchange1&quot;).val();
                if (Competitor == &quot;&quot; || Competitor == undefined) {
                    Competitor = &quot;0&quot;;
                }
                $(&quot;#MainContent_hddrpCustomer&quot;).val(Competitor);
                $(&quot;#MainContent_Opticataces1&quot;).click();
            }
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
        }
        function Generate_All_ApplicationExportBasedMfrBrandId_csv() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var _data = {
                &quot;AdminId&quot;: AdminId,
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveAcesAllApplicationExportCSVdata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            })
        }
        function Generate_PiesExcelExportBasedMfrBrand() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: &quot; , &quot;'&quot; , &quot;PIES&quot; , &quot;'&quot; , &quot;
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SavePiesExcelExportdata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            })
        }
        function Generate_PiesXMLExportBasedMfrBrand() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: &quot; , &quot;'&quot; , &quot;PIES&quot; , &quot;'&quot; , &quot;
            }

            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SavePiesXMLExportdata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            })
        }
        function Generate_AllProdLineAcesQdbCodeXML() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();

            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: &quot; , &quot;'&quot; , &quot;ACES with QDB Codes&quot; , &quot;'&quot; , &quot;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveAcesQdbCodeXMLdata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            })
        }
        function Generate_AllProdLineAcesRawNotesXML() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();

            var _data = {
                &quot;AdminId&quot;: AdminId,
                &quot;ExportType&quot;: &quot; , &quot;'&quot; , &quot;ACES with Raw Notes&quot; , &quot;'&quot; , &quot;
            }
            $.ajax({
                type: &quot;POST&quot;,
                url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveAcesQdbCodeXMLdata&quot; , &quot;'&quot; , &quot;,
                data: JSON.stringify(_data),
                contentType: &quot;application/json; charset=utf-8&quot;,
                success: function (response) {
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    var msg = JSON.parse(response);
                    if (msg == &quot;Success&quot;) {
                        alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                    }
                    else {
                        alert(&quot;Run Api mode contact administator&quot;);
                    }

                },
                error: function (err) {
                    console.log(err);
                    alert(&quot;Failed!&quot;)
                    $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                }
            })
        }
        function GenerateEbayExcel() {
            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).show();
            var Partdes = PartTypeIds;
            var Vehicle = VehicleTypeIds;
            var Make = MakeIds;
            var region = RegionIds;
            var partdescription = Partdes.split(&quot; , &quot;'&quot; , &quot;,&quot; , &quot;'&quot; , &quot;);
            var Name = &quot;&quot;;
            var storeid = $(&quot;#DrpEbay&quot;).val();
            if (partdescription.length > 1) {
                Name = PMTName + &quot;_&quot; + &quot;Products_&quot;;
            }
            else {
                Name = PMTName + &quot;_&quot; + partdescription;
            }
            if (Partdes == &quot;&quot;) {
                alert(&quot;Select atleast one part description!&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            if (storeid == &quot;&quot;) {
                alert(&quot;Please select storeid&quot;);
                $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                return false;
            }
            var _data = {
                &quot;MakeId&quot;: Make,
                &quot;PartDescription&quot;: Partdes,
                &quot;VehicleType&quot;: Vehicle,
                &quot;region&quot;: region,
                &quot;Storeid&quot;: storeid,
                &quot;AdminId&quot;: AdminId
            }
            if (ACESPIESQueue == &quot;true&quot;) {
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;SaveEbayExportExcel&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var msg = JSON.parse(response);
                        //if (response > 0)
                        if (msg == &quot;Success&quot;) {

                            alert(&quot; , &quot;'&quot; , &quot;Your export is initiated. Please check the Queue Management page for more details&quot; , &quot;'&quot; , &quot;);

                        }
                        else {
                            alert(&quot;Run Api mode contact administator&quot;);
                        }

                    },
                    error: function (err) {
                        console.log(err);
                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })
            }
            else {
                $.ajax({
                    type: &quot;POST&quot;,
                    url: WebAPIURL + &quot; , &quot;'&quot; , &quot;GenerateEbayExportExcel&quot; , &quot;'&quot; , &quot;,
                    data: JSON.stringify(_data),
                    contentType: &quot;application/json; charset=utf-8&quot;,
                    success: function (response) {
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                        var data = JSON.parse(response);
                        var count = data.Count;
                        var result = data.Result;
                        const fullURL = `downloadebayExcel.aspx?Services= Download`;
                        if (count != &quot;0&quot;) {
                            if (result == &quot;Success&quot;) {
                                window.open(fullURL, &quot; , &quot;'&quot; , &quot;_blank&quot; , &quot;'&quot; , &quot;, &quot; , &quot;'&quot; , &quot;status=no,toolbar=no,menubar=no,location=no,scrollbars=no,resizable=no,titlebar=no,height=30px,width=100px&quot; , &quot;'&quot; , &quot;);
                            }
                            else {
                                alert(&quot;Run Api mode contact administator&quot;);
                            }
                        }
                        else {
                            $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                            alert(&quot;There is no data for this criteria&quot;);
                        }

                    },
                    error: function () {

                        alert(&quot;Failed!&quot;)
                        $(&quot; , &quot;'&quot; , &quot;.loader_main_spin&quot; , &quot;'&quot; , &quot;).hide();
                    }
                })

            }


        }
    
    
        
            
                Export Data : Select the format you like to export
            
        
        
            
                * Excel/XML will contain information of Parts selected in the respective Parts Export Page. By default when a Part is created in PMT is selected for Export
            
        
    
    
        
            
                
                All Applications
            
            
                
                ACES with QDB Codes
            
            
                
                ACES with Raw Notes
            
            
                
                ACES Invalid
            
            
                
                ACES with Raw Notes and Attribute Invalids
            
            
                
                PIES
            
            
                
                Compatibility
            
            
                
                ACES
            
            
                
            
            
                
            
            
            
        
    
    
        
            
                Line *
                -SELECT-ALL1234 | mani testAmazonBasics |  KTM Sportmotorcycle GmbHAuto | AutomateBBBB | 3MBBHN |  KTM Sportmotorcycle GmbHBDBC |  KTM Sportmotorcycle GmbHBDFL | Air Pro/Maritta RadiatorBDGB |  AGS CompanyBDGS | AP Emissions TechnologiesBDJK | Automann USA IncBDLK | Gates CorporationBDLV | Robert Bosch LLCBDMB | Brembo SpABDMR | Buyers Products CompanyBDNL | Cambro Products IncBDPV | Charter V-BeltsBDPZ | Chicago RawhideBDRB | Cooper Tire &amp; Rubber CompanyBDRQ | CRC Industries IncBDTG | Donaldson Company IncBDVG | East Penn Manufacturing Company IncBDWL | Stryten EnergyBFCN | Grote IndustriesBFCZ |  KTM Sportmotorcycle GmbHBFFD | SAF-HOLLAND GroupBFFX | Interstate BatteriesBFHC | KD Lamp CompanyBFLP | Meritor IncBFNQ | Muncie Power ProductsBFRX | PermatexBFSB | Peterson Manufacturing CompanyBFTR | BendixBGBN | Sealco Air ControlBGDK | Standard Motor Products IncBGDS | Stemco IncBGGK | The Timken CompanyBGKG | Velvac IncBGLB | DRiV IncorporatedBGMG | Dana IncorporatedBHLZ | RatechBHWM | EBC Brakes USABKMG |  KTM Sportmotorcycle GmbHBKQD | WABCO Holdings IncBQWN | BagshawBXXS | Consolidated Metco IncCBXN | CumminsCDFX | Dexter Axle CompanyCJFL | FergusonCKTK | GSLCPCM | Marmon Holdings IncCPDN | Hutchens IndustriesCRBF | EZ Ziegler Carparts GmbH &amp; CoCRDW | HendricksonCRWK | Larson SystemsCTQN | RycoCTRD | SafewayCVKW | Thermo-KingCWFP | Horizon Brands LLCCWJD | ZF Friedrichshafen AGDMGT | TectranDMJM | Shur-Co CorporationDNVX | Illusions IncDPFJ | Milwaukee Electric Tool CorporationDTTX | NEAPCO LLCDWBR | Hoosier TankDWFB | Midwest Truck &amp; Auto Parts IncDWJB | Kinedyne LLCDXGH | Sirco IndustriesDXJK | TramecECA |  KTM Sportmotorcycle GmbHECAT | ECATFBBB |  KTM Sportmotorcycle GmbHFBHL | CTEK IncFFHT | Lippert ComponentsFJTW | Henkel CorporationFMBL | StyluzFMCT | CarParts.com IncFMGV |  KTM Sportmotorcycle GmbHFMWN | Scrubblade IncFNSL | Willpak Industries IncFSTX |  KTM Sportmotorcycle GmbHGCPV |  KTM Sportmotorcycle GmbHGFVN | Globetech ManufacturingGJFQ | Grand Rock Co IncGJKV | Car Sound Exhaust System IncGKQK | Terminal Supply CompanyGNTG | Phillips IndustriesGNXP | Ms Carita SafeTruck IncGPNH |  KTM Sportmotorcycle GmbHGTQB | KTM Sportmotorcycle GmbHHDA6 |  KTM Sportmotorcycle GmbHHGFJ | Myers Engineering IncHGYW | Dailey EngineeringHHDL | The Miner CorporationHHGG |  KTM Sportmotorcycle GmbHHHRS | Bezares SAHJMF | BettsHDHLBS |  KTM Sportmotorcycle GmbHHLNC |  KTM Sportmotorcycle GmbHHLYF | Sensata TechnologiesHNDT | Tramec Sloan LLCHQBF | Eiko North AmericaHSYH |  KTM Sportmotorcycle GmbHHTHF |  KTM Sportmotorcycle GmbHHVZQ |  KTM Sportmotorcycle GmbHHWGV |  KTM Sportmotorcycle GmbHHWGW | First Brands GroupHWHT |  KTM Sportmotorcycle GmbHHWJL |  KTM Sportmotorcycle GmbHHWKC | BorgWarner IncHWSL |  KTM Sportmotorcycle GmbHHWTQ |  KTM Sportmotorcycle GmbHHWWX | REV Group IncHYYW | Archived BrandsHZRJ | Webb Wheel Products IncHZSM |  KTM Sportmotorcycle GmbHJBRH |  KTM Sportmotorcycle GmbHJBXC | Weitron IncJBZM |  KTM Sportmotorcycle GmbHJDSR |  KTM Sportmotorcycle GmbHJFVK |  KTM Sportmotorcycle GmbHJGWM |  KTM Sportmotorcycle GmbHJHTD |  KTM Sportmotorcycle GmbHJHWD |  KTM Sportmotorcycle GmbHJJBY | JOST InternationalJJLJ |  KTM Sportmotorcycle GmbHJJQM |  KTM Sportmotorcycle GmbHJJVN |  KTM Sportmotorcycle GmbHJJWG |  KTM Sportmotorcycle GmbHJJXP |  KTM Sportmotorcycle GmbHJKJT |  KTM Sportmotorcycle GmbHJKLP |  KTM Sportmotorcycle GmbHJKSH | ATRO Engineered Systems IncJLNV |  KTM Sportmotorcycle GmbHJLRV |  KTM Sportmotorcycle GmbHJNE | JNEJNFJ |  KTM Sportmotorcycle GmbHJNGN |  KTM Sportmotorcycle GmbHJNTR |  KTM Sportmotorcycle GmbHJNVY |  KTM Sportmotorcycle GmbHJPCZ |  KTM Sportmotorcycle GmbHJPDC |  KTM Sportmotorcycle GmbHJPHL |  KTM Sportmotorcycle GmbHJPJZ | Maxiforce IncJPMK |  KTM Sportmotorcycle GmbHJRTR |  KTM Sportmotorcycle GmbHJRYR |  KTM Sportmotorcycle GmbHJSXZ |  KTM Sportmotorcycle GmbHJTBH |  KTM Sportmotorcycle GmbHJTFR |  KTM Sportmotorcycle GmbHJTVF |  KTM Sportmotorcycle GmbHJTZF |  KTM Sportmotorcycle GmbHJUNDA |  KTM Sportmotorcycle GmbHJVBL |  KTM Sportmotorcycle GmbHJVHV |  KTM Sportmotorcycle GmbHJVLY |  KTM Sportmotorcycle GmbHJVMB |  KTM Sportmotorcycle GmbHJVTB |  KTM Sportmotorcycle GmbHJWGV |  KTM Sportmotorcycle GmbHJWXJ |  KTM Sportmotorcycle GmbHJXRW | stymartJXYR |  KTM Sportmotorcycle GmbHJYBK | RR USA IncJYPP |  KTM Sportmotorcycle GmbHJZRD | Norcalway LLCJZRY |  KTM Sportmotorcycle GmbHKBVS |  KTM Sportmotorcycle GmbHKBWY | Trux AccessoriesKFHH | Intellitec Products LLCKRCQ | vmDSTechLCZM | TNAIYHSKP |  KTM Sportmotorcycle GmbHTEA | TealpartsTES | TESTEST | TESTTOW |  KTM Sportmotorcycle GmbHZAER |  KTM Sportmotorcycle GmbHZAPG |  KTM Sportmotorcycle GmbHZASE |  KTM Sportmotorcycle GmbHZAUT |  KTM Sportmotorcycle GmbHZCMS |  KTM Sportmotorcycle GmbHZCVL |  KTM Sportmotorcycle GmbHZETT |  KTM Sportmotorcycle GmbHZFRY |  KTM Sportmotorcycle GmbHZKAT |  KTM Sportmotorcycle GmbHZKEL |  KTM Sportmotorcycle GmbHZLKI |  KTM Sportmotorcycle GmbHZLUB |  KTM Sportmotorcycle GmbHZMAT |  KTM Sportmotorcycle GmbHZMEP |  KTM Sportmotorcycle GmbHZMIV |  KTM Sportmotorcycle GmbHZMOW |  KTM Sportmotorcycle GmbHZNOR |  KTM Sportmotorcycle GmbHZPRO |  KTM Sportmotorcycle GmbHZRIH |  KTM Sportmotorcycle GmbHZSKI |  KTM Sportmotorcycle GmbHZSTA |  KTM Sportmotorcycle GmbHZTLT |  KTM Sportmotorcycle GmbHZTOD |  KTM Sportmotorcycle GmbHZTOM |  KTM Sportmotorcycle GmbHZTRA |  KTM Sportmotorcycle GmbHZVAN |  KTM Sportmotorcycle GmbHZVEE |  KTM Sportmotorcycle GmbHZVUL |  KTM Sportmotorcycle GmbHZWTC |  KTM Sportmotorcycle GmbH
            
            
                Ebay :
                
            
            
                Interchange :
                AAATest Rite InternationalSelect multiple items
                
            
            
                Unit/Comp :
                
                    Unit
                    Comp
                
            
            
                Trading Partner :
                
                    
                        Trading Partner
                        The changes to the parts export settings for the Trading Partner can be done through the Trading Partner Master
                
                -SELECT-
            
             
                 
                  Include Equipment
            
        
    
    
        
            Brand*
            
                
                    
                    Select All
                    The Brand filter will be disabled when All lines are selected. The exported file will list all the Brands available in the PMT
                
                
                
            
            Sub Brand
            
                
                    
                    Select All
                    If there are no sub-brand(s) associated with the selected brand(s), only the brand information will be displayed here.
                
                
                
            
            Sub Product line*
            
                
                    
                    Select All
                
                Base#skp
            
            Part Description* 
            
                
                    
                        
                        Select All
                        
                            PARTS EXPORT SETTINGS
                            
                            Select All. Overwrite Export settings
                        
                        You can select only one Part Description when All Lines are selected
                    
                    
                        
                        
                        
                    
                
                
                
            
            VehicleType
            
                
                    
                    Select All
                    
                
                
                
            
            Make
            
                
                    
                    Select All
                    
                        
                        
                        
                    
                
                
                
            
            Region
            
                
                    
                    Select All
                
                
                
            
            ACES Header Info
            
                
                    
                        Export in ACES Version:
                        
                            
                            3.2

                            
                            4.0

                            
                            4.2
                        
                        
                            Overpopulate :
                            
                                
                                Both
                                
                                Submodel
                                
                                EngineBase
                            
                        
                    
                    
                        
                            Company Name*
                            
                        
                        
                            Company Contact*
                            
                        
                        
                            Effective Date*
                            
                        
                        
                            Submission Type*
                            -SELECT-FullUpdate
                        
                        
                            Document Title*
                            
                        
                        
                            Document Form #
                            
                        
                        
                            Approved for  
                            
                                
                                 CN 
                                
                                 MX 
                                
                                 US 
                            
                            ( CA-Canada , MX-Mexico , US-United States )
                            
                        
                    
                    
                        
                            Sender Company*
                            
                        
                        
                            Sender Contact*
                            
                        
                        
                            Sender Phone*
                            
                        
                        
                            Sender Phone Ext
                            
                        
                        
                            Sender Email
                            
                        
                        
                            Mapper Company
                            
                        
                        
                            Mapper Contact
                            
                        
                        
                            Mapper Phone
                            
                        
                        
                            Mapper Phone Ext
                            
                        
                        
                            Mapper Email
                            
                        
                        
                            Brand AAIAID
                            
                            Please provide the Brand AAIAID with 4 characters.
                            
                        
                    
                
            
            PIES Header Info
            
                
                    
                        
                            Company Name*
                            
                        
                        
                            PLA
                            
                        
                        
                            Vendor #
                            
                        
                        
                            Submission Type*
                            -SELECT-FullUpdate
                        
                        
                            Contact Name*
                            
                        
                        
                            Contact Email*
                            
                        
                        
                            Effective Date*
                            
                        
                        
                            Price Sheet #*
                            
                        
                    
                
            
        
       
    
        
        
            
            Enable this field to exclude the overlapping records in the export you want to generate
        
        
            If you have more than 1,048,576 rows, use CSV to export.
        
        
            Generate Excel
            Generate CSV
            Generate CSV Files
            Generate PIES Excel Files
            Generate PIES XML Files
            Generate QDB XML Files
            Generate Raw Notes XML Files
            Generate XML
            Import to Opticat
            Generate Customized Xml
            Generate XML to FTP
        
    
    
        
            
                Would you like to save the settings selected for this export for future use?
                If Yes, please click the &quot; , &quot;'&quot; , &quot;Yes&quot; , &quot;'&quot; , &quot; button. If not, click the &quot; , &quot;'&quot; , &quot;No&quot; , &quot;'&quot; , &quot; button.
                If &quot; , &quot;'&quot; , &quot;Yes&quot; , &quot;'&quot; , &quot; is clicked, you will be redirected to another pop-up where you can specify a name for this export and upload an associated icon. Upon saving, this will be added to the Export Data page of the PMT.
                (You can download the records with overlaps from the Downloads page.)
            
        
    
    
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
    

                           
                            &quot;))]</value>
      <webElementGuid>9a812952-0b37-4aa7-9519-349e7b472e13</webElementGuid>
   </webElementXpaths>
</WebElementEntity>
